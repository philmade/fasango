"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8604],{58604:function(e,t,n){n.d(t,{cm:function(){return Ye},S:function(){return vt},cx:function(){return Lt}});var r=n(11246),s=n(90849),i=n(55732),c=n(34707),a=n.n(c),o=n(27378),l=n(43659),d=n(98784),u=n(17737),p=n(61548),m=n(7501),x=(n(94039),n(68043)),f=n(92325),h=n(47939),j=n(67863),v=n(24974),b=n(12163),y=n(24246);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var w=function(e){return(0,y.jsx)(b.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:v.Z},e))},N=n(65194),k=n(77597);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var S=function(e){return(0,y.jsx)(b.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:k.Z},e))},C=n(27102),P=(0,l.Pi)((function(e){var t=e.id,n=void 0===t?"":t,r=(0,u.HN)(),s=r.downloadFile,c=r.selectedBucket,o=r.setSelectedItemsToDelete,l=r.setSelectedItemToRename,d=r.setSelectedItemsToMove,v=r.setSelectedFileCustomExpiry,b=r.copyFileURLToClipboard,g=c.public,k=(0,C.FH)(x.KA.STORAGE_ADMIN_WRITE,"*"),O=function(){var e=(0,i.Z)(a().mark((function e(t,n,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isCorrupted){e.next=2;break}return e.abrupt("return");case 2:e.t0=t,e.next="copy"===e.t0?5:"rename"===e.t0?12:"move"===e.t0?13:"download"===e.t0?14:17;break;case 5:if(!(void 0!==r&&r<0)){e.next=9;break}return e.abrupt("return",v(n));case 9:return e.next=11,b(n,r);case 11:case 16:return e.abrupt("return",e.sent);case 12:return e.abrupt("return",l(n));case 13:return e.abrupt("return",d([n]));case 14:return e.next=16,s(n);case 17:return e.abrupt("break",18);case 18:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();return(0,y.jsxs)(m.v2,{id:n,animation:"fade",children:[g?(0,y.jsxs)(m.ck,{onClick:function(e){var t=e.props;return O("copy",t.item)},children:[(0,y.jsx)(f.Z,{size:"tiny"}),(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Get URL"})]}):(0,y.jsxs)(m.rS,{label:(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(f.Z,{size:"tiny"}),(0,y.jsx)("span",{className:"text-xs",children:"Get URL"})]}),arrow:(0,y.jsx)(h.Z,{size:"tiny"}),children:[(0,y.jsx)(m.ck,{onClick:function(e){var t=e.props;return O("copy",t.item,p.Qo.WEEK)},children:(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Expire in 1 week"})}),(0,y.jsx)(m.ck,{onClick:function(e){var t=e.props;return O("copy",t.item,p.Qo.MONTH)},children:(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Expire in 1 month"})}),(0,y.jsx)(m.ck,{onClick:function(e){var t=e.props;return O("copy",t.item,p.Qo.YEAR)},children:(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Expire in 1 year"})}),(0,y.jsx)(m.ck,{onClick:function(e){var t=e.props;return O("copy",t.item,-1)},children:(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Custom expiry"})})]}),k&&[(0,y.jsxs)(m.ck,{onClick:function(e){var t=e.props;return O("rename",t.item)},children:[(0,y.jsx)(j.Z,{size:"tiny"}),(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Rename"})]},"rename-file"),(0,y.jsxs)(m.ck,{onClick:function(e){var t=e.props;return O("move",t.item)},children:[(0,y.jsx)(w,{size:"tiny"}),(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Move"})]},"move-file"),(0,y.jsxs)(m.ck,{onClick:function(e){var t=e.props;return O("download",t.item)},children:[(0,y.jsx)(N.Z,{size:"tiny"}),(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Download"})]},"download-file"),(0,y.jsx)(m.Z0,{},"file-separator"),(0,y.jsxs)(m.ck,{onClick:function(e){var t=e.props;return o([t.item])},children:[(0,y.jsx)(S,{size:"tiny",stroke:"red"}),(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Delete"})]},"delete-file")]]})})),E=function(e){var t=e.id,n=void 0===t?"":t,r=(0,u.HN)(),s=r.downloadFolder,i=r.setSelectedItemToRename,c=r.setSelectedItemsToDelete,a=(0,C.FH)(x.KA.STORAGE_ADMIN_WRITE,"*");return(0,y.jsxs)(m.v2,{id:n,animation:"fade",children:[a&&(0,y.jsxs)(m.ck,{onClick:function(e){var t=e.props;return i(t.item)},children:[(0,y.jsx)(j.Z,{size:"tiny"}),(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Rename"})]}),(0,y.jsxs)(m.ck,{onClick:function(e){var t=e.props;return s(t.item)},children:[(0,y.jsx)(N.Z,{size:"tiny"}),(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Download"})]}),a&&[(0,y.jsx)(m.Z0,{},"separator"),(0,y.jsxs)(m.ck,{onClick:function(e){var t=e.props;return c([t.item])},children:[(0,y.jsx)(S,{size:"tiny",stroke:"red"}),(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Delete"})]},"delete")]]})},D=n(4427);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var T=function(e){return(0,y.jsx)(b.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:D.Z},e))},I=n(44292),z=n(68464),L=n(52492);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var R=function(e){return(0,y.jsx)(b.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:L.Z},e))};function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=function(e){var t=e.id,n=void 0===t?"":t,r=(0,u.HN)(),s=r.columns,i=r.selectedItems,c=r.setSelectedItems,a=r.setView,o=r.setSortBy,l=r.setSortByOrder,x=r.addNewFolderPlaceholder;return(0,y.jsxs)(m.v2,{id:n,animation:"fade",children:[(0,y.jsxs)(m.ck,{onClick:function(e){return function(){x(arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1)}(e.props.index)},children:[(0,y.jsx)(T,{size:"tiny"}),(0,y.jsx)("span",{className:"ml-2 text-xs",children:"New folder"})]}),(0,y.jsx)(m.Z0,{}),(0,y.jsxs)(m.ck,{onClick:function(e){return function(e){var t=s[e].items.filter((function(e){return e.type===p.fh.FILE})).map((function(t){return _(_({},t),{},{columnIndex:e})})),n=(0,d.compact)(t.map((function(e){return e.id})));if(i.filter((function(e){return n.includes(e.id)})).length===t.length){var r=i.filter((function(e){return!n.includes(e.id)}));c(r)}else{var a=(0,d.uniqBy)(i.concat(t),"id");c(a)}}(e.props.index)},children:[(0,y.jsx)(f.Z,{size:"tiny"}),(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Select all items"})]}),(0,y.jsxs)(m.rS,{label:(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(I.Z,{size:"tiny"}),(0,y.jsx)("span",{className:"text-xs",children:"View"})]}),arrow:(0,y.jsx)(h.Z,{size:"tiny"}),children:[(0,y.jsx)(m.ck,{onClick:function(){return a(p.De.COLUMNS)},children:(0,y.jsx)("span",{className:"ml-2 text-xs",children:"As columns"})}),(0,y.jsx)(m.ck,{onClick:function(){return a(p.De.LIST)},children:(0,y.jsx)("span",{className:"ml-2 text-xs",children:"As list"})})]}),(0,y.jsxs)(m.rS,{label:(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(z.Z,{size:"tiny"}),(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Sort by"})]}),arrow:(0,y.jsx)(h.Z,{size:"tiny"}),children:[(0,y.jsx)(m.ck,{onClick:function(){return o(p.Ye.NAME)},children:(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Name"})}),(0,y.jsx)(m.ck,{onClick:function(){return o(p.Ye.CREATED_AT)},children:(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Last created"})}),(0,y.jsx)(m.ck,{onClick:function(){return o(p.Ye.UPDATED_AT)},children:(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Last modified"})}),(0,y.jsx)(m.ck,{onClick:function(){return o(p.Ye.LAST_ACCESSED_AT)},children:(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Last accessed"})})]}),(0,y.jsxs)(m.rS,{label:(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(R,{size:"tiny"}),(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Sort by order"})]}),arrow:(0,y.jsx)(h.Z,{size:"tiny"}),children:[(0,y.jsx)(m.ck,{onClick:function(){return l(p.sd.ASC)},children:(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Ascending"})}),(0,y.jsx)(m.ck,{onClick:function(){return l(p.sd.DESC)},children:(0,y.jsx)("span",{className:"ml-2 text-xs",children:"Descending"})})]})]})},W=n(46578),G=n(90907),M=n(30335),H=n(89301),B=n(51452),Y=n(44285),V=n(14971),K=n(52979),$=n(9922);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var q=function(e){return(0,y.jsx)(b.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:$.Z},e))},J=n(77909);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ee=function(e){return(0,y.jsx)(b.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:J.Z},e))},te=n(96026);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var re=function(e){return(0,y.jsx)(b.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:te.Z},e))},se=n(33769),ie=n(2674),ce=n(43555),ae=n(38480),oe=n(98213),le=n(24903),de=n(20796);function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var me=function(e){var t,n=e.item,r=e.view,s=e.columnIndex,c=(0,u.HN)(),l=c.renameFile,m=c.renameFolder,x=c.addNewFolder,f=(0,o.useRef)(null),h=(0,o.useState)(n.name),j=h[0],v=h[1],b=function(){var e=(0,i.Z)(a().mark((function e(t,r){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&(r.preventDefault(),r.stopPropagation()),n.type!==p.fh.FILE){e.next=6;break}return e.next=4,l(n,t,s);case 4:e.next=7;break;case 6:(0,d.has)(n,"id")?(i=pe(pe({},n),{},{columnIndex:s}),m(i,t,s)):x(t,s);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){f.current&&f.current.select();var e=function(e){"Escape"===e.key&&(void 0!==(null===n||void 0===n?void 0:n.id)?b(n.name):x("",s))};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}),[]),(0,y.jsx)("div",{className:"storage-row flex items-center justify-between rounded bg-gray-500",children:(0,y.jsxs)("div",{className:"flex h-full flex-grow items-center px-2.5",children:[(0,y.jsx)("div",{className:"",children:(0,y.jsx)(he,{view:r,status:n.status,fileType:n.type,mimeType:null===(t=n.metadata)||void 0===t?void 0:t.mimetype})}),(0,y.jsxs)("form",{className:"h-9",onSubmit:function(e){return b(j,e)},children:[(0,y.jsx)("input",{autoFocus:!0,ref:f,className:"storage-row-input ml-3 h-full bg-inherit p-0 px-1 text-sm",type:"text",value:j,onChange:function(e){return v(e.target.value)},onBlur:function(e){return b(j,e)}}),(0,y.jsx)("button",{className:"hidden",type:"submit",onClick:function(e){return b(j,e)}})]})]})})};function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var he=function(e){var t=e.view,n=e.status,r=e.fileType,s=e.mimeType;if(t===p.De.LIST&&n===p.R9.LOADING)return(0,y.jsx)(V.Z,{size:16,strokeWidth:2,className:"animate-spin"});if(r===p.fh.BUCKET||r===p.fh.FOLDER){var i=r===p.fh.BUCKET?"".concat(de.GW,"/img/bucket-filled.svg"):r===p.fh.FOLDER?"".concat(de.GW,"/img/folder-filled.svg"):"".concat(de.GW,"/img/file-filled.svg");return(0,y.jsx)(ae.Z,{src:i,preProcessor:function(e){return e.replace(/svg/,'svg class="w-4 h-4 text-color-inherit opacity-75"')}})}return null!==s&&void 0!==s&&s.includes("image")?(0,y.jsx)(K.Z,{size:16,strokeWidth:2}):null!==s&&void 0!==s&&s.includes("audio")?(0,y.jsx)(q,{size:16,strokeWidth:2}):null!==s&&void 0!==s&&s.includes("video")?(0,y.jsx)(ee,{size:16,strokeWidth:2}):(0,y.jsx)(re,{size:16,strokeWidth:2})},je=function(e){var t,n=e.index,r=e.item,s=void 0===r?{}:r,c=e.view,o=void 0===c?p.De.COLUMNS:c,l=e.columnIndex,v=void 0===l?0:l,b=e.selectedItems,g=void 0===b?[]:b,k=e.openedFolders,O=void 0===k?[]:k,P=e.selectedFilePreview,E=void 0===P?{}:P,D=(0,u.HN)(),Z=D.popColumnAtIndex,T=D.pushOpenedFolderAtIndex,I=D.popOpenedFoldersAtIndex,z=D.setFilePreview,L=D.closeFilePreview,F=D.clearSelectedItems,R=D.selectedBucket,A=D.setSelectedItems,_=D.setSelectedItemsToDelete,U=D.setSelectedItemToRename,W=D.setSelectedItemsToMove,M=D.setSelectedFileCustomExpiry,H=D.fetchFolderContents,B=D.downloadFile,K=D.downloadFolder,$=D.copyFileURLToClipboard,Q=D.selectRangeItems,q=R.public,J=fe(fe({},s),{},{columnIndex:v}),X=void 0!==(0,d.find)(g,s),ee=O.length>v&&(0,d.isEqual)(O[v],s),te=!(0,d.isEmpty)(E)&&(0,d.isEqual)(E.id,s.id),ne=(0,C.FH)(x.KA.STORAGE_ADMIN_WRITE,"*"),re=(0,m.av)().show,ae=function(){var e=(0,i.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Z(t),I(t-1),z(n),F();case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),de=function(){var e=(0,i.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(),F(t+1),I(t-1),T(n,t),e.next=6,H(n.id,n.name,t);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ue=s.type===p.fh.FOLDER?[].concat((0,Y.Z)(ne?[{name:"Rename",icon:(0,y.jsx)(j.Z,{size:"tiny"}),onClick:function(){return U(J)}}]:[]),[{name:"Download",icon:(0,y.jsx)(N.Z,{size:"tiny"}),onClick:function(){return K(J)}}],(0,Y.Z)(ne?[{name:"Separator",icon:void 0,onClick:void 0},{name:"Delete",icon:(0,y.jsx)(S,{size:"tiny"}),onClick:function(){return _([J])}}]:[])):[].concat((0,Y.Z)(s.isCorrupted?[]:[].concat((0,Y.Z)(q?[{name:"Get URL",icon:(0,y.jsx)(f.Z,{size:"tiny"}),onClick:function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(J);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]:[{name:"Get URL",icon:(0,y.jsx)(f.Z,{size:"tiny"}),children:[{name:"Expire in 1 week",onClick:function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(J,p.Qo.WEEK);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{name:"Expire in 1 month",onClick:function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(J,p.Qo.MONTH);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{name:"Expire in 1 year",onClick:function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(J,p.Qo.YEAR);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{name:"Custom expiry",onClick:function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",M(J));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]}]),(0,Y.Z)(ne?[{name:"Rename",icon:(0,y.jsx)(j.Z,{size:"tiny"}),onClick:function(){return U(J)}},{name:"Move",icon:(0,y.jsx)(w,{size:"tiny"}),onClick:function(){return W([J])}},{name:"Download",icon:(0,y.jsx)(N.Z,{size:"tiny"}),onClick:function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(J);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{name:"Separator",icon:void 0,onClick:void 0}]:[]))),(0,Y.Z)(ne?[{name:"Delete",icon:(0,y.jsx)(S,{size:"tiny"}),onClick:function(){return _([J])}}]:[])),pe=s.metadata?(0,le.td)(s.metadata.size):"-",xe=s.metadata?s.metadata.mimetype:"-",je=s.created_at?new Date(s.created_at).toLocaleString():"-",ve=s.updated_at?new Date(s.updated_at).toLocaleString():"-",be=function(e,t){re(e,{id:t===p.fh.FILE?p.l6.STORAGE_ITEM:p.l6.STORAGE_FOLDER,props:{item:J}})},ye=o===p.De.LIST&&s.isCorrupted?"calc(100% - 60px)":o!==p.De.LIST||s.isCorrupted?"100%":"calc(100% - 50px)";return s.status===p.R9.EDITING?(0,y.jsx)(me,{view:o,item:s,columnIndex:v}):(0,y.jsx)("div",{className:"h-full border-b dark:border-dark",onContextMenu:function(e){e.stopPropagation(),s.type===p.fh.FILE?be(e,p.fh.FILE):be(e,p.fh.FOLDER)},children:(0,y.jsxs)("div",{className:["storage-row group flex h-full items-center px-2.5","hover:bg-panel-footer-light dark:hover:bg-panel-footer-dark","".concat(ee?"bg-scale-400":""),"".concat(te?"bg-green-500 hover:bg-green-500 dark:hover:bg-green-500":""),"".concat(s.status!==p.R9.LOADING?"cursor-pointer":"")].join(" "),onClick:function(e){e.stopPropagation(),e.preventDefault(),s.status===p.R9.LOADING||ee||te||(s.type===p.fh.FOLDER||s.type===p.fh.BUCKET?de(v,s):ae(v,s))},children:[(0,y.jsxs)("div",{className:["flex items-center",o===p.De.LIST?"w-[40%] min-w-[250px]":"w-[90%]"].join(" "),children:[(0,y.jsxs)("div",{className:"relative w-[30px]",onClick:function(e){return e.stopPropagation()},children:[!X&&(0,y.jsx)("div",{className:"absolute ".concat(s.type===p.fh.FILE?"group-hover:hidden":""),style:{top:"2px"},children:(0,y.jsx)(he,{view:o,status:s.status,fileType:s.type,mimeType:null===(t=s.metadata)||void 0===t?void 0:t.mimetype})}),(0,y.jsx)(G.Z,{label:"",className:"w-full ".concat(s.type!==p.fh.FILE?"invisible":""," ").concat(X?"opacity-100":"opacity-0 group-hover:opacity-100"),checked:X,onChange:function(e){e.stopPropagation(),e.nativeEvent.shiftKey&&0!==g.length?Q(v,n):(void 0!==(0,d.find)(g,(function(e){return J.id===e.id}))?A(g.filter((function(e){return J.id!==e.id}))):A([].concat((0,Y.Z)(g),[J])),L())}})]}),(0,y.jsx)("p",{title:s.name,className:"truncate text-sm",style:{width:ye},children:s.name}),s.isCorrupted&&(0,y.jsxs)(oe.fC,{delayDuration:0,children:[(0,y.jsx)(oe.xz,{children:(0,y.jsx)(se.Z,{size:18,strokeWidth:2,className:"text-scale-1000"})}),(0,y.jsx)(oe.h_,{children:(0,y.jsxs)(oe.VY,{side:"bottom",children:[(0,y.jsx)(oe.Eh,{className:"radix-tooltip-arrow"}),(0,y.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,y.jsx)("span",{className:"text-xs text-scale-1200",children:"File is corrupted, please delete and reupload again."})})]})})]})]}),o===p.De.LIST&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("p",{className:"w-[11%] min-w-[100px] truncate text-sm",children:pe}),(0,y.jsx)("p",{className:"w-[14%] min-w-[100px] truncate text-sm",children:xe}),(0,y.jsx)("p",{className:"w-[15%] min-w-[160px] truncate text-sm",children:je}),(0,y.jsx)("p",{className:"w-[15%] min-w-[160px] truncate text-sm",children:ve})]}),(0,y.jsx)("div",{className:"flex items-center justify-end ".concat(o===p.De.LIST?"flex-grow":"w-[10%]"),onClick:function(e){return e.stopPropagation()},children:s.status===p.R9.LOADING?(0,y.jsx)(V.Z,{className:"animate-spin ".concat(o===p.De.LIST?"invisible":""),size:16,strokeWidth:2}):(0,y.jsx)(ie.ZP,{side:"bottom",align:"end",overlay:[ue.map((function(e){var t,n,r;return(null!==(t=null===e||void 0===e?void 0:e.children)&&void 0!==t?t:[]).length>0?(0,y.jsx)(ie.ZP,{isNested:!0,side:"right",align:"start",overlay:null===(n=null!==(r=null===e||void 0===e?void 0:e.children)&&void 0!==r?r:[])||void 0===n?void 0:n.map((function(e){return(0,y.jsx)(ie.ZP.Item,{onClick:e.onClick,children:e.name},e.name)})),children:(0,y.jsxs)("div",{className:["flex items-center justify-between px-4 py-1.5 text-xs text-scale-1100","w-full focus:bg-scale-300 dark:focus:bg-scale-500 focus:text-scale-1200"].join(" "),children:[(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[e.icon,(0,y.jsx)("p",{children:e.name})]}),(0,y.jsx)(h.Z,{size:"tiny"})]})},e.name):"Separator"===e.name?(0,y.jsx)(ie.ZP.Separator,{},"row-separator"):(0,y.jsx)(ie.ZP.Item,{icon:e.icon||(0,y.jsx)(y.Fragment,{}),onClick:e.onClick,children:e.name},e.name)}))],children:(0,y.jsx)("div",{className:"storage-row-menu opacity-0",children:(0,y.jsx)(ce.Z,{size:16,strokeWidth:2})})})})]})})},ve=function(e){var t=e.isOpen,n=e.onDragLeave,r=e.onDrop,s=e.folderIsEmpty;return(0,y.jsx)(M.u,{show:t,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0",enterTo:"transform opacity-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100",leaveTo:"transform opacity-0",className:"h-full w-full absolute top-0",children:(0,y.jsx)("div",{onDragLeave:n,onDrop:r,className:"absolute top-0 flex h-full w-full items-center justify-center",style:{backgroundColor:s?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.2)"},children:!s&&(0,y.jsxs)("div",{className:"w-3/4 h-32 border-2 border-dashed border-gray-400 rounded-md flex flex-col items-center justify-center p-6 pointer-events-none",style:{backgroundColor:"rgba(0,0,0,0.4)"},children:[(0,y.jsx)(W.Z,{className:"text-white pointer-events-none",size:20,strokeWidth:2}),(0,y.jsx)("p",{className:"text-center text-sm  text-white mt-2 pointer-events-none",children:"Drop your files to upload to this folder"})]})})})},be=function(e){var t=e.index,n=void 0===t?0:t,r=e.view,s=void 0===r?p.De.COLUMNS:r,i=e.column,c=void 0===i?{}:i,a=e.fullWidth,l=void 0!==a&&a,u=e.openedFolders,x=void 0===u?[]:u,f=e.selectedItems,h=void 0===f?[]:f,j=e.selectedFilePreview,v=void 0===j?{}:j,b=e.onFilesUpload,g=void 0===b?function(){}:b,w=e.onSelectAllItemsInColumn,N=void 0===w?function(){}:w,k=e.onSelectColumnEmptySpace,O=void 0===k?function(){}:k,S=e.onColumnLoadMore,C=void 0===S?function(){}:S,P=(0,o.useState)(!1),E=P[0],D=P[1],Z=(0,o.useRef)(null);(0,o.useEffect)((function(){if(Z){var e=Z.current,t=e.scrollHeight,n=e.clientHeight;t>n&&(Z.current.scrollTop+=t-n)}}),[c]);var T=h.length>0,I=c.items.map((function(e){return e.id})),z=c.items.filter((function(e){return e.type===p.fh.FILE})),L=h.filter((function(e){return I.includes(e.id)})).filter((function(e){return e.type===p.fh.FILE})),F=c.items,R=(0,d.sum)(F.map((function(e){return(0,d.get)(e,["metadata","size"],0)}))),A=(0,m.av)().show,_=function(e){e&&(e.stopPropagation(),e.preventDefault(),"dragover"!==e.type||E||D(!0))},U=function(){return(0,y.jsx)(G.Z,{label:"",className:"-mt-0.5",checked:0!==z.length&&L.length===z.length,disabled:0===z.length,onChange:function(){return N(n)}})};return(0,y.jsxs)("div",{ref:Z,className:"\n        ".concat(l?"w-full":"w-64 border-r border-panel-border-light dark:border-panel-border-dark","\n        ").concat((p.De.COLUMNS,""),"\n        hide-scrollbar relative flex flex-shrink-0 flex-col overflow-auto\n      "),onContextMenu:function(e){A(e,{id:p.l6.STORAGE_COLUMN,props:{index:n}})},onDragOver:_,onDrop:function(e){_(e),g(e,n)},onClick:function(e){var t=(0,d.get)(e.target,["className"],"");"string"===typeof t&&t.includes("react-contexify")||O(n)},children:[s===p.De.COLUMNS&&(0,y.jsx)("div",{className:"sticky top-0 z-10 mb-0 flex items-center bg-table-header-light px-2.5 dark:bg-table-header-dark ".concat(T>0?"h-10 py-3 opacity-100":"h-0 py-0 opacity-0"," transition-all duration-200"),onClick:function(e){return e.stopPropagation()},children:z.length>0?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(U,{}),(0,y.jsxs)("p",{className:"text-sm text-scale-1100",children:["Select all ",z.length," files"]})]}):(0,y.jsx)("p",{className:"text-sm text-scale-1100",children:"No files available for selection"})}),s===p.De.LIST&&(0,y.jsxs)("div",{className:" sticky top-0 z-10 flex min-w-min items-center border-b border-panel-border-light bg-panel-footer-light px-2.5 py-2 dark:border-panel-border-dark dark:bg-panel-footer-dark ",children:[(0,y.jsxs)("div",{className:"flex w-[40%] min-w-[250px] items-center",children:[(0,y.jsx)(U,{}),(0,y.jsx)("p",{className:"text-sm",children:"Name"})]}),(0,y.jsx)("p",{className:"w-[11%] min-w-[100px] text-sm",children:"Size"}),(0,y.jsx)("p",{className:"w-[14%] min-w-[100px] text-sm",children:"Type"}),(0,y.jsx)("p",{className:"w-[15%] min-w-[160px] text-sm",children:"Created at"}),(0,y.jsx)("p",{className:"w-[15%] min-w-[160px] text-sm",children:"Last modified at"})]}),c.status===p.R9.LOADING&&(0,y.jsxs)("div",{className:"\n            ".concat(l?"w-full":"w-64 border-r border-gray-500","\n            my-1 flex flex-shrink-0 flex-col space-y-1 overflow-auto\n          "),children:[(0,y.jsx)(B.Z,{}),(0,y.jsx)(B.Z,{}),(0,y.jsx)(B.Z,{})]}),(0,y.jsx)(H.Z,{items:F,itemProps:{view:s,columnIndex:n,selectedItems:h,openedFolders:x,selectedFilePreview:v},ItemComponent:je,getItemSize:function(e){return 0!==e&&e===F.length?85:37},hasNextPage:c.status!==p.R9.LOADING&&c.hasMoreItems,isLoadingNextPage:c.isLoadingMoreItems,onLoadNextPage:function(){return C(n,c)}}),0===c.items.length&&c.status!==p.R9.LOADING&&(0,y.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center",children:[(0,y.jsx)("img",{src:"".concat(de.GW,"/img/storage-placeholder.svg"),className:"opacity-75 pointer-events-none"}),(0,y.jsx)("p",{className:"my-3 opacity-75",children:"Drop your files here"}),(0,y.jsx)("p",{className:"w-40 text-center text-sm text-scale-1100",children:'Or upload them via the "Upload file" button above'})]}),(0,y.jsx)(ve,{isOpen:E,onDragLeave:function(){return D(!1)},onDrop:function(){return D(!1)},folderIsEmpty:0===c.items.filter((function(e){return e.status!==p.R9.LOADING})).length}),s===p.De.LIST&&(0,y.jsx)("div",{className:" sticky bottom-0 z-10 flex min-w-min items-center bg-panel-footer-light px-2.5 py-2 dark:bg-panel-footer-dark ",children:(0,y.jsxs)("p",{className:"text-sm",children:[(0,le.td)(R)," for ",F.length," items"]})})]})},ye=(0,l.Pi)((function(e){var t=e.view,n=void 0===t?p.De.COLUMNS:t,r=e.columns,s=void 0===r?[]:r,i=e.openedFolders,c=void 0===i?[]:i,a=e.selectedItems,l=void 0===a?[]:a,d=e.selectedFilePreview,u=void 0===d?{}:d,m=e.onFilesUpload,x=void 0===m?function(){}:m,f=e.onSelectAllItemsInColumn,h=void 0===f?function(){}:f,j=e.onSelectColumnEmptySpace,v=void 0===j?function(){}:j,b=e.onColumnLoadMore,g=void 0===b?function(){}:b,w=(0,o.useRef)(null);return(0,o.useEffect)((function(){if(w){var e=w.current,t=e.scrollWidth,n=e.clientWidth;t>n&&(w.current.scrollLeft+=t-n)}}),[s]),(0,y.jsxs)("div",{ref:w,className:"file-explorer flex flex-grow overflow-x-auto justify-between h-full w-full",children:[(0,y.jsx)(U,{id:p.l6.STORAGE_COLUMN}),(0,y.jsx)(P,{id:p.l6.STORAGE_ITEM}),(0,y.jsx)(E,{id:p.l6.STORAGE_FOLDER}),n===p.De.COLUMNS?(0,y.jsx)("div",{className:"flex",children:s.map((function(e,t){return(0,y.jsx)(be,{index:t,view:n,column:e,openedFolders:c,selectedItems:l,selectedFilePreview:u,onFilesUpload:x,onSelectAllItemsInColumn:h,onSelectColumnEmptySpace:v,onColumnLoadMore:g},"column-".concat(t))}))}):n===p.De.LIST?(0,y.jsx)(y.Fragment,{children:s.length>0&&(0,y.jsx)(be,{fullWidth:!0,index:s.length-1,view:n,column:s[s.length-1],selectedItems:l,selectedFilePreview:u,onFilesUpload:x,onSelectAllItemsInColumn:h,onSelectColumnEmptySpace:v,onColumnLoadMore:g})}):(0,y.jsxs)("div",{children:["Unknown view: ",n]})]})})),ge=n(47314),we=n(93986),Ne=n(86673),ke=n(3648),Oe=n(95992),Se=n(2686),Ce=n(62929),Pe=n(1296),Ee=n(70946),De=function(e){var t=e.loading,n=e.breadcrumbs,r=e.togglePathEdit;return(0,y.jsx)("div",{className:"group ".concat(t?"":"cursor-pointer"),onClick:function(){return t.isLoading?{}:r()},children:t.isLoading?(0,y.jsxs)("div",{className:"ml-2 flex items-center",children:[(0,y.jsx)(V.Z,{size:16,strokeWidth:2,className:"animate-spin"}),(0,y.jsx)("p",{className:"ml-3 text-sm",children:t.message})]}):(0,y.jsxs)("div",{className:"flex cursor-pointer items-center",children:[(0,y.jsx)("p",{className:"ml-3 text-sm truncate",children:n[n.length-1]||""}),(0,y.jsx)("div",{className:"ml-3 flex items-center space-x-2 opacity-0 transition group-hover:opacity-100",children:(0,y.jsx)(ge.z,{type:"text",icon:(0,y.jsx)(we.Z,{}),children:"Navigate"})})]})})},Ze=function(e){var t=e.loading,n=e.breadcrumbs,r=e.selectBreadcrumb,s="...",i=n.map((function(e,t){return{name:e,index:t}})),c=i.length<=5?i:i.slice(0,2).concat([{name:s,index:-1}]).concat(i.slice(i.length-2,i.length));return t.isLoading?(0,y.jsxs)("div",{className:"ml-2 flex items-center",children:[(0,y.jsx)(V.Z,{size:16,strokeWidth:2,className:"animate-spin"}),(0,y.jsx)("p",{className:"ml-3 text-sm",children:t.message})]}):(0,y.jsx)("div",{className:"ml-3 flex items-center",children:c.map((function(e,t){return(0,y.jsxs)("div",{className:"flex items-center",children:[0!==t&&(0,y.jsx)(h.Z,{size:10,strokeWidth:2,className:"mx-3"}),(0,y.jsx)("p",{className:"truncate text-sm ".concat(e.name!==s?"cursor-pointer":""),style:{maxWidth:"6rem"},onClick:function(){return e.name!==s?r(e.index):{}},children:e.name},e.name)]},e.name)}))})},Te=function(e){var t=e.itemSearchString,n=void 0===t?"":t,r=e.setItemSearchString,s=void 0===r?function(){}:r,c=e.onFilesUpload,l=void 0===c?function(){}:c,m=(0,o.useState)(""),f=m[0],h=m[1],j=(0,o.useState)(""),v=j[0],b=j[1],g=(0,o.useState)({isLoading:!1,message:""}),w=g[0],N=g[1],k=(0,o.useState)(!1),O=k[0],S=k[1],P=(0,o.useState)(!1),E=P[0],D=P[1],Z=(0,o.useState)(!1),I=Z[0],L=Z[1],F=(0,o.useRef)(null),A=(0,o.useRef)(null),_=(0,u.HN)(),U=_.view,G=_.setView,M=_.columns,H=_.sortBy,B=_.setSortBy,Y=_.sortByOrder,V=_.setSortByOrder,K=_.popColumn,$=_.popColumnAtIndex,Q=_.popOpenedFolders,q=_.fetchFoldersByPath,J=_.refetchAllOpenedFolders,X=_.addNewFolderPlaceholder,ee=_.clearOpenedFolders,te=_.closeFilePreview,ne=M.map((function(e){return e.name})),re=M.length<=1,se=(0,C.FH)(x.KA.STORAGE_ADMIN_WRITE,"*");(0,o.useEffect)((function(){n&&b(n)}),[]),(0,o.useEffect)((function(){(0,d.isEqual)(A.current,ne)||(S(!1),A.current=ne)}),[ne]);var ce=(0,o.useCallback)((0,d.debounce)(s,300),[]),ae=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=6;break}$(0),ee(),te(),e.next=11;break;case 6:return n=t.join("/"),N({isLoading:!0,message:"Navigating to ".concat(n,"...")}),e.next=10,q(t);case 10:N({isLoading:!1,message:""});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(){b(""),L(!1),s("")},de=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),e.next=3,J();case 3:D(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,y.jsxs)("div",{className:" flex h-[40px] items-center justify-between rounded-t-md border-b border-panel-border-light bg-panel-header-light px-2 dark:border-panel-border-dark dark:bg-panel-header-dark",children:[(0,y.jsxs)("div",{className:"flex items-center ".concat(O?"w-1/2":""),children:[ne.length>0&&(0,y.jsx)(ge.z,{icon:(0,y.jsx)(Ne.Z,{size:16,strokeWidth:2}),size:"tiny",type:"text",className:ne.length>1?"opacity-100":"opacity-25",disabled:re,onClick:function(){S(!1),K(),Q(),te()}}),O?(0,y.jsx)("form",{className:"ml-2 flex-grow",children:(0,y.jsx)(ke.Z,{autoFocus:!0,type:"text",size:"small",value:f,onChange:function(e){h(e.target.value)},placeholder:"e.g Parent Folder/Child Folder",actions:[(0,y.jsx)(ge.z,{type:"default",htmlType:"button",onClick:function(){S(!1)},children:"Cancel"},"cancelPath"),(0,y.jsx)(ge.z,{type:"primary",htmlType:"submit",onClick:function(e){e&&(e.preventDefault(),e.stopPropagation()),S(!1),ae((0,d.compact)(f.split("/")))},children:"Go to folder"},"setPath")]},"pathSet")}):U===p.De.COLUMNS?(0,y.jsx)(De,{loading:w,breadcrumbs:ne,togglePathEdit:function(){S(!0),h(ne.slice(1).join("/")),I&&le()}}):(0,y.jsx)(Ze,{loading:w,breadcrumbs:ne,selectBreadcrumb:function(e){$(e)}})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,y.jsx)(ge.z,{className:"mr-2",size:"tiny",icon:(0,y.jsx)(Oe.Z,{}),type:"text",loading:E,onClick:de,children:"Reload"}),(0,y.jsx)(ie.ZP,{overlay:[(0,y.jsxs)(ie.ZP.RadioGroup,{value:U,onChange:G,children:[(0,y.jsx)(ie.ZP.Radio,{value:p.De.COLUMNS,children:"Columns"}),(0,y.jsx)(ie.ZP.Radio,{value:p.De.LIST,children:"List"})]},"viewOptions")],children:(0,y.jsx)(ge.z,{as:"span",icon:"LIST"===U?(0,y.jsx)(Se.Z,{size:16,strokeWidth:2}):(0,y.jsx)(Ce.Z,{size:16,strokeWidth:2}),type:"text",disabled:0===ne.length,onChange:G,children:"View as"})}),(0,y.jsx)(ie.ZP,{overlay:[(0,y.jsxs)(ie.ZP.RadioGroup,{value:H,onChange:B,children:[(0,y.jsx)(ie.ZP.Radio,{value:p.Ye.NAME,children:"Name"}),(0,y.jsx)(ie.ZP.Radio,{value:p.Ye.CREATED_AT,children:"Time created"}),(0,y.jsx)(ie.ZP.Radio,{value:p.Ye.UPDATED_AT,children:"Time modified"}),(0,y.jsx)(ie.ZP.Radio,{value:p.Ye.LAST_ACCESSED_AT,children:"Time last accessed"})]},"sortOptions")],children:(0,y.jsx)(ge.z,{as:"span",icon:(0,y.jsx)(z.Z,{size:16,strokeWidth:2}),type:"text",disabled:0===ne.length,children:"Sort by"})}),(0,y.jsx)(ie.ZP,{overlay:[(0,y.jsxs)(ie.ZP.RadioGroup,{value:Y,onChange:V,children:[(0,y.jsx)(ie.ZP.Radio,{value:p.sd.ASC,children:"Ascending"}),(0,y.jsx)(ie.ZP.Radio,{value:p.sd.DESC,children:"Descending"})]},"sortOrderOptions")],children:(0,y.jsx)(ge.z,{as:"span",icon:Y===p.sd.DESC?(0,y.jsx)(z.Z,{size:16,strokeWidth:2}):(0,y.jsx)(R,{size:16,strokeWidth:2}),type:"text",disabled:0===ne.length,children:"Sort Order"})})]}),(0,y.jsx)("div",{className:"h-6 border-r border-panel-border-light dark:border-panel-border-dark"}),(0,y.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,y.jsx)("div",{className:"hidden",children:(0,y.jsx)("input",{ref:F,type:"file",multiple:!0,onChange:l})}),(0,y.jsxs)(oe.fC,{delayDuration:0,children:[(0,y.jsx)(oe.xz,{className:"w-full",children:(0,y.jsx)(ge.z,{icon:(0,y.jsx)(W.Z,{size:16,strokeWidth:2}),type:"text",disabled:!se||0===ne.length,onClick:function(){F.current&&F.current.click()},children:"Upload files"})}),!se&&(0,y.jsx)(oe.h_,{children:(0,y.jsxs)(oe.VY,{side:"bottom",children:[(0,y.jsx)(oe.Eh,{className:"radix-tooltip-arrow"}),(0,y.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,y.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to upload files"})})]})})]}),(0,y.jsxs)(oe.fC,{delayDuration:0,children:[(0,y.jsx)(oe.xz,{className:"w-full",children:(0,y.jsx)(ge.z,{icon:(0,y.jsx)(T,{size:16,strokeWidth:2}),type:"text",disabled:!se||0===ne.length,onClick:function(){return X(-1)},children:"Create folder"})}),!se&&(0,y.jsx)(oe.h_,{children:(0,y.jsxs)(oe.VY,{side:"bottom",children:[(0,y.jsx)(oe.Eh,{className:"radix-tooltip-arrow"}),(0,y.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,y.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to create folders"})})]})})]})]}),U===p.De.LIST&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"h-6 border-r border-panel-border-light dark:border-panel-border-dark"}),(0,y.jsx)("div",{className:"flex items-center",children:I?(0,y.jsx)(ke.Z,{size:"tiny",autoFocus:!0,className:"w-52",icon:(0,y.jsx)(Pe.Z,{size:"tiny",strokeWidth:2}),actions:[(0,y.jsx)(Ee.Z,{className:"mx-2 cursor-pointer text-scale-1200",size:"tiny",strokeWidth:2,onClick:le},"close")],placeholder:"Search for a file or folder",type:"text",value:v,onChange:function(e){b(e.target.value),ce(e.target.value)}}):(0,y.jsx)(ge.z,{icon:(0,y.jsx)(Pe.Z,{size:16,strokeWidth:2}),size:"tiny",type:"text",onClick:function(){S(!1),L(!0)}})})]})]})]})},Ie=function(){var e=(0,u.HN)(),t=e.selectedItems,n=e.downloadFile,r=e.downloadSelectedFiles,s=e.clearSelectedItems,c=e.setSelectedItemsToDelete,o=e.setSelectedItemsToMove;return(0,y.jsxs)("div",{className:"z-10 flex h-[40px] items-center rounded-t-md bg-brand-700 px-2 py-1 shadow dark:bg-brand-600",children:[(0,y.jsx)(ge.z,{icon:(0,y.jsx)(Ee.Z,{size:16,strokeWidth:2}),type:"text",shadow:!1,onClick:function(){return s()}}),(0,y.jsxs)("div",{className:"ml-4 flex items-center space-x-3",children:[(0,y.jsxs)("p",{className:"mb-0 text-sm text-scale-1200",children:[(0,y.jsx)("span",{style:{fontVariantNumeric:"tabular-nums"},children:t.length})," items selected"]}),(0,y.jsx)(ge.z,{icon:(0,y.jsx)(N.Z,{size:16,strokeWidth:2}),type:"primary",shadow:!1,onClick:(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==t.length){e.next=5;break}return e.next=3,n(t[0]);case 3:e.next=7;break;case 5:return e.next=7,r(t);case 7:case"end":return e.stop()}}),e)}))),children:"Download"}),(0,y.jsx)("div",{className:"border-r border-green-800 py-3 opacity-50"}),(0,y.jsx)(ge.z,{icon:(0,y.jsx)(S,{size:16,strokeWidth:2}),type:"primary",shadow:!1,onClick:function(){return c(t)},children:"Delete"}),(0,y.jsx)(ge.z,{icon:(0,y.jsx)(w,{size:16,strokeWidth:2}),type:"primary",shadow:!1,onClick:function(){return o(t)},children:"Move"})]})]})},ze=n(94269),Le=n(11597),Fe=function(e){var t=e.visible,n=void 0!==t&&t,r=e.selectedItemsToDelete,s=void 0===r?[]:r,i=e.onSelectCancel,c=void 0===i?function(){}:i,a=e.onSelectDelete,l=void 0===a?function(){}:a,d=(0,o.useState)(!1),u=d[0],p=d[1];(0,o.useEffect)((function(){p(!1)}),[n]);var m=s.length>1,x=m?"Confirm deletion of ".concat(s.length," items"):1===s.length?"Confirm deletion of ".concat(s[0].name):"",f=m?"Are you sure you want to delete the selected ".concat(s.length," items?"):1===s.length?"Are you sure you want to delete the selected ".concat(s[0].type.toLowerCase(),"?"):"";return(0,y.jsx)(ze.C,{visible:n,header:(0,y.jsx)("span",{className:"break-words",children:x}),size:"medium",onCancel:c,customFooter:(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(ge.z,{type:"default",disabled:u,onClick:c,children:"Cancel"}),(0,y.jsx)(ge.z,{type:"primary",danger:!0,disabled:u,loading:u,onClick:function(){p(!0),l()},children:u?"Deleting":"Delete"})]}),children:(0,y.jsx)(ze.C.Content,{children:(0,y.jsx)("div",{className:"my-4",children:(0,y.jsx)(Le.Z,{withIcon:!0,variant:"danger",title:"This action cannot be undone.",children:f})})})})},Re=function(e){var t,n=e.bucketName,r=void 0===n?"":n,s=e.visible,i=void 0!==s&&s,c=e.selectedItemsToMove,a=void 0===c?[]:c,l=e.onSelectCancel,d=void 0===l?function(){}:l,u=e.onSelectMove,p=void 0===u?function(){}:u,m=(0,o.useState)(!1),x=m[0],f=m[1],h=(0,o.useState)(""),j=h[0],v=h[1];(0,o.useEffect)((function(){f(!1),v("")}),[i]);var b=a.length>1,g=b?"Moving ".concat(a.length," items within ").concat(r):1===a.length?"Moving ".concat(null===(t=a[0])||void 0===t?void 0:t.name," within ").concat(r):"",w="Enter the path to where you'd like to move the file".concat(b?"s":""," to."),N=function(e){e&&e.preventDefault(),f(!0);var t="/"===j[0]?j.slice(1):j;p(t)};return(0,y.jsx)(ze.C,{visible:i,header:g,description:w,size:"medium",onCancel:d,customFooter:(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(ge.z,{type:"default",onClick:d,children:"Cancel"}),(0,y.jsx)(ge.z,{type:"primary",loading:x,onClick:N,children:x?"Moving files":"Move files"})]}),children:(0,y.jsx)(ze.C.Content,{children:(0,y.jsxs)("form",{className:"my-4",children:[(0,y.jsx)("div",{className:"relative flex items-center",children:(0,y.jsx)(ke.Z,{autoFocus:!0,label:"Path to new directory in ".concat(r),type:"text",className:"w-full",placeholder:"e.g folder1/subfolder2",value:j,descriptionText:"Leave blank to move items to the root of the bucket",onChange:function(e){return v(e.target.value)}})}),(0,y.jsx)("button",{className:"hidden",type:"submit",onClick:N})]})})})},Ae=n(51664),_e=function(e){var t=e.mimeType,n=e.previewUrl;return t&&n?"loading"===n?(0,y.jsx)("div",{className:"flex h-full w-full items-center justify-center text-scale-900",children:(0,y.jsx)(V.Z,{size:14,strokeWidth:2,className:"animate-spin"})}):"skipped"===n?(0,y.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center",children:[(0,y.jsx)(ae.Z,{src:"".concat(de.GW,"/img/file-filled.svg"),preProcessor:function(e){return e.replace(/svg/,'svg class="mx-auto w-32 h-32 text-color-inherit opacity-75"')}}),(0,y.jsx)("p",{className:"mt-2 w-2/5 text-center text-sm",children:"File size is too large to preview in the explorer"})]}):t.includes("image")?(0,y.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-contain bg-center bg-no-repeat",style:{backgroundImage:"url('".concat(n,"')")}}):t.includes("audio")?(0,y.jsx)("div",{className:"flex h-full w-full items-center justify-center px-10",children:(0,y.jsxs)("audio",{controls:!0,style:{width:"inherit"},children:[(0,y.jsx)("source",{src:n,type:"audio/mpeg"}),(0,y.jsx)("p",{className:"text-sm text-scale-1100",children:"Your browser does not support the audio element."})]},n)}):t.includes("video")?(0,y.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,y.jsxs)("video",{controls:!0,style:{maxHeight:"100%"},children:[(0,y.jsx)("source",{src:n,type:"video/mp4"}),(0,y.jsx)("p",{className:"text-sm text-scale-1100",children:"Your browser does not support the video tag."})]},n)}):(0,y.jsx)(ae.Z,{src:"".concat(de.GW,"/img/file-filled.svg"),preProcessor:function(e){return e.replace(/svg/,'svg class="mx-auto w-32 h-32 text-color-inherit opacity-75"')}}):(0,y.jsx)(ae.Z,{src:"".concat(de.GW,"/img/file-filled.svg"),preProcessor:function(e){return e.replace(/svg/,'svg class="mx-auto w-32 h-32 text-color-inherit opacity-75"')}})},Ue=function(){var e=(0,u.HN)(),t=e.downloadFile,n=e.selectedBucket,r=e.selectedFilePreview,s=e.copyFileURLToClipboard,c=e.closeFilePreview,o=e.setSelectedItemsToDelete,l=e.setSelectedFileCustomExpiry,m=!(0,d.isEmpty)(r),h=r.metadata?(0,le.td)(r.metadata.size):null,j=r.metadata?r.metadata.mimetype:null,v=r.created_at?new Date(r.created_at).toLocaleString():"Unknown",b=r.updated_at?new Date(r.updated_at).toLocaleString():"Unknown",g=(0,C.FH)(x.KA.STORAGE_ADMIN_WRITE,"*");return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(M.u,{show:m,enter:"transition ease-out duration-150",enterFrom:"transform opacity-0",enterTo:"transform opacity-100",leave:"transition ease-in duration-100",leaveFrom:"transform opacity-100",leaveTo:"transform opacity-0",children:(0,y.jsxs)("div",{className:" h-full border-l border-panel-border-light bg-panel-header-light p-4 dark:border-panel-border-dark dark:bg-panel-header-dark",style:{width:450},children:[(0,y.jsx)("div",{className:"flex w-full justify-end text-scale-900 transition-colors hover:text-scale-1200",children:(0,y.jsx)(Ee.Z,{className:"cursor-pointer",size:14,strokeWidth:2,onClick:function(){return c()}})}),(0,y.jsx)("div",{className:"my-4 border border-panel-border-light dark:border-panel-border-dark",children:(0,y.jsx)("div",{className:"flex h-56 w-full items-center 2xl:h-72",children:(0,y.jsx)(_e,{mimeType:j,previewUrl:r.previewUrl})})}),(0,y.jsxs)("div",{className:"w-full space-y-6",children:[(0,y.jsxs)("div",{className:"space-y-1",children:[(0,y.jsx)("h5",{className:"break-words text-base text-scale-1200",children:r.name}),r.isCorrupted&&(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(se.Z,{size:14,strokeWidth:2,className:"text-scale-1100"}),(0,y.jsx)("p",{className:"text-sm text-scale-1100",children:"File is corrupted, please delete and reupload this file again"})]}),j&&(0,y.jsxs)("p",{className:"text-sm text-scale-1100",children:[j,h&&(0,y.jsxs)("span",{children:[" - ",h]})]})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"mb-1 text-xs text-scale-900",children:"Added on"}),(0,y.jsx)("p",{className:"text-sm text-scale-1100",children:v})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"mb-1 text-xs text-scale-900",children:"Last modified"}),(0,y.jsx)("p",{className:"text-sm text-scale-1100",children:b})]})]}),(0,y.jsxs)("div",{className:"flex space-x-2 border-b border-panel-border-light pb-4 dark:border-panel-border-dark",children:[(0,y.jsx)(ge.z,{type:"default",icon:(0,y.jsx)(N.Z,{size:16,strokeWidth:2}),disabled:r.isCorrupted,onClick:(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),children:"Download"}),n.public?(0,y.jsx)(ge.z,{type:"outline",icon:(0,y.jsx)(f.Z,{size:16,strokeWidth:2}),onClick:(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),disabled:r.isCorrupted,children:"Get URL"}):(0,y.jsx)(ie.ZP,{side:"bottom",align:"center",overlay:[(0,y.jsx)(ie.ZP.Item,{onClick:(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(r,p.Qo.WEEK);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),children:"Expire in 1 week"},"expires-one-week"),(0,y.jsx)(ie.ZP.Item,{onClick:(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(r,p.Qo.MONTH);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),children:"Expire in 1 month"},"expires-one-month"),(0,y.jsx)(ie.ZP.Item,{onClick:(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(r,p.Qo.YEAR);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),children:"Expire in 1 year"},"expires-one-year"),(0,y.jsx)(ie.ZP.Item,{onClick:function(){return l(r)},children:"Custom expiry"},"custom-expiry")],children:(0,y.jsx)(ge.z,{type:"outline",icon:(0,y.jsx)(f.Z,{size:16,strokeWidth:2}),iconRight:(0,y.jsx)(Ae.Z,{}),disabled:r.isCorrupted,children:"Get URL"})})]}),(0,y.jsxs)(oe.fC,{delayDuration:0,children:[(0,y.jsx)(oe.xz,{children:(0,y.jsx)(ge.z,{type:"outline",disabled:!g,shadow:!1,size:"tiny",icon:(0,y.jsx)(S,{size:16,strokeWidth:2}),onClick:function(){return o([r])},children:"Delete file"})}),!g&&(0,y.jsx)(oe.h_,{children:(0,y.jsxs)(oe.VY,{side:"bottom",children:[(0,y.jsx)(oe.Eh,{className:"radix-tooltip-arrow"}),(0,y.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,y.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to delete this file"})})]})})]})]})]})})})},We=n(77758),Ge=(0,l.Pi)((function(){var e=(0,u.HN)(),t=e.selectedFileCustomExpiry,n=e.setSelectedFileCustomExpiry,r=e.copyFileURLToClipboard,s=void 0!==t,c=function(){return n(void 0)};return(0,y.jsx)(ze.C,{hideFooter:!0,size:"small",header:"Custom expiry for signed URL",visible:s,alignFooter:"right",confirmText:"Get URL",onCancel:function(){return c()},children:(0,y.jsx)(We.Z,{validateOnBlur:!0,initialValues:{expiresIn:""},onSubmit:function(){var e=(0,i.Z)(a().mark((function e(n,s){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=s.setSubmitting)(!0),e.next=4,r(t,n.expiresIn);case 4:i(!1),c();case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),validate:function(e){var t={};return""!==e.expiresIn&&e.expiresIn<=0&&(t.expiresIn="Expiry duration cannot be less than 0"),t},children:function(e){var t=e.values,n=e.isSubmitting;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"py-6",children:(0,y.jsx)(ze.C.Content,{children:(0,y.jsx)(ke.Z,{disabled:n,type:"number",id:"expiresIn",label:"Enter the duration for which the URL will be valid:",actions:(0,y.jsx)("p",{className:"text-sm text-scale-1000 mr-2",children:"seconds"})})})}),(0,y.jsx)(ze.C.Separator,{}),(0,y.jsx)(ze.C.Content,{children:(0,y.jsxs)("div",{className:"flex items-center justify-end space-x-2 pt-1 pb-3",children:[(0,y.jsx)(ge.z,{type:"default",onClick:function(){return c()},children:"Cancel"}),(0,y.jsx)(ge.z,{disabled:""===t.expiresIn||n,loading:n,htmlType:"submit",type:"primary",children:"Get signed URL"})]})})]})}})})}));function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Be=(0,l.Pi)((function(e){var t=e.bucket,n=(0,u.HN)(),s=n.columns,c=n.selectedFilePreview,l=n.closeFilePreview,m=n.selectedItems,x=n.setSelectedItems,f=n.clearSelectedItems,h=n.selectedItemsToDelete,j=n.clearSelectedItemsToDelete,v=n.openedFolders,b=n.popColumnAtIndex,g=n.popOpenedFoldersAtIndex,w=n.selectedItemsToMove,N=n.clearSelectedItemsToMove,k=n.view,O=n.currentBucketName,S=n.openBucket,C=n.loadExplorerPreferences,P=n.fetchFolderContents,E=n.fetchMoreFolderContents,D=n.deleteFolder,Z=n.uploadFiles,T=n.deleteFiles,I=n.moveFiles,z=(0,o.useRef)(null),L=(0,o.useState)(""),F=L[0],R=L[1],A=window.innerHeight-122;(0,o.useEffect)((0,i.Z)(a().mark((function e(){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=v.length-1,r=v[n],!F){e.next=12;break}if(r){e.next=8;break}return e.next=6,P(t.id,t.name,-1,F);case 6:e.next=10;break;case 8:return e.next=10,P(r.id,r.name,n,F);case 10:case 15:e.next=19;break;case 12:if(r){e.next=17;break}return e.next=15,P(t.id,t.name,-1);case 17:return e.next=19,P(r.id,r.name,n);case 19:case"end":return e.stop()}}),e)}))),[F]),(0,o.useEffect)((function(){C()}),[]),(0,o.useEffect)((function(){S(t)}),[t]);var _=function(){var e=(0,i.Z)(a().mark((function e(t){var n,r,s,i=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:-1,t.persist(),r=t.target.files||t.dataTransfer.items,s=!(0,d.isEmpty)((0,d.get)(t,["dataTransfer","items"],[])),e.next=6,Z(r,n,s);case 6:t.target.value="";case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==h.length){e.next=15;break}if(t=(0,r.Z)(h,1),n=t[0]){e.next=4;break}return e.abrupt("return");case 4:e.t0=n.type,e.next=e.t0===p.fh.FOLDER?7:e.t0===p.fh.FILE?10:13;break;case 7:return e.next=9,D(n);case 9:case 12:return e.abrupt("break",13);case 10:return e.next=12,T([n]);case 13:e.next=17;break;case 15:return e.next=17,T(h);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,y.jsxs)("div",{ref:z,className:" bg-scale-200 border-panel-border-light dark:border-panel-border-dark flex h-full w-full flex-col rounded-md border",children:[0===m.length?(0,y.jsx)(Te,{itemSearchString:F,setItemSearchString:R,onFilesUpload:_}):(0,y.jsx)(Ie,{}),(0,y.jsxs)("div",{className:"flex h-full",style:{height:A},children:[(0,y.jsx)(ye,{view:k,columns:s,openedFolders:v,selectedItems:m,selectedFilePreview:c,onFilesUpload:_,onSelectAllItemsInColumn:function(e){var t=s[e].items.filter((function(e){return e.type===p.fh.FILE})).map((function(t){return He(He({},t),{},{columnIndex:e})})),n=(0,d.compact)(t.map((function(e){return e.id})));if(m.filter((function(e){return n.includes(e.id)})).length===t.length){var r=m.filter((function(e){return!n.includes(e.id)}));x(r)}else{var i=(0,d.uniqBy)(m.concat(t),"id");x(i)}},onSelectColumnEmptySpace:function(e){b(e),g(e-1),l(),f()},onColumnLoadMore:function(e,t){return E(e,t,F)}}),(0,y.jsx)(Ue,{})]}),(0,y.jsx)(Fe,{visible:h.length>0,selectedItemsToDelete:h,onSelectCancel:j,onSelectDelete:W}),(0,y.jsx)(Re,{bucketName:O,visible:w.length>0,selectedItemsToMove:w,onSelectCancel:N,onSelectMove:U}),(0,y.jsx)(Ge,{})]})})),Ye=Be,Ve=n(20505),Ke=n(23753),$e=n(96423),Qe=function(e){e.guiHeight;return(0,y.jsx)($e.Z,{title:[(0,y.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,y.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,y.jsx)(Ke.Z,{size:"small"}),(0,y.jsx)("h4",{children:"Bucket policies"})]})},"storagePlaceholder")],children:(0,y.jsx)("div",{className:"p-4 px-6",children:(0,y.jsx)("p",{className:"text-sm text-scale-1100",children:"Create a bucket first to start writing policies!"})})})},qe=n(44315),Je=n(84364),Xe=function(e){var t=e.policy,n=e.table,r=e.bucketName,s=e.onSelectPolicyEdit,i=void 0===s?function(){}:s,c=e.onSelectPolicyDelete,a=void 0===c?function(){}:c,o=t.name,l=t.command;return(0,y.jsx)("div",{className:"group",children:(0,y.jsxs)($e.Z.Content,{className:"flex justify-between gap-2 border-b border-panel-border-light py-4 dark:border-panel-border-dark",children:[(0,y.jsxs)("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center",children:[(0,y.jsx)("div",{className:"font-mono text-xs text-scale-900",children:l}),(0,y.jsx)("div",{className:"flex flex-col gap-2 lg:flex-row",children:(0,y.jsx)("span",{className:"truncate text-sm text-scale-1200",children:o})})]}),(0,y.jsx)(ie.ZP,{side:"bottom",align:"end",size:"small",overlay:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ie.ZP.Item,{icon:(0,y.jsx)(j.Z,{size:14}),type:"outline",className:"mx-2",onClick:function(){return i(t,r,n)},children:"Edit"}),(0,y.jsx)(ie.ZP.Separator,{}),(0,y.jsx)(ie.ZP.Item,{icon:(0,y.jsx)(qe.Z,{size:14}),type:"outline",onClick:function(){return a(t)},children:"Delete"})]}),children:(0,y.jsx)(ge.z,{type:"default",style:{paddingLeft:4,paddingRight:4},icon:(0,y.jsx)(ce.Z,{})})})]})})},et=function(e){var t=e.table,n=void 0===t?"":t,r=e.label,s=void 0===r?"":r,i=e.bucket,c=void 0===i?{}:i,a=e.policies,o=void 0===a?[]:a,l=e.onSelectPolicyAdd,u=void 0===l?function(){}:l,p=e.onSelectPolicyEdit,m=void 0===p?function(){}:p,x=e.onSelectPolicyDelete,f=void 0===x?function(){}:x;return(0,y.jsx)($e.Z,{title:[(0,y.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,y.jsx)(Ke.Z,{className:"text-scale-1000",size:"small"}),(0,y.jsx)("h4",{className:"m-0 text-lg",children:(0,y.jsx)("span",{children:s})}),c.public&&(0,y.jsx)(Je.Z,{color:"yellow",children:"Public"})]}),(0,y.jsx)(ge.z,{type:"outline",onClick:function(){return u(c.name,n)},children:"New policy"})]},s)],children:0===o.length?(0,y.jsx)("div",{className:"p-4 px-6",children:(0,y.jsx)("p",{className:"text-sm text-scale-900",children:"No policies created yet"})}):(0,y.jsxs)("div",{className:"grid grid-cols-1 divide-y dark:divide-dark",children:[o.map((function(e){return(0,y.jsx)(Xe,{policy:e,table:n,bucketName:c.name,onSelectPolicyEdit:m,onSelectPolicyDelete:f},e.name)})),0!==o.length?(0,y.jsx)("div",{className:"px-6 py-2",children:(0,y.jsx)("p",{className:"text-sm text-scale-1100",children:(0,d.isEmpty)(c)?"objects"===n?"".concat(o.length," polic").concat(o.length>1?"ies":"y"," that are not tied to any buckets"):"".concat(o.length," polic").concat(o.length>1?"ies":"y"," that target your buckets"):"".concat(o.length," polic").concat(o.length>1?"ies":"y"," in ").concat(c.name)})}):null]})})},tt=n(90089),nt=[{id:"policy-1",templateName:"Allow access to JPG images in a public folder to anonymous users",description:"This policy uses native postgres functions, functions from auth and storage schema",name:"Give anon users access to JPG images in folder",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n  -- restrict bucket\n  bucket_id = {bucket_name}\n  -- allow access to only jpg file\n  AND storage.\"extension\"(name) = 'jpg'\n  -- in the public folder\n  AND LOWER((storage.foldername(name))[1]) = 'public'\n  -- to anonymous users\n  AND auth.role() = 'anon'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND storage.\"extension\"(name) = 'jpg' AND LOWER((storage.foldername(name))[1]) = 'public' AND auth.role() = 'anon'",allowedOperations:[]},{id:"policy-2",templateName:"Give users access to only their own a top level folder named as uid",description:"For example a user with id d7bed83c-44a0-4a4f-925f-efc384ea1e50 will be able to access anything under the folder d7bed83c-44a0-4a4f-925f-efc384ea1e50/",name:"Give users access to own folder",statement:'\nCREATE POLICY "policy_name"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n    -- restrict bucket\n    bucket_id = {bucket_name}\n    and auth.uid()::text = (storage.foldername(name))[1]\n);\n    '.trim(),definition:"bucket_id = {bucket_id} AND auth.uid()::text = (storage.foldername(name))[1]",allowedOperations:[]},{id:"policy-3",templateName:"Give users access to a folder only to authenticated users",description:"This policy gives users access to a folder (e.g private) only if they are authenticated",name:"Give users authenticated access to folder",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n    -- restrict bucket\n    bucket_id = {bucket_name}\n    AND (storage.foldername(name))[1] = 'private'\n    AND auth.role() = 'authenticated'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND (storage.foldername(name))[1] = 'private' AND auth.role() = 'authenticated'",allowedOperations:[]},{id:"policy-4",templateName:"Give access to a nested folder called admin/assets only to a specific user",description:'This policy gives read access to all authenticated users for your project to the folder "public"',name:"Give access to a folder",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n\t  -- restrict bucket\n    bucket_id = {bucket_name}\n    AND (storage.foldername(name))[1] = 'admin' AND (storage.foldername(name))[2] = 'assets'\n    AND auth.uid()::text = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND (storage.foldername(name))[1] = 'admin' AND (storage.foldername(name))[2] = 'assets' AND auth.uid()::text = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'",allowedOperations:[]},{id:"policy-5",templateName:"Give access to a file to a user",description:"This policy gives access to a specific file to a specific user",name:"Give access to a file to user",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n\t  -- restrict bucket\n    bucket_id = {bucket_name}\n    AND name = 'admin/assets/Costa Rican Frog.jpg'\n    AND auth.uid()::text = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND name = 'admin/assets/Costa Rican Frog.jpg' AND auth.uid()::text = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'",allowedOperations:[]}],rt=n(8190),st=n(78906),it=n(33885),ct=function(e){var t=e.definition,n=void 0===t?"":t,r=e.onUpdatePolicyDefinition,s=void 0===r?function(){}:r;return(0,y.jsxs)("div",{className:"flex space-x-12",children:[(0,y.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,y.jsx)("label",{className:"text-base text-scale-1100",htmlFor:"policy-name",children:"Policy definition"}),(0,y.jsx)("p",{className:"text-sm text-scale-900",children:"Provide a SQL conditional expression that returns a boolean."})]}),(0,y.jsx)("div",{className:"h-56 w-2/3",children:(0,y.jsx)(st.Z,{defaultValue:n,onInputChange:s})})]})},at=function(e){var t=e.allowedOperations,n=void 0===t?[]:t,r=e.onToggleOperation,s=void 0===r?function(){}:r,i=(0,Ve.GH)(n);return(0,y.jsxs)("div",{className:"flex justify-between space-x-12",children:[(0,y.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,y.jsx)("label",{className:"text-base text-scale-1100",htmlFor:"allowed-operation",children:"Allowed operation"}),(0,y.jsxs)("p",{className:"text-sm text-scale-900",children:["Based on the operations you have selected, you can use the highlighted functions in the"," ",(0,y.jsx)("a",{href:"https://supabase.com/docs/reference/javascript/storage-from-list",target:"_blank",rel:"noreferrer",className:"underline",children:"client library"}),"."]})]}),(0,y.jsxs)("div",{className:"w-2/3",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,y.jsx)(G.Z,{label:"SELECT",onChange:function(){return s("SELECT")},checked:n.includes("SELECT")}),(0,y.jsx)(G.Z,{label:"INSERT",onChange:function(){return s("INSERT")},checked:n.includes("INSERT")}),(0,y.jsx)(G.Z,{label:"UPDATE",onChange:function(){return s("UPDATE")},checked:n.includes("UPDATE")}),(0,y.jsx)(G.Z,{label:"DELETE",onChange:function(){return s("DELETE")},checked:n.includes("DELETE")})]}),(0,y.jsx)("div",{className:"flex w-5/6 flex-wrap",children:Object.keys(p.Eb).map((function(e){return(0,y.jsx)("div",{className:"mr-2 mt-2 font-mono",children:(0,y.jsx)(Je.Z,{color:i.includes(e)?"green":"gray",children:e})},e)}))})]})]})},ot=function(e){var t=e.onViewTemplates,n=void 0===t?function(){}:t,r=e.onReviewPolicy,s=void 0===r?function(){}:r;return(0,y.jsxs)("div",{className:"flex w-full items-center justify-end space-x-4 border-t px-6 py-3 dark:border-dark",children:[(0,y.jsx)(ge.z,{type:"default",onClick:n,children:"View templates"}),(0,y.jsx)(ge.z,{type:"primary",onClick:s,children:"Review"})]})},lt=function(e){var t=e.policyFormFields,n=void 0===t?{}:t,r=e.roles,s=void 0===r?[]:r,i=e.onViewTemplates,c=void 0===i?function(){}:i,a=e.onUpdatePolicyName,o=void 0===a?function(){}:a,l=e.onUpdatePolicyDefinition,d=void 0===l?function(){}:l,u=e.onToggleOperation,p=void 0===u?function(){}:u,m=e.onUpdatePolicyRoles,x=void 0===m?function(){}:m,f=e.onReviewPolicy,h=void 0===f?function(){}:f,j=n.definition,v=n.roles;return(0,y.jsxs)("div",{className:"",children:[(0,y.jsxs)("div",{className:"mb-8 space-y-8 py-6",children:[(0,y.jsx)(ze.C.Content,{children:(0,y.jsx)(it.CM,{name:n.name,limit:50,onUpdatePolicyName:o})}),(0,y.jsx)(ze.C.Separator,{}),(0,y.jsx)(ze.C.Content,{children:(0,y.jsx)(at,{allowedOperations:n.allowedOperations,onToggleOperation:p})}),(0,y.jsx)(ze.C.Separator,{}),(0,y.jsx)(ze.C.Content,{children:(0,y.jsx)(it.$L,{roles:s,selectedRoles:v,onUpdateSelectedRoles:x})}),(0,y.jsx)(ze.C.Separator,{}),(0,y.jsx)(ze.C.Content,{children:(0,y.jsx)(ct,{definition:j,onUpdatePolicyDefinition:d})})]}),(0,y.jsx)(ot,{onViewTemplates:c,onReviewPolicy:h})]})},dt=function(){return(0,y.jsx)("div",{className:"my-10 flex items-center justify-center space-x-2 opacity-50",children:(0,y.jsx)("p",{children:"There are no changes made to this policy"})})},ut=function(e){var t=e.policyStatements,n=void 0===t?[]:t,r=e.onSelectBack,s=void 0===r?function(){}:r,i=e.onSelectSave,c=void 0===i?function(){}:i,a=(0,o.useState)(!1),l=a[0],d=a[1];return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ze.C.Content,{children:(0,y.jsxs)("div",{className:"space-y-6 py-8",children:[(0,y.jsx)("div",{className:"flex items-center justify-between space-y-8 space-x-4",children:(0,y.jsx)("div",{className:"flex flex-col",children:(0,y.jsxs)("p",{className:"text-sm text-scale-1100",children:["These are the SQL statements that will be used to create your policies. The suffix appended to the end of your policy name (",(0,y.jsx)("code",{children:"[hashString]_[number]"}),") just functions as a unique identifier for each of your policies."]})})}),(0,y.jsxs)("div",{className:"space-y-4 overflow-y-auto",style:{maxHeight:"25rem"},children:[0===n.length&&(0,y.jsx)(dt,{}),n.map((function(e,t){var n=e.statement||"";return(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("span",{children:e.description}),(0,y.jsx)("div",{className:"h-40",children:(0,y.jsx)(st.Z,{readOnly:!0,defaultValue:n})})]},"policy_".concat(t))}))]})]})}),(0,y.jsxs)("div",{className:"flex w-full items-center justify-end gap-2 border-t px-6 py-4 dark:border-dark",children:[(0,y.jsx)(ge.z,{type:"default",onClick:s,children:"Back to edit"}),n.length>0&&(0,y.jsx)(ge.z,{type:"primary",onClick:function(){d(!0),c()},loading:l,children:"Save policy"})]})]})},pt=["id"];function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ft={name:"",roles:[],policyIds:[],definition:"",allowedOperations:[]},ht=function(e){var t=e.visible,n=void 0!==t&&t,r=e.bucketName,s=void 0===r?"":r,c=e.roles,l=void 0===c?[]:c,u=e.onSelectCancel,p=void 0===u?function(){}:u,m=e.onCreatePolicies,x=void 0===m?function(){}:m,f=e.onSaveSuccess,h=void 0===f?function(){}:f,j=(0,C.oR)().ui,v=(0,o.useState)(""),b=v[0],g=v[1],w=(0,o.useState)(""),N=w[0],k=w[1],O=(0,o.useState)(ft),S=O[0],P=O[1],E=(0,o.useState)([]),D=E[0],Z=E[1];(0,o.useEffect)((function(){n&&(T(),P(ft))}),[n]);var T=function(){return k(rt.$A.SELECTION)},I=function(e){"new"===e&&P(xt(xt({},S),{},{definition:"bucket_id = '".concat(s,"'")})),k(rt.$A.EDITOR)},z=function(){g(N),k(rt.$A.TEMPLATES)},L=function(){return k(b)},F=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(t);case 2:n=e.sent,-1!==n.indexOf(!0)?I():h();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(e){var t=e.view,n=e.bucketName,r=e.onSelectBackFromTemplates,s=void 0===r?function(){}:r;return t===rt.$A.TEMPLATES?(0,y.jsx)("div",{className:"",children:(0,y.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,y.jsx)("span",{onClick:s,className:"cursor-pointer text-scale-900 transition-colors hover:text-scale-1200",children:(0,y.jsx)(Ne.Z,{strokeWidth:2,size:14})}),(0,y.jsx)("h4",{className:"textlg m-0",children:"Select a template to use for your new policy"})]})}):(0,y.jsx)("div",{className:"flex items-center space-x-3",children:(0,y.jsx)("h4",{className:"m-0 text-lg",children:t===rt.$A.EDITOR||t===rt.$A.SELECTION?"Adding new policy to ".concat(n):t===rt.$A.REVIEW?"Reviewing policies to be created for ".concat(n):void 0})})};return(0,y.jsx)(ze.C,{size:N===rt.$A.SELECTION?"medium":"xxlarge",closable:!0,hideFooter:!0,visible:n,contentStyle:{padding:0},header:[(0,y.jsx)(R,{view:N,bucketName:s,onSelectBackFromTemplates:L},"0")],onCancel:p,children:(0,y.jsx)("div",{className:"w-full",children:N===rt.$A.SELECTION?(0,y.jsx)(rt.pT,{description:"PostgreSQL policies control access to your files and folders",onViewTemplates:z,onViewEditor:function(){return I("new")}}):N===rt.$A.EDITOR?(0,y.jsx)(lt,{roles:l,policyFormFields:S,onViewTemplates:z,onUpdatePolicyName:function(e){e.length<=50&&P(xt(xt({},S),{},{name:e}))},onUpdatePolicyDefinition:function(e){P(xt(xt({},S),{},{definition:e}))},onToggleOperation:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return P(xt(xt({},S),{},{allowedOperations:[e]}));var n=S.allowedOperations.includes(e)?(0,d.pull)(S.allowedOperations.slice(),e):S.allowedOperations.concat([e]);return P(xt(xt({},S),{},{allowedOperations:n}))},onUpdatePolicyRoles:function(e){P(xt(xt({},S),{},{roles:e}))},onReviewPolicy:function(){var e=S.name,t=S.definition,n=S.allowedOperations;if(0===e.length)return j.setNotification({category:"info",message:"Do give your policy a name"});if(0===t.length)return j.setNotification({category:"info",message:"Did you forget to provide a definition for your policy?"});if(0===n.length)return j.setNotification({category:"info",message:"You will need to allow at least one operation in your policy"});var r=(0,Ve.g_)(s,S);Z(r),k(rt.$A.REVIEW)}}):N===rt.$A.TEMPLATES?(0,y.jsx)(rt.jm,{templates:nt,onSelectBackFromTemplates:L,onUseTemplate:function(e){e.id;var t=(0,tt.Z)(e,pt),n=(0,Ve.pD)(t.definition,s);P(xt(xt(xt({},S),t),{},{definition:n})),I()}}):N===rt.$A.REVIEW?(0,y.jsx)(ut,{policyStatements:D,onSelectBack:I,onSelectSave:function(){var e=(0,Ve.n6)(s,S);F(e)}}):(0,y.jsx)("div",{})})})},jt=n(96364),vt=(0,l.Pi)((function(){var e=(0,C.oR)(),t=e.ui,n=e.meta,r=(0,u.HN)(),s=r.loaded,c=r.buckets,l=n.roles.list((function(e){return!n.roles.systemRoles.includes(e.name)})),p=(0,o.useState)([]),m=p[0],x=p[1],f=(0,o.useState)({}),h=f[0],j=f[1],v=(0,o.useState)({}),b=v[0],g=v[1],w=(0,o.useState)({}),N=w[0],k=w[1],O=(0,d.isEmpty)(h)&&!(0,d.isEmpty)(N)&&(0,d.get)(N,["bucket"],"").length>0,S=!(0,d.isEmpty)(N)&&!O,P=(0,d.filter)(m,{table:"objects"}),E=(0,Ve.hM)(c,P),D=(0,d.get)((0,d.find)(E,{name:"Ungrouped"}),["policies"],[]),Z=(0,d.filter)(m,{table:"buckets"});(0,o.useEffect)((function(){T()}),[]);var T=function(){var e=(0,i.Z)(a().mark((function e(){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return e.next=3,n.policies.load();case 3:r=null!==(t=null===n||void 0===n?void 0:n.policies.list((function(e){return"storage"===e.schema}),{allSchemas:!0}))&&void 0!==t?t:[],x(r);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";j({}),k({bucket:e,table:t})},z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";k({bucket:t,table:n}),j(e)},L=function(){k({})},F=function(e){return g(e)},R=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setNotification({category:"success",message:"Successfully saved policy!"}),e.next=3,T();case 3:L();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=(0,i.Z)(a().mark((function e(r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(r.map(function(){var e=(0,i.Z)(a().mark((function e(r){var s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.policies.create(r);case 2:if(!(s=e.sent).error){e.next=6;break}return t.setNotification({category:"error",message:"Error adding policy: ".concat(s.error.message)}),e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=(0,i.Z)(a().mark((function e(r){var s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.policies.create(r);case 2:if(!(s=e.sent).error){e.next=6;break}return t.setNotification({category:"error",message:"Error adding policy: ".concat(s.error.message)}),e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=(0,i.Z)(a().mark((function e(r){var s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.policies.update(r.id,r);case 2:if(!(s=e.sent).error){e.next=6;break}return t.setNotification({category:"error",message:"Error updating policy: ".concat(s.error.message)}),e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=(0,i.Z)(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.policies.del(b.id);case 2:return(r=e.sent).error?t.setNotification({category:"error",message:"Failed to delete policy: ".concat(r.error.message)}):t.setNotification({category:"success",message:"Successfully deleted policy!"}),g({}),e.next=7,T();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,y.jsxs)("div",{className:"flex min-h-full w-full flex-col",children:[(0,y.jsx)("h3",{className:"text-xl",children:"Storage policies"}),(0,y.jsx)("p",{className:"mt-2 text-sm text-scale-1100",children:"Safeguard your files with policies that define the operations allowed for your users at the bucket level."}),s?(0,y.jsxs)("div",{className:"mt-4 space-y-4",children:[0===c.length&&(0,y.jsx)(Qe,{}),c.map((function(e){var t=(0,d.get)((0,d.find)(E,{name:e.name}),["policies"],[]);return(0,y.jsx)(et,{table:"objects",label:e.name,bucket:e,policies:t,onSelectPolicyAdd:I,onSelectPolicyEdit:z,onSelectPolicyDelete:F},e.name)})),(0,y.jsx)("div",{className:"!mb-4 w-full border-b border-gray-600"}),(0,y.jsx)("p",{className:"text-sm text-scale-1000",children:"You may also write policies for the tables under the storage schema directly for greater control"}),(0,y.jsx)(et,{table:"objects",label:"Other policies under storage.objects",policies:D,onSelectPolicyAdd:I,onSelectPolicyEdit:z,onSelectPolicyDelete:F}),(0,y.jsx)(et,{table:"buckets",label:"Policies under storage.buckets",policies:Z,onSelectPolicyAdd:I,onSelectPolicyEdit:z,onSelectPolicyDelete:F})]}):(0,y.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,y.jsx)(V.Z,{className:"animate-spin",size:16})}),(0,y.jsx)(ht,{visible:O,bucketName:N.bucket,roles:l,onSelectCancel:L,onCreatePolicies:A,onSaveSuccess:R}),(0,y.jsx)(rt.yV,{visible:S,schema:"storage",roles:l,table:N.table,target:N.bucket,selectedPolicyToEdit:h,onSelectCancel:L,onCreatePolicy:_,onUpdatePolicy:U,onSaveSuccess:R}),(0,y.jsx)(jt.Z,{danger:!0,visible:!(0,d.isEmpty)(b),title:"Confirm to delete policy",description:'This is permanent! Are you sure you want to delete the policy "'.concat(b.name,'"'),buttonLabel:"Delete",buttonLoadingLabel:"Deleting",onSelectCancel:function(){return g({})},onSelectConfirm:W})]})})),bt=n(58728),yt=n(43881),gt=n(33582),wt=n(85945),Nt=n(48228),kt=n(14919),Ot=n(49175),St=["onSuccess"];function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Et(e){return Dt.apply(this,arguments)}function Dt(){return(Dt=(0,i.Z)(a().mark((function e(t){var n,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectRef,r=t.fileSizeLimit,e.next=3,(0,kt.r$)("".concat(de.T5,"/projects/").concat(n,"/config/storage"),{fileSizeLimit:r});case 3:if(!(s=e.sent).error){e.next=6;break}throw s.error;case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Zt=n(69497),Tt=n(77249),It=n(20183),zt=function(e){var t=e.config,n=e.projectRef,r=t.fileSizeLimit,s=t.isFreeTier,c=(0,Tt.K)(r),l=c.value,d=c.unit,u=(0,C.oR)().ui,p=(0,o.useState)(d),m=p[0],f=p[1],h={fileSizeLimit:l,unformattedFileSizeLimit:r},j=(0,C.FH)(x.KA.STORAGE_ADMIN_WRITE,"*"),v="".concat(new Intl.NumberFormat("en-US").format(It.H)," bytes"),b=(0,Tt.K)(It.H,m).value,g=function(e){var t={};return e.fileSizeLimit>b&&(t.fileSizeLimit="Maximum limit is up to ".concat(b.toLocaleString()," ").concat(m,".")),t},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onSuccess,n=(0,tt.Z)(e,St),r=(0,wt.NL)();return(0,Nt.D)((function(e){return Et(e)}),Pt({onSuccess:function(e,n,s){return(0,i.Z)(a().mark((function i(){var c;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return c=n.projectRef,i.next=3,r.invalidateQueries(Ot.U.storage(c));case 3:return i.next=5,null===t||void 0===t?void 0:t(e,n,s);case 5:case"end":return i.stop()}}),i)})))()}},n))}(),N=w.mutateAsync,k=function(){var e=(0,i.Z)(a().mark((function e(t){var r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g(t).fileSizeLimit){e.next=5;break}u.setNotification({category:"error",message:"Upload file size limit must be up to 5GB (".concat(v,")")}),e.next=17;break;case 5:return e.prev=5,e.next=8,N({projectRef:n,fileSizeLimit:(0,Tt.F)(t.fileSizeLimit,m)});case 8:r=e.sent,s=(0,Tt.K)(r.fileSizeLimit),h={fileSizeLimit:s.value,unformattedFileSizeLimit:r.fileSizeLimit},u.setNotification({category:"success",message:"Successfully updated settings"}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),u.setNotification({category:"error",message:"Failed to update storage settings: ".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message)});case 17:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t){return e.apply(this,arguments)}}();return(0,y.jsx)("div",{className:"mx-auto w-[56rem] max-w-4xl px-5 pt-12 pb-20",children:(0,y.jsx)(We.Z,{validateOnBlur:!0,initialValues:h,validate:g,onSubmit:k,children:function(e){var t=e.values,r=e.isSubmitting,i=e.handleReset,c=h.unformattedFileSizeLimit!==(0,Tt.F)(t.fileSizeLimit,m);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"mb-6",children:[(0,y.jsx)("h3",{className:"mb-2 text-xl text-scale-1200",children:"Storage settings"}),(0,y.jsx)("div",{className:"text-sm text-scale-900",children:"Configure your project's storage settings"})]}),(0,y.jsx)("div",{className:"space-y-20",children:(0,y.jsxs)("div",{className:["bg-scale-100 dark:bg-scale-300","overflow-hidden border-scale-400","rounded-md border shadow"].join(" "),children:[(0,y.jsx)("div",{className:"flex flex-col gap-0 divide-y divide-scale-400",children:(0,y.jsxs)("div",{className:"grid grid-cols-12 gap-6 px-8 py-8 lg:gap-12",children:[(0,y.jsx)("div",{className:"relative flex flex-col col-span-12 gap-6 lg:col-span-4",children:(0,y.jsx)("p",{className:"text-sm",children:"Upload file size limit"})}),(0,y.jsxs)("div",{className:"relative flex flex-col col-span-12 gap-x-6 gap-y-2 lg:col-span-8",children:[(0,y.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-2",children:[(0,y.jsx)("div",{className:"col-span-8",children:(0,y.jsx)(ke.Z,{id:"fileSizeLimit",name:"fileSizeLimit",type:"number",disabled:s||!j,step:1,onKeyPress:function(e){(e.charCode<48||e.charCode>57)&&e.preventDefault()}})}),(0,y.jsx)("div",{className:"col-span-4",children:(0,y.jsx)(bt.Z,{disabled:s,value:m,onChange:f,children:Object.values(It.b).map((function(e){return(0,y.jsx)(bt.Z.Option,{disabled:s,label:e,value:e,children:(0,y.jsx)("div",{children:e})},e)}))})})]}),(0,y.jsxs)("p",{className:"text-sm text-scale-1100",children:[m!==It.b.BYTES&&"Equivalent to ".concat((0,Tt.F)(t.fileSizeLimit,m).toLocaleString()," bytes. "),"Maximum size in bytes of a file that can be uploaded is 5 GB (",v,")."]})]})]})}),s&&(0,y.jsx)("div",{className:"px-6 pb-6",children:(0,y.jsx)(Zt.Z,{icon:(0,y.jsx)(yt.Z,{size:"large"}),primaryText:"Free Plan has a fixed upload file size limit of 50 MB.",projectRef:n,secondaryText:"Upgrade to the Pro plan for a configurable upload file size limit of up to 5 GB."})}),(0,y.jsx)("div",{className:"border-t border-scale-400"}),(0,y.jsx)("div",{className:"flex justify-between px-8 py-4",children:(0,y.jsxs)("div",{className:"flex items-center justify-between w-full gap-2",children:[j?(0,y.jsx)("div",{}):(0,y.jsx)("p",{className:"text-sm text-scale-1000",children:"You need additional permissions to update storage settings"}),(0,y.jsxs)("div",{className:"flex gap-2",children:[(0,y.jsx)(ge.z,{type:"default",htmlType:"reset",onClick:function(){return i()},disabled:!c&&void 0!==c,children:"Cancel"}),(0,y.jsx)(ge.z,{type:"primary",htmlType:"submit",loading:r,disabled:!j||!c&&void 0!==c,children:"Save"})]})]})})]})})]})}})})},Lt=function(e){var t=e.projectRef,n=(0,gt.kl)({projectRef:t},{enabled:de.Qy}),r=n.data;return n.error||null!==r&&void 0!==r&&r.error?(0,y.jsx)("div",{className:"p-6 mx-auto text-center sm:w-full md:w-3/4",children:(0,y.jsx)("p",{className:"text-sm",children:"Error loading storage settings"})}):r?(0,y.jsx)(zt,{config:r,projectRef:t}):(0,y.jsx)("div",{className:"p-6 mx-auto text-center sm:w-full md:w-3/4",children:(0,y.jsx)("p",{className:"text-sm",children:"Loading..."})})};n(49226)},69497:function(e,t,n){var r=n(47314),s=n(43659),i=n(79894),c=n.n(i),a=n(98213),o=n(27102),l=n(36802),d=n(20796),u=n(68043),p=n(24246);t.Z=(0,s.Pi)((function(e){var t,n=e.icon,s=e.primaryText,i=(e.projectRef,e.secondaryText),m=(0,o.oR)().ui,x=(0,l.UO)().ref,f=null===(t=m.selectedProject)||void 0===t?void 0:t.subscription_tier,h=(0,o.FH)(u.KA.BILLING_WRITE,"stripe.subscriptions"),j=(0,o.P5)("disableProjectCreationAndUpdate"),v=f===d.ev.ENTERPRISE;return(0,p.jsx)("div",{className:["block w-full rounded border border-opacity-20 py-4 px-6","border-gray-600 bg-gray-100","dark:border-gray-300 dark:bg-gray-400"].join(" "),children:(0,p.jsxs)("div",{className:"flex space-x-3",children:[n&&(0,p.jsx)("div",{className:"mt-1",children:n}),(0,p.jsxs)("div",{className:"flex w-full items-center justify-between space-x-32",children:[(0,p.jsxs)("div",{className:"space-y-1",children:[(0,p.jsx)("p",{className:"text-sm",children:s}),(0,p.jsx)("div",{children:(0,p.jsx)("p",{className:"text-sm text-scale-1100",children:i})})]}),(0,p.jsxs)(a.fC,{delayDuration:0,children:[(0,p.jsx)(a.xz,{children:(0,p.jsx)(r.z,{type:"primary",disabled:!h||j,children:(0,p.jsx)(c(),{href:"/project/".concat(x,v?"/settings/billing/update/enterprise":"/settings/billing/update"),children:(0,p.jsx)("a",{children:f===d.ev.FREE?"Upgrade to Pro":"Modify subscription"})})})}),!h||j?(0,p.jsx)(a.h_,{children:(0,p.jsxs)(a.VY,{side:"bottom",children:[(0,p.jsx)(a.Eh,{className:"radix-tooltip-arrow"}),(0,p.jsx)("div",{className:["border border-scale-200 text-center","rounded bg-scale-100 py-1 px-2 leading-none shadow"].join(" "),children:(0,p.jsx)("span",{className:"text-xs text-scale-1200",children:j?(0,p.jsxs)(p.Fragment,{children:["Subscription changes are currently disabled.",(0,p.jsx)("br",{}),"Our engineers are working on a fix."]}):h?"":"You need additional permissions to amend subscriptions"})})]})}):(0,p.jsx)(p.Fragment,{})]})]})]})})}))},62929:function(e,t,n){var r=n(90849),s=(n(27378),n(63680)),i=n(12163),c=n(24246);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}t.Z=function(e){return(0,c.jsx)(i.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:s.Z},e))}}}]);
//# sourceMappingURL=8604-7d37e672db96b7c1.js.map