"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6666],{33944:function(e,t,n){var r=n(19248),a=n(24246);t.Z=function(){return(0,a.jsx)("div",{className:"block w-full rounded border border-gray-400 border-opacity-50 bg-gray-300 p-3",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)(r.Z,{size:20,strokeWidth:1.5}),(0,a.jsx)("p",{className:"text-sm",children:"No backups created yet - check again tomorrow."})]})})}},84427:function(e,t,n){var r=n(19248),a=n(79894),s=n.n(a),i=n(24246);t.Z=function(){return(0,i.jsx)("div",{className:"block w-full rounded border border-gray-400 border-opacity-50 bg-gray-300 p-3",children:(0,i.jsxs)("div",{className:"flex space-x-3",children:[(0,i.jsx)(r.Z,{size:20,strokeWidth:1.5}),(0,i.jsxs)("p",{className:"text-sm",children:["Failed to retrieve backups for this project. Please contact"," ",(0,i.jsx)(s(),{href:"/support/new",children:(0,i.jsx)("a",{className:"text-brand-900",children:"support"})}),"."]})]})})}},68740:function(e,t,n){n.d(t,{Z:function(){return Z}});var r=n(55732),a=n(34707),s=n.n(a),i=n(27378),c=n(43659),o=n(14971),l=n(17634),d=n(84364),u=n(68043),m=n(27102),p=n(44266),h=n(94269),f=n(77758),x=n(3648),v=n(58728),b=n(87474),j=n(34789),g=n(47314),y=n(51452),N=n(24246),w=function(e){var t=e.visible,n=e.extension,a=e.onCancel,c=(0,m.oR)(),o=c.ui,l=c.meta,d=(0,i.useState)(),u=d[0],p=d[1],w=(0,i.useState)(!1),Z=w[0],k=w[1],_=l.schemas.list();(0,i.useEffect)((function(){var e=!1;if(t){var a=function(){var t=(0,r.Z)(s().mark((function t(){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e||(k(!0),p(void 0)),t.next=3,l.query("select * from pg_available_extension_versions where name = '".concat(n.name,"'"));case 3:(r=t.sent).error||e||p(r[0].schema),k(!1);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();a()}return function(){e=!0}}),[t]);var S=function(){var e=(0,r.Z)(s().mark((function e(t,r){var i,c,d,m,p,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=r.setSubmitting)(!0),(c=void 0!==u&&null!==u?u:"custom"===t.schema?t.name:t.schema).startsWith("pg_")){e.next=10;break}return e.next=6,l.query("create schema if not exists ".concat(c));case 6:if(d=e.sent,!(m=d.error)){e.next=10;break}return e.abrupt("return",o.setNotification({error:m,category:"error",message:"Failed to create schema: ".concat(m.message)}));case 10:return e.next=12,l.extensions.create({schema:c,name:n.name,version:n.default_version,cascade:!0});case 12:p=e.sent,(h=p.error)?o.setNotification({error:h,category:"error",message:"Failed to toggle ".concat(n.name.toUpperCase(),": ").concat(h.message)}):o.setNotification({category:"success",message:"".concat(n.name.toUpperCase()," is on.")}),i(!1),a();case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return(0,N.jsx)(h.C,{closable:!0,hideFooter:!0,visible:t,onCancel:a,size:"small",header:(0,N.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,N.jsx)("h5",{className:"text-sm text-scale-1200",children:"Confirm to enable"}),(0,N.jsx)("code",{className:"text-xs",children:n.name})]}),children:(0,N.jsx)(f.Z,{initialValues:{name:n.name,schema:"extensions"},validate:function(e){var t={};return"custom"!==e.schema||e.name||(t.name="Required field"),t},onSubmit:S,children:function(e){var t=e.isSubmitting,r=e.values;return(0,N.jsxs)("div",{className:"space-y-4 py-4",children:[(0,N.jsx)(h.C.Content,{children:Z?(0,N.jsxs)("div",{className:"space-y-2",children:[(0,N.jsx)(y.Z,{}),(0,N.jsx)("div",{className:"w-3/4",children:(0,N.jsx)(y.Z,{})})]}):u?(0,N.jsx)(x.Z,{disabled:!0,id:"schema",name:"schema",value:u,label:"Select a schema to enable the extension for",descriptionText:"Extension must be installed in ".concat(u,".")}):(0,N.jsxs)(v.Z,{size:"small",name:"schema",label:"Select a schema to enable the extension for",children:[(0,N.jsxs)(v.Z.Option,{id:"custom",label:'Create a new schema "'.concat(n.name,'"'),value:"custom",addOnBefore:function(){return(0,N.jsx)(b.Z,{size:16,strokeWidth:1.5})},children:['Create a new schema "',n.name,'"']},"custom"),(0,N.jsx)(h.C.Separator,{}),_.map((function(e){return(0,N.jsx)(v.Z.Option,{id:e.name,label:e.name,value:e.name,addOnBefore:function(){return(0,N.jsx)(j.Z,{size:16,strokeWidth:1.5})},children:e.name},e.id)}))]})}),"custom"===r.schema&&(0,N.jsx)(h.C.Content,{children:(0,N.jsx)(x.Z,{id:"name",name:"name",label:"Schema name"})}),(0,N.jsx)(h.C.Separator,{}),(0,N.jsx)(h.C.Content,{children:(0,N.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,N.jsx)(g.z,{type:"default",disabled:t,onClick:function(){return a()},children:"Cancel"}),(0,N.jsx)(g.z,{htmlType:"submit",disabled:t,loading:t,children:"Enable extension"})]})})]})}})})},Z=(0,c.Pi)((function(e){var t=e.extension,n=(0,m.oR)(),a=n.ui,c=n.meta,h=null!==t.installed_version,f=(0,i.useState)(!1),x=f[0],v=f[1],b=(0,i.useState)(!1),j=b[0],g=b[1],y=(0,m.FH)(u.KA.TENANT_SQL_ADMIN_WRITE,"extensions");function Z(){return(Z=(0,r.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g(!0));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return k=(0,r.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,p._)({title:"Confirm to disable extension",message:'Are you sure you want to turn OFF "'.concat(t.name,'" extension?'),onAsyncConfirm:function(){var e=(0,r.Z)(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v(!0),e.next=4,c.extensions.del(t.name);case 4:if(!(n=e.sent).error){e.next=9;break}throw n.error;case 9:a.setNotification({category:"success",message:"".concat(t.name.toUpperCase()," is off.")});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),a.setNotification({category:"error",message:"Toggle ".concat(t.name.toUpperCase()," failed: ").concat(e.t0.message)});case 15:return e.prev=15,c.extensions.load(),v(!1),e.finish(15);case 19:case"end":return e.stop()}}),e,null,[[0,12,15,19]])})));return function(){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:["flex border-panel-border-light dark:border-panel-border-dark","flex-col overflow-hidden rounded border shadow-sm"].join(" "),children:[(0,N.jsxs)("div",{className:["border-panel-border-light bg-panel-header-light dark:bg-panel-header-dark","flex border-b p-4 px-6 dark:border-panel-border-dark"].join(" "),children:[(0,N.jsx)("h3",{title:t.name,className:"m-0 h-5 flex-1 truncate text-base uppercase text-scale-1200",children:t.name}),x?(0,N.jsx)(o.Z,{className:"animate-spin",size:16}):(0,N.jsx)(l.Z,{size:"tiny",checked:h,disabled:!y,onChange:function(){return h?function(){return k.apply(this,arguments)}():function(){return Z.apply(this,arguments)}()}})]}),(0,N.jsxs)("div",{className:["bg-panel-header-light dark:bg-panel-header-dark","bg-panel-secondary-light dark:bg-panel-secondary-dark flex h-full flex-col justify-between"].join(" "),children:[(0,N.jsx)("div",{className:"p-4 px-6",children:(0,N.jsx)("p",{className:"text-sm text-scale-1100 capitalize-sentence",children:t.comment})}),h&&t.schema&&(0,N.jsx)("div",{className:"p-4 px-6",children:(0,N.jsxs)("div",{className:"flex flex-grow items-center space-x-2 text-sm text-scale-1100",children:[(0,N.jsx)("span",{children:"Schema:"}),(0,N.jsx)(d.Z,{children:"".concat(t.schema)})]})})]})]}),(0,N.jsx)(w,{visible:j,extension:t,onCancel:function(){return g(!1)}})]})}))},6666:function(e,t,n){n.d(t,{M4:function(){return qt},TH:function(){return _},B8:function(){return Ln},RA:function(){return jn},ZY:function(){return vt},ZR:function(){return $n},eX:function(){return Pn},_h:function(){return Ot},IP:function(){return de},Vj:function(){return Ct},_y:function(){return Et},yT:function(){return te},bw:function(){return Z},Hm:function(){return Re}});var r=n(11246),a=n(27378),s=n(43659),i=n(58728),c=n(86223),o=n(3648),l=n(1296),d=n(47314),u=n(87474),m=n(66804),p=n(62929),h=n(56744),f=n(44315),x=n(98784),v=n(98213),b=n(68043),j=n(27102),g=n(55671),y=n(30259),N=n(51452),w=n(24246),Z=(0,s.Pi)((function(e){var t=e.selectedSchema,n=e.onSelectSchema,s=void 0===n?function(){}:n,Z=e.onAddTable,k=void 0===Z?function(){}:Z,_=e.onEditTable,S=void 0===_?function(){}:_,O=e.onDeleteTable,C=void 0===O?function(){}:O,P=e.onOpenTable,E=void 0===P?function(){}:P,F=(0,j.oR)().meta,z=F.tables.isLoading,D=(0,a.useState)(""),T=D[0],R=D[1],I=(0,j.FH)(b.KA.TENANT_SQL_ADMIN_WRITE,"tables"),A=F.schemas.list(),V=(0,x.partition)(A,(function(e){var t;return F.excludedSchemas.includes(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"")})),L=(0,r.Z)(V,2),W=L[0],q=L[1],M=F.tables.list((function(e){return e.schema===t})),Y=0===T.length?M:M.filter((function(e){return e.name.includes(T)})),U=F.publications.list().find((function(e){return"supabase_realtime"===e.name})),B=A.find((function(e){return e.name===t})),H=W.some((function(e){return e.id===(null===B||void 0===B?void 0:B.id)}));return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,w.jsx)("div",{className:"w-[230px]",children:(0,w.jsxs)(i.Z,{size:"small",value:t,onChange:s,icon:H&&(0,w.jsx)(c.Z,{size:14,strokeWidth:2}),children:[(0,w.jsx)(i.Z.Option,{disabled:!0,value:"normal-schemas",label:"Schemas",children:(0,w.jsx)("p",{className:"text-sm",children:"Schemas"})},"normal-schemas"),q.map((function(e){return(0,w.jsx)(i.Z.Option,{value:e.name,label:e.name,addOnBefore:function(){return(0,w.jsx)("span",{className:"text-scale-900",children:"schema"})},children:(0,w.jsx)("span",{className:"text-scale-1200 text-sm",children:e.name})},e.id)})),(0,w.jsx)(i.Z.Option,{disabled:!0,value:"protected-schemas",label:"Protected schemas",children:(0,w.jsx)("p",{className:"text-sm",children:"Protected schemas"})},"protected-schemas"),W.map((function(e){return(0,w.jsx)(i.Z.Option,{value:e.name,label:e.name,addOnBefore:function(){return(0,w.jsx)("span",{className:"text-scale-900",children:"schema"})},children:(0,w.jsx)("span",{className:"text-scale-1200 text-sm",children:e.name})},e.id)}))]})}),(0,w.jsx)("div",{children:(0,w.jsx)(o.Z,{size:"small",placeholder:"Filter tables",value:T,onChange:function(e){return R(e.target.value)},icon:(0,w.jsx)(l.Z,{size:"tiny"})})})]}),!H&&(0,w.jsx)("div",{children:(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{children:(0,w.jsx)(d.z,{disabled:!I,icon:(0,w.jsx)(u.Z,{}),onClick:function(){return k()},children:"New table"})}),!I&&(0,w.jsx)(v.h_,{children:(0,w.jsxs)(v.VY,{side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,w.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to create tables"})})]})})]})})]}),z?(0,w.jsxs)("div",{className:"py-4 space-y-2",children:[(0,w.jsx)(N.Z,{}),(0,w.jsx)(N.Z,{className:"w-3/4"}),(0,w.jsx)(N.Z,{className:"w-1/2"})]}):0===Y.length?(0,w.jsx)(y.Z,{}):(0,w.jsx)("div",{className:"my-4 w-full",children:(0,w.jsx)(g.Z,{head:[(0,w.jsx)(g.Z.th,{children:"Name"},"name"),(0,w.jsx)(g.Z.th,{className:"hidden lg:table-cell",children:"Description"},"description"),(0,w.jsx)(g.Z.th,{className:"hidden xl:table-cell",children:"Rows (Estimated)"},"rows"),(0,w.jsx)(g.Z.th,{className:"hidden xl:table-cell",children:"Size (Estimated)"},"size"),(0,w.jsx)(g.Z.th,{className:"hidden xl:table-cell text-center",children:"Realtime Enabled"},"realtime"),(0,w.jsx)(g.Z.th,{},"buttons")],body:Y.map((function(e,t){var n,r;return(0,w.jsxs)(g.Z.tr,{children:[(0,w.jsx)(g.Z.td,{children:(0,w.jsx)("p",{title:e.name,children:e.name})}),(0,w.jsx)(g.Z.td,{className:"hidden max-w-sm truncate lg:table-cell break-all whitespace-normal",children:null!==e.comment?(0,w.jsx)("p",{title:e.comment,children:e.comment}):(0,w.jsx)("p",{className:"text-scale-800",children:"No description"})}),(0,w.jsx)(g.Z.td,{className:"hidden xl:table-cell",children:(0,w.jsx)("code",{className:"text-sm",children:null!==(n=e.live_rows_estimate)&&void 0!==n?n:e.live_row_count})}),(0,w.jsx)(g.Z.td,{className:"hidden xl:table-cell",children:(0,w.jsx)("code",{className:"text-sm",children:e.size})}),(0,w.jsx)(g.Z.td,{className:"hidden xl:table-cell text-center",children:(null!==(r=null===U||void 0===U?void 0:U.tables)&&void 0!==r?r:[]).find((function(t){return t.id===e.id}))&&(0,w.jsx)("div",{className:"flex justify-center",children:(0,w.jsx)(m.Z,{strokeWidth:2})})}),(0,w.jsx)(g.Z.td,{children:(0,w.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,w.jsxs)(d.z,{type:"default",iconRight:(0,w.jsx)(p.Z,{}),className:"whitespace-nowrap hover:border-gray-500",style:{paddingTop:3,paddingBottom:3},onClick:function(){return E(e)},children:[e.columns.length," columns"]}),(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{children:(0,w.jsx)(d.z,{type:"text",icon:(0,w.jsx)(h.Z,{}),style:{padding:5},disabled:!I||H,onClick:function(){return S(e)}})}),!I&&(0,w.jsx)(v.h_,{children:(0,w.jsxs)(v.VY,{side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,w.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to edit tables"})})]})})]}),(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{children:(0,w.jsx)(d.z,{type:"text",icon:(0,w.jsx)(f.Z,{}),style:{padding:5},disabled:!I||H,onClick:function(){return C(e)}})}),!I&&(0,w.jsx)(v.h_,{children:(0,w.jsxs)(v.VY,{side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,w.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to delete tables"})})]})})]})]})})]},e.id)}))})})]})})),k=n(86673),_=(0,s.Pi)((function(e){var t,n,r,s=e.selectedTable,i=e.onSelectBack,c=void 0===i?function(){}:i,m=e.onAddColumn,p=void 0===m?function(){}:m,x=e.onEditColumn,N=void 0===x?function(){}:x,Z=e.onDeleteColumn,_=void 0===Z?function(){}:Z,S=(0,j.oR)().meta,O=(0,a.useState)(""),C=O[0],P=O[1],E=null!==(t=0===C.length?s.columns:null===(n=s.columns)||void 0===n?void 0:n.filter((function(e){return e.name.includes(C)})))&&void 0!==t?t:[],F=S.excludedSchemas.includes(null!==(r=s.schema)&&void 0!==r?r:""),z=(0,j.FH)(b.KA.TENANT_SQL_ADMIN_WRITE,"columns");return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"mb-4",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center",children:[(0,w.jsxs)("div",{className:"flex items-center mr-4",children:[(0,w.jsx)(d.z,{type:"outline",className:"mr-4",onClick:function(){return c()},icon:(0,w.jsx)(k.Z,{size:"small"}),style:{padding:"5px"}}),(0,w.jsx)("code",{children:s.name})]}),(0,w.jsx)("div",{children:(0,w.jsx)(o.Z,{size:"small",placeholder:"Filter columns",value:C,onChange:function(e){return P(e.target.value)},icon:(0,w.jsx)(l.Z,{size:"tiny"})})})]}),!F&&(0,w.jsx)("div",{children:(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{children:(0,w.jsx)(d.z,{disabled:!z,icon:(0,w.jsx)(u.Z,{}),onClick:function(){return p()},children:"New column"})}),!z&&(0,w.jsx)(v.h_,{children:(0,w.jsxs)(v.VY,{side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,w.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to create columns"})})]})})]})})]})}),0===E.length?(0,w.jsx)(y.Z,{}):(0,w.jsx)("div",{children:(0,w.jsx)(g.Z,{head:[(0,w.jsx)(g.Z.th,{children:"Name"},"name"),(0,w.jsx)(g.Z.th,{className:"hidden lg:table-cell",children:"Description"},"description"),(0,w.jsx)(g.Z.th,{className:"hidden xl:table-cell",children:"Data Type"},"type"),(0,w.jsx)(g.Z.th,{className:"hidden xl:table-cell",children:"Format"},"format"),(0,w.jsx)(g.Z.th,{},"buttons")],body:E.map((function(e,t){return(0,w.jsxs)(g.Z.tr,{className:"border-t",children:[(0,w.jsx)(g.Z.td,{children:(0,w.jsx)("p",{children:e.name})}),(0,w.jsx)(g.Z.td,{className:"break-all whitespace-normal",children:null!==e.comment?(0,w.jsx)("p",{title:e.comment,children:e.comment}):(0,w.jsx)("p",{className:"text-scale-800",children:"No description"})}),(0,w.jsx)(g.Z.td,{children:(0,w.jsx)("code",{className:"text-xs",children:e.data_type})}),(0,w.jsx)(g.Z.td,{className:"font-mono text-xs",children:(0,w.jsx)("code",{className:"text-xs",children:e.format})}),(0,w.jsx)(g.Z.td,{className:"px-4 py-3 pr-2",children:(0,w.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{children:(0,w.jsx)(d.z,{onClick:function(){return N(e)},icon:(0,w.jsx)(h.Z,{}),style:{padding:5},type:"text",disabled:!z||F})}),!z&&(0,w.jsx)(v.h_,{children:(0,w.jsxs)(v.VY,{side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,w.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to edit columns"})})]})})]}),(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{children:(0,w.jsx)(d.z,{onClick:function(){return _(e)},icon:(0,w.jsx)(f.Z,{}),style:{padding:5},type:"text",disabled:!z||F})}),!z&&(0,w.jsx)(v.h_,{children:(0,w.jsxs)(v.VY,{side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,w.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to delete columns"})})]})})]})]})})]},e.name)}))})})]})})),S=n(55732),O=n(79305),C=n(34707),P=n.n(C),E=n(70946),F=n(84364),z=n(39466),D=n(33003),T=n(90849),R=n(90089),I=n(77758),A=n(11872),V=n(81343),L=n(2674),W=n(43555),q=n(17634),M=n(29432),Y=["anon","service_role","authenticated","authenticator","dashboard_user","supabase_admin","supabase_auth_admin","supabase_replication_admin","supabase_storage_admin","supabase_functions_admin","pgbouncer","pgsodium_keyholder","pgsodium_keyiduser","pgsodium_keymaker"],U={can_login:{disabled:!1,description:"User can login"},can_create_role:{disabled:!1,description:"User can create roles"},can_create_db:{disabled:!1,description:"User can create databases"},can_bypass_rls:{disabled:!0,description:"User bypasses every row level security policy"},is_superuser:{disabled:!0,description:"User is a Superuser"},is_replication_role:{disabled:!0,description:"User can initiate streaming replication and put the system in and out of backup mode"}},B=["is_superuser","is_replication_role"];function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,T.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q=function(e){var t=e.role,n=e.disabled,r=void 0!==n&&n,s=e.onSelectDelete,i=(0,j.oR)(),c=i.ui,o=i.meta,l=(0,a.useState)(!1),u=l[0],m=l[1],p=t.is_superuser,h=t.can_login,x=t.can_create_role,b=t.can_create_db,g=t.is_replication_role,y=t.can_bypass_rls,N=function(){var e=(0,S.Z)(P().mark((function e(n,r){var a,s,i,l;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.setSubmitting,s=r.resetForm,a(!0),n.is_superuser,n.is_replication_role,i=(0,R.Z)(n,B),e.next=5,o.roles.update(t.id,i);case 5:l=e.sent,a(!1),l.error?c.setNotification({category:"error",message:'Failed to update role "'.concat(t.name,'": ').concat(l.error.message)}):(c.setNotification({category:"success",message:'Successfully updated role "'.concat(t.name,'"')}),s({values:K({},n),initialValues:K({},n)}));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return(0,w.jsx)(I.Z,{name:"role-update-form",initialValues:{is_superuser:p,can_login:h,can_create_role:x,can_create_db:b,is_replication_role:g,can_bypass_rls:y},onSubmit:N,className:["bg-scale-100 dark:bg-scale-300","hover:bg-scale-200 dark:hover:bg-scale-500","data-open:bg-scale-200 dark:data-open:bg-scale-500","border-scale-300 dark:border-scale-500 hover:border-scale-500","dark:hover:border-scale-700 data-open:border-scale-700","data-open:pb-px col-span-12 mx-auto","-space-y-px overflow-hidden","border border-t-0 first:border-t first:!mt-0 hover:border-t hover:-mt-[1px] shadow transition hover:z-50","first:rounded-tl first:rounded-tr","last:rounded-bl last:rounded-br"].join(" "),children:function(e){var n=e.values,a=e.initialValues,i=e.handleReset,c=e.isSubmitting,o=JSON.stringify(n)!==JSON.stringify(a);return(0,w.jsxs)(A.ZP,{open:u,children:[(0,w.jsx)(A.ZP.Trigger,{asChild:!0,children:(0,w.jsxs)("button",{id:"collapsible-trigger",type:"button",className:"group flex w-full items-center justify-between rounded py-3 px-6 text-scale-1200",onClick:function(e){"collapsible-trigger"===e.target.id&&m(!u)},children:[(0,w.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,w.jsx)(V.Z,{id:"collapsible-trigger",className:"text-scale-800 transition data-open-parent:rotate-0 data-closed-parent:rotate-180",strokeWidth:2,width:14}),(0,w.jsxs)("div",{className:"space-x-2 flex items-center",children:[(0,w.jsx)("p",{className:"text-left text-sm",id:"collapsible-trigger",children:t.name}),(0,w.jsxs)("p",{className:"text-left text-sm text-scale-1000",id:"collapsible-trigger",children:["(ID: ",t.id,")"]})]})]}),(0,w.jsxs)("div",{className:"flex items-center space-x-4",children:[t.active_connections>0&&(0,w.jsx)("div",{className:"relative h-2 w-2",children:(0,w.jsxs)("span",{className:"flex h-2 w-2",children:[(0,w.jsx)("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-brand-900 opacity-75"}),(0,w.jsx)("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-brand-900 opacity-75"})]})}),(0,w.jsxs)("p",{id:"collapsible-trigger",className:"text-sm ".concat(t.active_connections>0?"text-scale-1100":"text-scale-1000"),children:[t.active_connections," connections"]}),!r&&(0,w.jsx)(L.ZP,{side:"bottom",className:"w-[120px]",overlay:(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(L.ZP.Item,{icon:(0,w.jsx)(f.Z,{className:"text-red-800",size:"tiny",strokeWidth:2}),onClick:function(e){e.stopPropagation(),s(t)},children:"Delete"})}),children:(0,w.jsx)(d.z,{as:"span",type:"default",className:"px-1",icon:(0,w.jsx)(W.Z,{})})})]})]})}),(0,w.jsx)(A.ZP.Content,{children:(0,w.jsxs)("div",{className:"group border-t border-scale-500 bg-scale-100 py-6 px-20 text-scale-1200 dark:bg-scale-300",children:[(0,w.jsx)("div",{className:"py-4 space-y-[9px]",children:Object.keys(U).map((function(e){return(0,w.jsx)(q.Z,{size:"small",id:e,name:e,label:U[e].description,disabled:r||U[e].disabled,className:["roles-toggle",r||U[e].disabled?"opacity-50":""].join(" "),afterLabel:!r&&U[e].disabled&&(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{type:"button",children:(0,w.jsx)(M.Z,{size:"tiny",strokeWidth:2,className:"ml-2 relative top-[3px]"})}),(0,w.jsx)(v.h_,{children:(0,w.jsxs)(v.VY,{align:"center",side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 space-y-1"].join(" "),children:(0,w.jsx)("span",{className:"text-xs",children:"This privilege cannot be updated via the dashboard"})})]})})]})},e)}))}),!r&&(0,w.jsxs)("div",{className:"py-4 flex items-center space-x-2 justify-end",children:[(0,w.jsx)(d.z,{type:"default",disabled:!o||c,onClick:function(){return i()},children:"Cancel"}),(0,w.jsx)(d.z,{type:"primary",htmlType:"submit",disabled:!o||c,loading:c,children:"Save"})]})]})})]})}})},G=n(70417),J=function(e){var t=e.visible,n=e.onClose,r=(0,a.useRef)(),s=(0,j.oR)(),i=s.ui,c=s.meta,l=(0,a.useState)(!1),u=l[0],m=l[1],p=function(){var e=(0,S.Z)(P().mark((function e(t){var r;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,c.roles.create(t);case 3:if(r=e.sent,m(!1),!r.error){e.next=9;break}return e.abrupt("return",i.setNotification({category:"error",message:"Failed to create role: ".concat(r.error.message)}));case 9:i.setNotification({category:"success",message:"Successfully created new role: ".concat(r.name)}),n();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,w.jsx)(G.ZP,{size:"large",visible:t,header:"Create a new role",className:"mr-0 transform transition-all duration-300 ease-in-out",loading:!1,onCancel:n,customFooter:(0,w.jsxs)("div",{className:"flex w-full justify-end space-x-3 border-t border-scale-500 px-3 py-4",children:[(0,w.jsx)(d.z,{size:"tiny",type:"default",htmlType:"button",onClick:n,disabled:u,children:"Cancel"}),(0,w.jsx)(d.z,{size:"tiny",type:"primary",htmlType:"button",disabled:u,loading:u,onClick:function(){var e;return null===r||void 0===r||null===(e=r.current)||void 0===e?void 0:e.click()},children:"Create role"})]}),children:(0,w.jsx)(I.Z,{validateOnBlur:!0,id:"create-new-role",initialValues:{name:"",is_superuser:!1,can_login:!1,can_create_role:!1,can_create_db:!1,is_replication_role:!1,can_bypass_rls:!1},validate:function(e){var t={};return 0===e.name.length&&(t.name="Please provide a name for your role"),t},onSubmit:p,children:function(e){e.isSubmitting,e.handleReset,e.values,e.initialValues;return(0,w.jsxs)("div",{children:[(0,w.jsx)(D.hj,{header:(0,w.jsx)(D.S0,{className:"lg:!col-span-4",children:"Role Configuration"}),children:(0,w.jsx)(D.B4,{loading:!1,className:"lg:!col-span-8",children:(0,w.jsx)(o.Z,{id:"name",label:"Name"})})}),(0,w.jsx)(G.ZP.Separator,{}),(0,w.jsx)(D.hj,{header:(0,w.jsx)(D.S0,{className:"lg:!col-span-4",children:"Role Privileges"}),children:(0,w.jsx)(D.B4,{loading:!1,className:"lg:!col-span-8",children:(0,w.jsx)("div",{className:"space-y-[9px]",children:Object.keys(U).map((function(e){return(0,w.jsx)(q.Z,{size:"small",disabled:U[e].disabled,className:["roles-toggle",U[e].disabled?"opacity-50":""].join(" "),id:e,name:e,label:U[e].description,afterLabel:U[e].disabled&&(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{type:"button",children:(0,w.jsx)(M.Z,{size:"tiny",strokeWidth:2,className:"ml-2 relative top-[3px]"})}),(0,w.jsxs)(v.VY,{align:"center",side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 space-y-1"].join(" "),children:(0,w.jsx)("span",{className:"text-xs",children:"This privilege cannot be granted via the dashboard"})})]})]})},e)}))})})}),(0,w.jsx)("button",{ref:r,type:"submit",className:"hidden"})]})}})})},$=n(94269),X=function(e){var t=e.role,n=e.visible,r=e.onClose,s=(0,j.oR)(),i=s.ui,c=s.meta,o=(0,a.useState)(!1),l=o[0],d=o[1],u=function(){var e=(0,S.Z)(P().mark((function e(){var n;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",console.error("Failed to delete role: role is missing"));case 2:return d(!0),e.next=5,c.roles.del(t.id);case 5:if(n=e.sent,d(!1),!n.error){e.next=11;break}return e.abrupt("return",i.setNotification({category:"error",message:"Failed to delete role: ".concat(n.error.message)}));case 11:i.setNotification({category:"success",message:'Successfully deleted role: "'.concat(t.name,'"')}),r();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,w.jsx)($.C,{size:"small",alignFooter:"right",visible:n,onCancel:r,onConfirm:u,header:(0,w.jsxs)("h3",{children:['Confirm to delete role "',null===t||void 0===t?void 0:t.name,'"']}),loading:l,children:(0,w.jsx)("div",{className:"py-4",children:(0,w.jsx)($.C.Content,{children:(0,w.jsx)("p",{className:"text-sm",children:"This will automatically revoke any membership of this role in other roles, and this action cannot be undone."})})})})},ee=n(15916),te=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,j.oR)().meta,n=(0,a.useState)(0),s=n[0],i=n[1],c=(0,a.useState)(""),m=c[0],p=c[1],h=(0,a.useState)("all"),f=h[0],g=h[1],y=(0,a.useState)(!1),N=y[0],Z=y[1],k=(0,a.useState)(),_=k[0],C=k[1],T=(0,j.FH)(b.KA.TENANT_SQL_ADMIN_WRITE,"roles");(0,a.useEffect)((function(){var e=function(){var e=(0,S.Z)(P().mark((function e(){var n,r,a;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.query("show max_connections");case 2:(n=e.sent).error||i(Number(null!==(r=null===(a=n[0])||void 0===a?void 0:a.max_connections)&&void 0!==r?r:0));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var R=t.roles.list(),I=("active"===f?t.roles.list((function(e){return e.active_connections>0})):t.roles.list()).filter((function(e){return e.name.includes(m)})),A=(0,x.partition)(I,(function(e){return Y.includes(e.name)})),V=(0,r.Z)(A,2),L=V[0],W=V[1],q=R.map((function(e){return e.active_connections})).reduce((function(e,t){return e+t}),0),M=R.filter((function(e){return e.active_connections>0})).sort((function(e,t){return t.active_connections-e.active_connections}));return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{className:"flex items-center justify-between",children:(0,w.jsx)(D.ph,{title:"Database Roles",description:"Manage access control to your database through users, groups, and permissions"})}),(0,w.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,w.jsx)(o.Z,{size:"small",placeholder:"Search for a role",icon:(0,w.jsx)(l.Z,{size:"tiny"}),value:m,onChange:function(e){return p(e.target.value)},actions:m&&(0,w.jsx)(d.z,{size:"tiny",type:"text",onClick:function(){return p("")},className:"px-1 mr-1",children:(0,w.jsx)(E.Z,{size:12,strokeWidth:2})})}),(0,w.jsxs)("div",{className:"flex items-center border border-scale-700 rounded-full w-min h-[34px]",children:[(0,w.jsx)("button",{className:["text-xs w-[90px] h-full text-center rounded-l-full flex items-center justify-center transition","all"===f?"bg-scale-500 text-scale-1200":"hover:bg-scale-400 text-scale-1100"].join(" "),onClick:function(){return g("all")},children:"All roles"}),(0,w.jsx)("div",{className:"h-full w-[1px] border-r border-scale-700"}),(0,w.jsx)("button",{className:["text-xs w-[90px] h-full text-center rounded-r-full flex items-center justify-center transition","active"===f?"bg-scale-500 text-scale-1200":"hover:bg-scale-400 text-scale-1100"].join(" "),onClick:function(){return g("active")},children:"Active roles"})]})]}),(0,w.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{children:(0,w.jsx)("div",{className:"w-42",children:(0,w.jsx)(z.Z,{type:"horizontal",max:s,value:q,barClass:0===s?"bg-gray-100 dark:bg-gray-600":q>.9*s?"bg-red-800":q>.75*s?"bg-amber-900":"bg-green-800",labelTop:"".concat(q,"/").concat(s),labelBottom:"Active connections"})})}),(0,w.jsxs)(v.VY,{align:"start",side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsxs)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 space-y-1"].join(" "),children:[(0,w.jsx)("p",{className:"text-xs text-scale-1100 pr-2",children:"Connections by roles:"}),M.map((function(e){return(0,w.jsxs)("div",{className:"text-xs text-scale-1200",children:[e.name,": ",e.active_connections]},e.id)}))]})]})]}),(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{children:(0,w.jsx)(d.z,{type:"primary",disabled:!T,icon:(0,w.jsx)(u.Z,{size:"tiny"}),onClick:function(){return Z(!0)},children:"Add role"})}),!T&&(0,w.jsxs)(v.VY,{align:"start",side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 text-xs"].join(" "),children:"You need additional permissions to add a new role"})]})]})]})]}),(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsxs)("div",{children:[L.length>0&&(0,w.jsxs)("div",{className:"bg-scale-100 dark:bg-scale-200 border border-scale-300 dark:border-scale-500 px-6 py-3 rounded-t flex items-center space-x-4",children:[(0,w.jsx)("p",{className:"text-sm text-scale-1100",children:"Roles managed by Supabase"}),(0,w.jsx)(F.Z,{color:"green",children:"Protected"})]}),L.map((function(e,t){return(0,w.jsx)(Q,{disabled:!0,role:e,onSelectDelete:C},e.id)}))]}),(0,w.jsxs)("div",{children:[W.length>0&&(0,w.jsx)("div",{className:"bg-scale-100 dark:bg-scale-200 border border-scale-300 dark:border-scale-500 px-6 py-3 rounded-t",children:(0,w.jsx)("p",{className:"text-sm text-scale-1100",children:"Other database roles"})}),W.map((function(e,t){return(0,w.jsx)(Q,{disabled:!T,role:e,onSelectDelete:C},e.id)}))]})]}),m.length>0&&0===I.length&&(0,w.jsx)(ee.Z,{searchString:m,onResetFilter:function(){return p("")}})]}),(0,w.jsx)(J,{visible:N,onClose:function(){return Z(!1)}}),(0,w.jsx)(X,{role:_,visible:void 0!==_,onClose:function(){return C(void 0)}})]})})),ne=n(33769),re=n(49239),ae=n(36802),se=n(68740),ie=["adminpack","amcheck","file_fdw","lo","old_snapshot","pageinspect","pg_buffercache","pg_freespacemap","pg_prewarm","pg_surgery","pg_visibility","pgstattuple","supabase_vault","intagg","xml2","pg_tle"],ce=n(33114),oe=n(79894),le=n.n(oe),de=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,j.oR)().meta,n=(0,ae.UO)().filter,s=(0,a.useState)(""),i=s[0],c=s[1],u=0===i.length?t.extensions.list():t.extensions.list((function(e){return e.name.includes(i)})),m=u.filter((function(e){return!ie.includes(e.name)})),p=(0,x.partition)(m,(function(e){return!(0,x.isNull)(e.installed_version)})),h=(0,r.Z)(p,2),f=h[0],v=h[1],g=(0,j.FH)(b.KA.TENANT_SQL_ADMIN_WRITE,"extensions");return(0,a.useEffect)((function(){void 0!==n&&c(n)}),[n]),(0,w.jsxs)("div",{className:"p-4",children:[(0,w.jsx)("div",{className:"mb-4",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsx)(o.Z,{size:"small",placeholder:"Filter",value:i,onChange:function(e){return c(e.target.value)},icon:(0,w.jsx)(l.Z,{size:"tiny"})}),g?(0,w.jsx)(le(),{passHref:!0,href:"https://supabase.com/docs/guides/database/extensions",children:(0,w.jsx)("a",{target:"_blank",rel:"noreferrer",children:(0,w.jsx)(d.z,{type:"default",iconRight:(0,w.jsx)(re.Z,{}),children:"Learn more about extensions"})})}):(0,w.jsx)("div",{className:"w-[500px]",children:(0,w.jsx)(ce.Z,{icon:(0,w.jsx)(ne.Z,{className:"text-scale-1100",strokeWidth:2}),title:"You need additional permissions to update database extensions"})})]})}),0===u.length&&(0,w.jsx)(ee.Z,{searchString:i,onResetFilter:function(){return c("")}}),(0,w.jsxs)("div",{className:"my-8 w-full space-y-12",children:[f.length>0&&(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsx)("h4",{className:"text-lg",children:"Enabled extensions"}),(0,w.jsx)("div",{className:"mb-4 grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3",children:f.map((function(e){return(0,w.jsx)(se.Z,{extension:e},e.name)}))})]}),v.length>0&&(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsx)("h4",{className:"text-lg",children:"Available extensions"}),(0,w.jsx)("div",{className:"mb-4 grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3",children:v.map((function(e){return(0,w.jsx)(se.Z,{extension:e},e.name)}))})]})]})]})})),ue=n(65961),me=n(51991),pe=function(e){var t=e.projectRef,n=e.connectionString,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,me.cp)({projectRef:t,connectionString:n,sql:"\n    select\n      s.oid as \"id\",\n      w.fdwname as \"name\",\n      s.srvname as \"server_name\",\n      s.srvoptions as \"server_options\",\n      c.proname as \"handler\",\n      (\n        select jsonb_agg(\n          jsonb_build_object(\n            'id', c.oid::bigint,\n            'schema', relnamespace::regnamespace::text,\n            'name', c.relname,\n            'columns', (\n              select jsonb_agg(\n                jsonb_build_object(\n                  'name', a.attname,\n                  'type', pg_catalog.format_type(a.atttypid, a.atttypmod)\n                )\n              )\n              from pg_catalog.pg_attribute a\n              where a.attrelid = c.oid and a.attnum > 0 and not a.attisdropped\n            ),\n            'options', t.ftoptions\n          )\n        )\n        from pg_catalog.pg_class c\n        join pg_catalog.pg_foreign_table t on c.oid = t.ftrelid\n        where c.oid = any (select t.ftrelid from pg_catalog.pg_foreign_table t where t.ftserver = s.oid)\n      ) as \"tables\"\n    from pg_catalog.pg_foreign_server s\n    join pg_catalog.pg_foreign_data_wrapper w on s.srvfdw = w.oid\n    join pg_catalog.pg_proc c on w.fdwhandler = c.oid;\n  ",queryKey:["fdws"]},r)},he=n(20796),fe=[{name:"stripe_wrapper",handlerName:"stripe_fdw_handler",validatorName:"stripe_fdw_validator",icon:"".concat(he.GW,"/img/icons/stripe-icon.svg"),extensionName:"StripeFdw",label:"Stripe",docsUrl:"https://supabase.github.io/wrappers/stripe/",server:{options:[{name:"api_key_id",label:"Stripe Secret Key",required:!0,encrypted:!0,hidden:!0,urlHelper:"https://stripe.com/docs/keys"},{name:"api_url",label:"Stripe API URL",defaultValue:"https://api.stripe.com/v1",required:!1,encrypted:!1,hidden:!1}]},tables:[{label:"Balance",description:"The balance currently on your Stripe account",availableColumns:[{name:"balance_type",type:"text"},{name:"amount",type:"bigint"},{name:"currency",type:"text"},{name:"attrs",type:"jsonb"}],options:[{name:"object",defaultValue:"balance",editable:!1,required:!0,type:"text"}]},{label:"Balance Transactions",description:"Transactions that have contributed to the balance on your Stripe account",availableColumns:[{name:"id",type:"text"},{name:"amount",type:"bigint"},{name:"currency",type:"text"},{name:"description",type:"text"},{name:"fee",type:"bigint"},{name:"net",type:"bigint"},{name:"status",type:"text"},{name:"type",type:"text"},{name:"created",type:"timestamp"},{name:"attrs",type:"jsonb"}],options:[{name:"object",defaultValue:"balance_transactions",editable:!1,required:!0,type:"text"}]},{label:"Charges",description:"Charges made on your Stripe account",availableColumns:[{name:"id",type:"text"},{name:"amount",type:"bigint"},{name:"currency",type:"text"},{name:"customer",type:"text"},{name:"description",type:"text"},{name:"invoice",type:"text"},{name:"payment_intent",type:"text"},{name:"status",type:"text"},{name:"created",type:"timestamp"},{name:"attrs",type:"jsonb"}],options:[{name:"object",defaultValue:"charges",editable:!1,required:!0,type:"text"}]},{label:"Customers",description:"Customers on your Stripe account",availableColumns:[{name:"id",type:"text"},{name:"email",type:"text"},{name:"name",type:"text"},{name:"description",type:"text"},{name:"created",type:"timestamp"},{name:"attrs",type:"jsonb"}],options:[{name:"object",defaultValue:"customers",editable:!1,required:!0,type:"text"}]},{label:"Invoices",description:"Invoices on your Stripe account",availableColumns:[{name:"id",type:"text"},{name:"customer",type:"text"},{name:"subscription",type:"text"},{name:"status",type:"text"},{name:"total",type:"bigint"},{name:"currency",type:"text"},{name:"period_start",type:"timestamp"},{name:"period_end",type:"timestamp"},{name:"attrs",type:"jsonb"}],options:[{name:"object",defaultValue:"invoices",editable:!1,required:!0,type:"text"}]},{label:"Payment Intents",description:"Payment Intents on your Stripe account",availableColumns:[{name:"id",type:"text"},{name:"customer",type:"text"},{name:"amount",type:"bigint"},{name:"currency",type:"text"},{name:"payment_method",type:"text"},{name:"created",type:"timestamp"},{name:"attrs",type:"jsonb"}],options:[{name:"object",defaultValue:"payment_intents",editable:!1,required:!0,type:"text"}]},{label:"Products",description:"Products on your Stripe account",availableColumns:[{name:"id",type:"text"},{name:"name",type:"text"},{name:"active",type:"bool"},{name:"default_price",type:"text"},{name:"description",type:"text"},{name:"created",type:"timestamp"},{name:"updated",type:"timestamp"},{name:"attrs",type:"jsonb"}],options:[{name:"object",defaultValue:"products",editable:!1,required:!0,type:"text"}]},{label:"Subscriptions",description:"Subscriptions on your Stripe account",availableColumns:[{name:"id",type:"text"},{name:"customer",type:"text"},{name:"currency",type:"text"},{name:"current_period_start",type:"timestamp"},{name:"current_period_end",type:"timestamp"},{name:"attrs",type:"jsonb"}],options:[{name:"object",defaultValue:"subscriptions",editable:!1,required:!0,type:"text"}]}]},{name:"firebase_wrapper",handlerName:"firebase_fdw_handler",validatorName:"firebase_fdw_validator",icon:"".concat(he.GW,"/img/icons/firebase-icon.svg"),extensionName:"FirebaseFdw",label:"Firebase",docsUrl:"https://supabase.github.io/wrappers/firebase/",server:{options:[{name:"project_id",label:"Project ID",required:!0,encrypted:!1,hidden:!1},{name:"sa_key_id",label:"Service Account Key",required:!0,encrypted:!0,hidden:!0,isTextArea:!0,urlHelper:"https://firebase.google.com/docs/admin/setup#initialize-sdk"}]},tables:[{label:"Users",description:"Shows your Firebase users",availableColumns:[{name:"uid",type:"text"},{name:"email",type:"text"},{name:"created_at",type:"timestamp"},{name:"attrs",type:"jsonb"}],options:[{name:"object",defaultValue:"auth/users",editable:!1,required:!0,type:"text"},{name:"base_url",label:"Base URL",defaultValue:"https://identitytoolkit.googleapis.com/v1/projects",editable:!0,required:!0,type:"text"},{name:"limit",label:"Limit",defaultValue:"10000",editable:!0,required:!0,type:"text"}]},{label:"Firestore Collection",description:"Map to a Firestore collection",availableColumns:[{name:"name",type:"text"},{name:"created_at",type:"timestamp"},{name:"updated_at",type:"timestamp"},{name:"attrs",type:"jsonb"}],options:[{name:"object",label:"Object",placeholder:"firestore/[collection_id]",editable:!0,required:!0,type:"text"},{name:"base_url",label:"Base URL",defaultValue:"https://firestore.googleapis.com/v1beta1/projects",editable:!0,required:!0,type:"text"},{name:"limit",label:"Limit",defaultValue:"10000",editable:!0,required:!0,type:"text"}]}]},{name:"s3_wrapper",handlerName:"s3_fdw_handler",validatorName:"s3_fdw_validator",icon:"/img/icons/s3-icon.svg",extensionName:"S3Fdw",label:"S3",docsUrl:"https://supabase.github.io/wrappers/s3/",server:{options:[{name:"vault_access_key_id",label:"Access Key ID",required:!0,encrypted:!0,hidden:!0},{name:"vault_secret_access_key",label:"Access Key Secret",required:!0,encrypted:!0,hidden:!0},{name:"aws_region",label:"AWS Region",required:!0,encrypted:!1,hidden:!1,defaultValue:"us-east-1"}]},tables:[{label:"S3 File",description:"Map to a file in S3 (CSV or JSON only)",options:[{name:"uri",label:"URI",editable:!0,required:!0,placeholder:"s3://bucket/s3_table.csv",type:"text"},{name:"format",label:"Format",editable:!0,required:!0,type:"select",defaultValue:"csv",options:[{label:"CSV",value:"csv"},{label:"JSONL (JSON Lines)",value:"jsonl"}]},{name:"has_header",label:"Has Header",editable:!0,required:!0,type:"select",defaultValue:"true",options:[{label:"True",value:"true"},{label:"False",value:"false"}]},{name:"compress",label:"Compression",editable:!0,required:!1,type:"select",options:[{label:"GZIP",value:"gzip"}]}]}]},{name:"clickhouse_wrapper",handlerName:"click_house_fdw_handler",validatorName:"click_house_fdw_validator",icon:"/img/icons/clickhouse-icon.svg",extensionName:"ClickHouseFdw",label:"ClickHouse",docsUrl:"https://supabase.github.io/wrappers/clickhouse/",server:{options:[{name:"conn_string_id",label:"ClickHouse Connection String",required:!0,encrypted:!0,hidden:!0}]},tables:[{label:"ClickHouse Table",description:"Map to a ClickHouse Table",options:[{name:"table",label:"ClickHouse Table Name",editable:!0,required:!0,placeholder:"my_clickhouse_table",type:"text"},{name:"rowid_column",label:"Row ID Column",defaultValue:"id",editable:!0,required:!0,type:"text"}]}]}],xe=n(38579),ve=n.n(xe),be=n(67863),je=n(85945),ge=n(48228),ye=n(41532);function Ne(e){return"\n    begin;\n\n    ".concat(e,"\n    \n    commit;\n  ")}var we=["onSuccess"];function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){(0,T.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _e=function(e){var t=e.wrapper,n=e.wrapperMeta.server.options.filter((function(e){return e.encrypted})).map((function(e){var n="".concat(t.name,"_").concat(e.name);return"\n      delete from vault.secrets where key_id = (select id from pgsodium.valid_key where name = '".concat(n,"');\n\n      delete from pgsodium.key where name = '").concat(n,"';\n    ")})).join("\n");return"\n    drop foreign data wrapper if exists ".concat(t.name," cascade;\n\n    ").concat(n,"\n  ")};function Se(e){return Oe.apply(this,arguments)}function Oe(){return(Oe=(0,S.Z)(P().mark((function e(t){var n,r,a,s,i,c,o;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.projectRef,r=t.connectionString,a=t.wrapper,s=t.wrapperMeta,n){e.next=3;break}throw new Error("projectRef is required");case 3:return i=Ne(_e({wrapper:a,wrapperMeta:s})),e.next=6,(0,me.Rj)({projectRef:n,connectionString:r,sql:i});case 6:return c=e.sent,o=c.result,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onSuccess,n=(0,R.Z)(e,we),r=(0,je.NL)(),a=(0,j.oR)(),s=a.vault;return(0,ge.D)((function(e){return Se(e)}),ke({onSuccess:function(e,n,a){return(0,S.Z)(P().mark((function i(){var c;return P().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return c=n.projectRef,i.next=3,Promise.all([r.invalidateQueries(ye.M.query(c,["fdws"])),s.load()]);case 3:return i.next=5,null===t||void 0===t?void 0:t(e,n,a);case 5:case"end":return i.stop()}}),i)})))()}},n))},Pe=n(47510),Ee=n(44266),Fe=function(e){var t=e.wrappers,n=void 0===t?[]:t,a=e.wrapperMeta,s=e.isOpen,i=e.onOpen,c=(0,j.oR)().ui,o=(0,ae.UO)().ref,l=(0,Pe.d2)().project,u=Ce().mutateAsync,m=(0,j.FH)(b.KA.TENANT_SQL_ADMIN_WRITE,"wrappers");return(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(A.ZP,{open:s,onOpenChange:function(){return i(a.name)},className:["bg-scale-100 dark:bg-scale-300 ","hover:bg-scale-200 dark:hover:bg-scale-500","data-open:bg-scale-200 dark:data-open:bg-scale-500","border-scale-300","dark:border-scale-500 hover:border-scale-500","dark:hover:border-scale-700 data-open:border-scale-700","col-span-12 mx-auto","-space-y-px overflow-hidden","transition border shadow hover:z-50","first:rounded-tl first:rounded-tr first:!border-t","last:rounded-bl last:rounded-br last:border-t-0"].join(" "),children:[(0,w.jsx)(A.ZP.Trigger,{asChild:!0,children:(0,w.jsxs)("button",{type:"button",className:"flex items-center justify-between w-full px-6 py-3 rounded group text-scale-1200",children:[(0,w.jsxs)("div",{className:"flex items-center gap-3",children:[(0,w.jsx)(V.Z,{className:"transition text-scale-800 data-open-parent:rotate-0 data-closed-parent:rotate-180",strokeWidth:2,width:14}),(0,w.jsx)(ve(),{src:a.icon,width:20,height:20,alt:"".concat(a.name," wrapper icon")}),(0,w.jsx)("span",{className:"text-sm capitalize",children:a.label})]}),(0,w.jsx)("div",{className:"flex items-center gap-3",children:(0,w.jsxs)("div",{className:"px-3 py-1 text-xs border rounded-md border-scale-500 bg-scale-100 text-scale-1200 dark:border-scale-700 dark:bg-scale-300",children:[n.length," wrapper",n.length>1?"s":""]})})]})}),(0,w.jsx)(A.ZP.Content,{children:(0,w.jsx)("div",{className:"border-t group border-scale-500 bg-scale-100 text-scale-1200 dark:bg-scale-300 divide-y",children:n.map((function(e){var t=Object.fromEntries(e.server_options.map((function(e){return e.split("=")}))),n=(0,x.partition)(a.server.options,"hidden"),s=(0,r.Z)(n,2),i=s[0],p=s[1];return(0,w.jsxs)("div",{className:"px-6 py-4 flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"space-y-1 w-3/4",children:[(0,w.jsx)("div",{className:"flex items-center space-x-2",children:(0,w.jsx)("p",{className:"text-base",children:e.name})}),p.map((function(e){return(0,w.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-scale-1000",children:[(0,w.jsxs)("p",{children:[e.label,":"]}),(0,w.jsx)("p",{children:t[e.name]})]},e.name)})),i.map((function(t){return(0,w.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,w.jsxs)("p",{className:"text-scale-1000",children:[t.label,":"]}),(0,w.jsx)(le(),{href:"/project/".concat(o,"/settings/vault/secrets?search=").concat(e.name,"_").concat(t.name),children:(0,w.jsxs)("a",{className:"transition text-scale-1000 hover:text-scale-1100 flex items-center space-x-2",children:[(0,w.jsx)("span",{children:"Encrypted in Vault"}),(0,w.jsx)(ue.Z,{size:14,strokeWidth:1.5})]})})]},t.name)})),(0,w.jsxs)("div",{className:"!mt-3 space-y-1",children:[(0,w.jsxs)("p",{className:"text-sm text-scale-1100",children:["Foreign tables: (",e.tables.length,")"]}),(0,w.jsx)("div",{className:"flex flex-wrap gap-2",children:e.tables.map((function(e){return(0,w.jsx)(le(),{href:"/project/".concat(o,"/editor/").concat(e.id),children:(0,w.jsx)("a",{children:(0,w.jsx)("div",{className:"text-sm border rounded px-2 py-1 transition bg-scale-400 hover:bg-scale-500",children:e.name},e.id)})},e.id)}))})]})]}),(0,w.jsxs)("div",{className:"flex items-center space-x-2",children:[m?(0,w.jsx)(le(),{href:"/project/".concat(o,"/database/wrappers/").concat(e.id),children:(0,w.jsx)("a",{children:(0,w.jsx)(d.z,{type:"default",icon:(0,w.jsx)(be.Z,{strokeWidth:1.5}),className:"py-2"})})}):(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{children:(0,w.jsx)(d.z,{type:"default",disabled:!0,icon:(0,w.jsx)(be.Z,{strokeWidth:1.5}),className:"py-2"})}),!m&&(0,w.jsx)(v.h_,{children:(0,w.jsxs)(v.VY,{side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,w.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to edit wrappers"})})]})})]}),(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{children:(0,w.jsx)(d.z,{type:"default",disabled:!m,icon:(0,w.jsx)(f.Z,{strokeWidth:1.5}),className:"py-2",onClick:function(){return function(e){(0,Ee._)({title:"Confirm to disable ".concat(e.name),message:"Are you sure you want to disable the ".concat(e.name," wrapper? This will also remove all tables created with this wrapper."),onAsyncConfirm:function(){var t=(0,S.Z)(P().mark((function t(){return P().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u({projectRef:null===l||void 0===l?void 0:l.ref,connectionString:null===l||void 0===l?void 0:l.connectionString,wrapper:e,wrapperMeta:a});case 3:c.setNotification({category:"success",message:"Successfully disabled ".concat(e.name," foreign data wrapper")}),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),c.setNotification({error:t.t0,category:"error",message:"Failed to disable ".concat(e.name,": ").concat(t.t0.message)});case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(){return t.apply(this,arguments)}}()})}(e)}})}),!m&&(0,w.jsx)(v.h_,{children:(0,w.jsxs)(v.VY,{side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,w.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to add wrappers"})})]})})]})]})]},e.id)}))})})]})})},ze=(0,s.Pi)((function(e){var t=e.buttonText,n=void 0===t?"Add wrapper":t,r=e.align,s=void 0===r?"end":r,i=(0,ae.UO)().ref;return(0,j.FH)(b.KA.TENANT_SQL_ADMIN_WRITE,"wrappers")?(0,w.jsx)(L.ZP,{side:"bottom",align:s,size:"small",overlay:(0,w.jsx)(w.Fragment,{children:fe.map((function(e,t){return(0,w.jsxs)(a.Fragment,{children:[(0,w.jsx)(le(),{href:"/project/".concat(i,"/database/wrappers/new?type=").concat(e.name.toLowerCase()),children:(0,w.jsx)("a",{children:(0,w.jsx)(L.ZP.Item,{icon:(0,w.jsx)(ve(),{src:e.icon,width:20,height:20,alt:"".concat(e.name," wrapper icon")}),children:e.label},e.name)})}),t!==fe.length-1&&(0,w.jsx)(L.ZP.Separator,{})]},t)}))}),children:(0,w.jsx)(d.z,{type:"primary",icon:(0,w.jsx)(u.Z,{strokeWidth:1.5}),children:n})}):(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{children:(0,w.jsx)(d.z,{disabled:!0,type:"primary",icon:(0,w.jsx)(u.Z,{strokeWidth:1.5}),children:n})}),(0,w.jsx)(v.h_,{children:(0,w.jsxs)(v.VY,{side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,w.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to add wrappers"})})]})})]})})),De=n(22917),Te=(0,s.Pi)((function(){var e=(0,j.oR)(),t=e.ui,n=e.meta,r=(0,ae.UO)().ref,s=(0,De.Fg)().isDarkMode,i=n.extensions.byId("wrappers"),c=n.extensions.byId("supabase_vault"),o=void 0===i||void 0===c,l=(0,a.useState)(!1),u=l[0],m=l[1],p=(0,j.FH)(b.KA.TENANT_SQL_ADMIN_WRITE,"extensions"),h=function(){var e=(0,S.Z)(P().mark((function e(){var r,a,s,o;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==i&&void 0!==c){e.next=2;break}return e.abrupt("return");case 2:return m(!0),e.t0=Promise,e.next=6,n.extensions.create({schema:null!==(r=i.schema)&&void 0!==r?r:"extensions",name:i.name,version:i.default_version,cascade:!0});case 6:return e.t1=e.sent,e.next=9,n.extensions.create({schema:null!==(a=c.schema)&&void 0!==a?a:"vault",name:c.name,version:c.default_version,cascade:!0});case 9:return e.t2=e.sent,e.t3=[e.t1,e.t2],e.next=13,e.t0.all.call(e.t0,e.t3);case 13:s=e.sent,(o=s.filter((function(e){return e.error&&!e.error.message.includes("already exists")}))).length>0?t.setNotification({error:o,category:"error",message:"Failed to enable Wrappers for your project: ".concat(o.map((function(e){return e.message})).join(", "))}):t.setNotification({category:"success",message:"Wrappers is now enabled for your project!"}),m(!1);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,w.jsx)("div",{children:(0,w.jsx)("div",{className:"w-full px-12 py-12 bg-white bg-no-repeat border rounded dark:bg-scale-200 border-scale-500",style:{backgroundSize:"45%",backgroundPosition:"105% 40%",backgroundImage:'url("'.concat(he.GW,s?'/img/wrappers-dark.png")':'/img/wrappers-light.png")')},children:(0,w.jsxs)("div",{className:"w-3/5 space-y-8",children:[(0,w.jsxs)("div",{className:"space-y-2",children:[(0,w.jsx)("h4",{className:"text-lg",children:"Supabase Wrappers"}),(0,w.jsx)("p",{className:"text-sm text-scale-1100",children:"Supabase Wrappers is a framework for building Postgres Foreign Data Wrappers (FDW) which connect Postgres to external systems. Query your data warehouse or third-party APIs directly from your database."})]}),o?(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsxs)("div",{className:"rounded border border-scale-500 px-4 py-2 flex items-center justify-between",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("p",{className:"text-scale-1100 text-sm",children:"Wrappers is not available for this project yet."}),(0,w.jsx)("p",{className:"text-scale-1000 text-sm",children:"Do reach out to us if you're interested!"})]}),(0,w.jsx)("div",{children:(0,w.jsx)(le(),{href:"/support/new?ref=".concat(r,"&category=sales&subject=Request%20for%20access%20to%20wrappers"),children:(0,w.jsx)("a",{target:"_blank",rel:"noreferrer",children:(0,w.jsx)(d.z,{type:"primary",children:"Contact us"})})})})]}),(0,w.jsx)("div",{className:"flex items-center space-x-2 my-1 ml-[1px]",children:(0,w.jsx)(le(),{href:"https://supabase.com/docs/guides/database/wrappers",children:(0,w.jsx)("a",{target:"_blank",rel:"noreferrer",children:(0,w.jsx)(d.z,{type:"default",icon:(0,w.jsx)(ue.Z,{}),children:"About Wrappers"})})})})]}):(0,w.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,w.jsx)(le(),{href:"https://supabase.com/docs/guides/database/wrappers",children:(0,w.jsx)("a",{target:"_blank",rel:"noreferrer",children:(0,w.jsx)(d.z,{type:"default",icon:(0,w.jsx)(ue.Z,{}),children:"About Wrappers"})})}),(0,w.jsxs)(v.fC,{delayDuration:0,children:[(0,w.jsx)(v.xz,{children:(0,w.jsx)(d.z,{type:"primary",loading:u,disabled:o||u||!p,onClick:function(){return h()},children:"Enable Wrappers"})}),!p&&(0,w.jsx)(v.h_,{children:(0,w.jsxs)(v.VY,{side:"bottom",children:[(0,w.jsx)(v.Eh,{className:"radix-tooltip-arrow"}),(0,w.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,w.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to enable Wrappers for this project"})})]})})]})]})]})})})})),Re=(0,s.Pi)((function(){var e,t=(0,j.oR)().meta,n=(0,Pe.d2)().project,r=pe({projectRef:null===n||void 0===n?void 0:n.ref,connectionString:null===n||void 0===n?void 0:n.connectionString}),s=r.data,i=r.isLoading,c=(0,a.useState)(""),o=c[0],l=c[1],u=null!==(e=null===s||void 0===s?void 0:s.result)&&void 0!==e?e:[],m=(0,x.groupBy)(u,"handler"),p=t.extensions.byId("wrappers"),h=t.extensions.byId("supabase_vault"),f=t.extensions.isLoading,v=void 0!==p&&null!==p.installed_version&&void 0!==h&&null!==h.installed_version;return(0,w.jsxs)("div",{children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("h3",{className:"mb-2 text-xl text-scale-1200",children:"Foreign Data Wrappers"}),(0,w.jsx)("div",{className:"text-sm text-scale-900",children:"Query your data warehouse directly from your database, or third-party APIs using SQL."})]}),(0,w.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,w.jsx)(le(),{href:"",children:(0,w.jsx)("a",{target:"_blank",rel:"noreferrer",children:(0,w.jsx)(d.z,{type:"default",icon:(0,w.jsx)(ue.Z,{strokeWidth:1.5}),children:"Documentation"})})}),v&&(0,w.jsx)(ze,{})]})]}),f||i?(0,w.jsxs)("div",{className:"p-12 space-y-2 border rounded border-scale-500",children:[(0,w.jsx)(N.Z,{}),(0,w.jsx)(N.Z,{className:"w-3/4"}),(0,w.jsx)(N.Z,{className:"w-1/2"})]}):v?(0,w.jsx)("div",{children:0===u.length?(0,w.jsxs)("div",{className:["border rounded border-scale-500 px-20 py-16","flex flex-col items-center justify-center space-y-4"].join(" "),children:[(0,w.jsx)("p",{className:"text-sm",children:"No wrappers created yet"}),(0,w.jsx)(ze,{align:"center",buttonText:"Create a new wrapper"})]}):(0,w.jsx)(w.Fragment,{children:fe.map((function(e,t){var n,r=null!==(n=m[e.handlerName])&&void 0!==n?n:[];return r.length>0?(0,w.jsx)(Fe,{wrapperMeta:e,wrappers:r,isOpen:o===e.name,onOpen:function(e){l(o!==e?e:"")}},t):null}))})}):(0,w.jsx)(Te,{})]})})),Ie=n(44285),Ae=n(86677),Ve=n(39919),Le=["onSuccess"];function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?We(Object(n),!0).forEach((function(t){(0,T.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Me(e){var t=e.wrapperMeta,n=e.formState,a=e.tables,s=a.filter((function(e){return e.is_new_schema})).map((function(e){return"create schema if not exists ".concat(e.schema_name,";")})).join("\n"),i="\n    create foreign data wrapper ".concat(n.wrapper_name,"\n    handler ").concat(t.handlerName,"\n    validator ").concat(t.validatorName,";\n  "),c=t.server.options.filter((function(e){return e.encrypted})),o=t.server.options.filter((function(e){return!e.encrypted})),l=c.map((function(e){var t="".concat(n.wrapper_name,"_").concat(e.name),r=(n[e.name]||"").replace(/'/g,"''");return"\n      select pgsodium.create_key(\n        name := '".concat(t,"'\n      );\n\n      select vault.create_secret (\n        new_secret := '").concat(r,"',\n        new_name   := '").concat(t,"',\n        new_key_id := (select id from pgsodium.valid_key where name = '").concat(t,"')\n      );\n    ")})).join("\n"),d=c.map((function(e){return"".concat(e.name," ''%s''")})),u=o.map((function(e){return"".concat(e.name," ''").concat(n[e.name],"''")})),m=[].concat((0,Ie.Z)(d),(0,Ie.Z)(u)).join(","),p="\n    do $$\n    declare\n      ".concat(c.map((function(e){return"v_".concat(e.name," text;")})).join("\n"),"\n    begin\n      ").concat(c.map((function(e){return"select id into v_".concat(e.name," from pgsodium.valid_key where name = '").concat(n.wrapper_name,"_").concat(e.name,"' limit 1;")})).join("\n"),"\n    \n      execute format(\n        E'create server ").concat(n.server_name,"\\n'\n        '   foreign data wrapper ").concat(n.wrapper_name,"\\n'\n        '   options (\\n'\n        '     ").concat(m,"\\n'\n        '   );',\n        ").concat(c.map((function(e){return"v_".concat(e.name)})).join(",\n"),"\n      );\n    end $$;\n  "),h=a.map((function(e){var t=e.columns;return'\n        create foreign table "'.concat(e.schema_name,'"."').concat(e.table_name,'" (\n          ').concat(t.map((function(e){return'"'.concat(e.name,'" ').concat(e.type)})).join(",\n          "),"\n        )\n        server ").concat(n.server_name,"\n        options (\n          ").concat(Object.entries(e).filter((function(e){var t=(0,r.Z)(e,1)[0];return"table_name"!==t&&"schema_name"!==t&&"columns"!==t&&"index"!==t})).map((function(e){var t=(0,r.Z)(e,2),n=t[0],a=t[1];return"".concat(n," '").concat(a,"'")})).join(",\n          "),"\n        );\n      ")})).join("\n\n");return"\n    ".concat(s,"\n\n    ").concat(i,"\n\n    ").concat(l,"\n\n    ").concat(p,"\n\n    ").concat(h,"\n  ")}function Ye(e){return Ue.apply(this,arguments)}function Ue(){return(Ue=(0,S.Z)(P().mark((function e(t){var n,r,a,s,i,c,o,l;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectRef,r=t.connectionString,a=t.wrapperMeta,s=t.formState,i=t.tables,c=Ne(Me({wrapperMeta:a,formState:s,tables:i})),e.next=4,(0,me.Rj)({projectRef:n,connectionString:r,sql:c});case 4:return o=e.sent,l=o.result,e.abrupt("return",l);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onSuccess,n=(0,R.Z)(e,Le),r=(0,je.NL)(),a=(0,j.oR)(),s=a.vault;return(0,ge.D)((function(e){return Ye(e)}),qe({onSuccess:function(e,n,a){return(0,S.Z)(P().mark((function i(){var c;return P().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return c=n.projectRef,i.next=3,Promise.all([r.invalidateQueries(ye.M.query(c,["fdws"]),{refetchType:"all"}),s.load()]);case 3:return i.next=5,null===t||void 0===t?void 0:t(e,n,a);case 5:case"end":return i.stop()}}),i)})))()}},n))},He=n(14971),Ke=n(44292),Qe=n(51669),Ge=function(e){var t,n,r,s=e.option,i=e.loading,c=e.error,l=(0,a.useState)(!s.hidden),u=l[0],m=l[1];return s.isTextArea?(0,w.jsx)("div",{className:"text-area-text-sm text-area-resize-none",children:(0,w.jsx)(o.Z.TextArea,{rows:6,error:c,className:"input-mono",disabled:i,id:s.name,name:s.name,label:(0,w.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,w.jsx)("p",{children:s.label}),void 0!==s.urlHelper&&(0,w.jsx)(le(),{href:s.urlHelper,children:(0,w.jsx)("a",{target:"_blank",rel:"noreferrer",children:(0,w.jsx)(M.Z,{strokeWidth:2,size:14,className:"text-scale-1000 hover:text-scale-1200 cursor-pointer transition"})})})]}),value:i?"Fetching value from Vault...":void 0,defaultValue:null!==(t=s.defaultValue)&&void 0!==t?t:"",required:null!==(n=s.required)&&void 0!==n&&n},s.name)}):(0,w.jsx)(o.Z,{id:s.name,name:s.name,label:(0,w.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,w.jsx)("p",{children:s.label}),void 0!==s.urlHelper&&(0,w.jsx)(le(),{href:s.urlHelper,children:(0,w.jsx)("a",{target:"_blank",rel:"noreferrer",children:(0,w.jsx)(M.Z,{strokeWidth:2,size:14,className:"text-scale-1000 hover:text-scale-1200 cursor-pointer transition"})})})]}),defaultValue:null!==(r=s.defaultValue)&&void 0!==r?r:"",error:c,value:i?"Fetching value from Vault...":void 0,type:!s.hidden||i||u?"text":"password",disabled:i,actions:i?(0,w.jsx)("div",{className:"flex items-center justify-center mr-1",children:(0,w.jsx)(d.z,{disabled:!0,type:"default",icon:(0,w.jsx)(He.Z,{className:"animate-spin"})})}):s.hidden?(0,w.jsx)("div",{className:"flex items-center justify-center mr-1",children:(0,w.jsx)(d.z,{type:"default",icon:u?(0,w.jsx)(Ke.Z,{}):(0,w.jsx)(Qe.Z,{}),onClick:function(){return m(!u)}})}):null},s.name)},Je=n(3305),$e=n(34789),Xe=n(75978),et=n(21246);function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach((function(t){(0,T.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var rt=[{name:"",type:"text"}],at=function(e){var t=e.initialColumns,n=void 0===t?rt:t,s=e.onChange,i=e.errors,c=void 0===i?{}:i,l=(0,a.useReducer)((function(e,t){switch(t.type){case"ADD_COLUMN":return nt(nt({},e),{},{columns:nt(nt({},e.columns),{},(0,T.Z)({},e.nextId,{id:e.nextId,name:"",type:"text"})),nextId:e.nextId+1});case"REMOVE_COLUMN":return nt(nt({},e),{},{columns:Object.fromEntries(Object.entries(e.columns).filter((function(e){var n=(0,r.Z)(e,1)[0];return Number(n)!==t.payload.id})))});case"UPDATE_COLUMN":return nt(nt({},e),{},{columns:nt(nt({},e.columns),{},(0,T.Z)({},t.payload.id,nt(nt({},e.columns[t.payload.id]),{},(0,T.Z)({},t.payload.key,t.payload.value))))});default:return e}}),{columns:Object.fromEntries(n.map((function(e,t){return[t,nt(nt({},e),{},{id:t})]}))),nextId:n.length}),u=l[0],m=l[1],p=(0,et.Z)(s);(0,a.useEffect)((function(){var e;null===(e=p.current)||void 0===e||e.call(p,st(u.columns))}),[u.columns]);var h=function(e,t,n){m({type:"UPDATE_COLUMN",payload:{id:e,key:t,value:n}})},f=st(u.columns);return(0,w.jsxs)("div",{className:"w-full flex flex-col gap-4",children:[(0,w.jsx)("div",{className:"flex flex-col gap-4",children:f.map((function(e,t){return(0,w.jsxs)("div",{className:"flex flex-col",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)(o.Z,{className:"flex-1 [&_label]:!p-0",layout:"vertical",label:"Name",value:e.name,onChange:function(t){return h(e.id,"name",t.target.value)}}),(0,w.jsx)("div",{className:"flex-1",children:(0,w.jsx)(Xe.Z,{value:e.type,enumTypes:[],onOptionSelect:function(t){return h(e.id,"type",t)},layout:"vertical",className:"[&_label]:!p-0"})}),(0,w.jsx)(d.z,{onClick:function(){return t=e.id,void m({type:"REMOVE_COLUMN",payload:{id:t}});var t},icon:(0,w.jsx)(E.Z,{size:14,strokeWidth:1.5}),type:"outline",className:"self-end -translate-y-1 !px-2 !py-2"})]}),c["columns.".concat(t)]&&(0,w.jsx)("span",{className:"text-red-900 text-sm mt-2",children:c["columns.".concat(t)]})]},e.id)}))}),(0,w.jsx)(d.z,{type:"default",onClick:function(){m({type:"ADD_COLUMN"})},className:"self-start",children:"Add column"})]})};function st(e){return Object.values(e).sort((function(e,t){return e.id-t.id}))}function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(Object(n),!0).forEach((function(t){(0,T.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ot=function(e){var t=new Set(e.filter((function(e){return e.required})).map((function(e){return e.name}))),n=new Set(Array.from(t).filter((function(e){return e.includes(".")}))),a=Array.from(n);return function(e){return Object.fromEntries(Object.entries(e).flatMap((function(e){var t=(0,r.Z)(e,2),n=t[0],a=t[1];return Array.isArray(a)?[[n,a]].concat((0,Ie.Z)(a.map((function(e,t){return["".concat(n,".").concat(t),e]})))):[[n,a]]})).filter((function(e){var s=(0,r.Z)(e,2),i=s[0],c=s[1],o=i.split("."),l=(0,r.Z)(o,2),d=l[0];if(void 0!==l[1]&&t.has(d)&&Object.keys(c).some((function(e){return n.has("".concat(d,".").concat(e))}))){var u=a.find((function(e){return e.startsWith("".concat(d,"."))}));return!!u&&!c[u.split(".")[1]]}return t.has(d)&&(Array.isArray(c)?c.length<1:!c)})).map((function(e){var t=(0,r.Z)(e,1)[0];return"table_name"===t?[t,"Please provide a name for your table"]:"columns"===t?[t,"Please select at least one column"]:[t,"This field is required"]})))}},lt=function(e){return e.map((function(e,t){return ct(ct({},Object.fromEntries(e.options.map((function(e){return e.split("=")})))),{},{index:t,columns:e.columns,is_new_schema:!1,schema:e.schema,schema_name:e.schema,table_name:e.name})}))};function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){(0,T.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mt=function(e){var t=e.visible,n=e.onCancel,r=e.onSave,s=e.tables,c=e.initialData,o=(0,a.useState)(""),l=o[0],d=o[1];(0,a.useEffect)((function(){c&&d(String(c.index))}),[c]);var u=""===l?void 0:s[parseInt(l)],m=function(){d(""),n()};return(0,w.jsx)(G.ZP,{size:"medium",visible:t,onCancel:m,header:(0,w.jsx)("span",{children:"Edit foreign table"}),customFooter:(0,w.jsx)(Je.Z,{backButtonLabel:"Cancel",applyButtonLabel:"Save",formId:"wrapper-table-editor-form",closePanel:m}),children:(0,w.jsx)(G.ZP.Content,{children:(0,w.jsxs)("div",{className:"my-4 space-y-6",children:[(0,w.jsxs)(i.Z,{size:"small",label:"Select a target the table will point to",value:l,onChange:function(e){return d(e)},children:[(0,w.jsx)(i.Z.Option,{value:"",label:"---",children:"---"},"empty"),s.map((function(e,t){return(0,w.jsx)(i.Z.Option,{className:"group",value:String(t),label:e.label,children:(0,w.jsxs)("div",{className:"space-y-1",children:[(0,w.jsx)("p",{children:e.label}),(0,w.jsx)("p",{className:"opacity-50",children:e.description})]})},String(t))}))]}),u&&(0,w.jsx)(ht,{table:u,onSubmit:function(e,t){var n=t.resetForm;r(ut(ut({},e),{},{index:parseInt(l),schema_name:"custom"===e.schema?e.schema_name:e.schema,is_new_schema:"custom"===e.schema})),n(),d("")},initialData:c})]})})},"WrapperTableEditor")},pt=function(e){var t,n,r,a=e.option;return"select"===a.type?(0,w.jsx)(i.Z,{id:a.name,name:a.name,label:a.label,defaultValue:null!==(r=a.defaultValue)&&void 0!==r?r:"",children:[].concat((0,Ie.Z)(a.required?[]:[(0,w.jsx)(i.Z.Option,{value:"",label:"---",children:"---"},"empty")]),(0,Ie.Z)(a.options.map((function(e){return(0,w.jsx)(i.Z.Option,{id:a.name+e.value,value:e.value,label:e.label,children:e.label},e.value)}))))},a.name):(0,w.jsx)(o.Z,{id:a.name,name:a.name,label:a.label,placeholder:null!==(t=a.placeholder)&&void 0!==t?t:"",defaultValue:null!==(n=a.defaultValue)&&void 0!==n?n:""},a.name)},ht=function(e){var t,n,r,a=e.table,s=e.onSubmit,c=e.initialData,l=(0,j.oR)().meta.schemas.list(),d=null!==(t=a.options.filter((function(e){return e.editable&&e.required&&!e.defaultValue})))&&void 0!==t?t:[],m=null!==(n=a.options.filter((function(e){return e.editable&&(!e.required||e.defaultValue)})))&&void 0!==n?n:[],p=null!==c&&void 0!==c?c:ut(ut({table_name:"",columns:null!==(r=a.availableColumns)&&void 0!==r?r:[]},Object.fromEntries(a.options.map((function(e){var t;return[e.name,null!==(t=e.defaultValue)&&void 0!==t?t:""]})))),{},{schema:"public",schema_name:""}),h=ot([].concat((0,Ie.Z)(a.options),[{name:"table_name",required:!0},{name:"columns",required:!0}],(0,Ie.Z)(a.availableColumns?[]:[{name:"columns.name",required:!0}])));return(0,w.jsx)(I.Z,{id:"wrapper-table-editor-form",initialValues:p,validate:h,onSubmit:s,enableReinitialize:!0,children:function(e){var t=e.errors,n=e.values,r=e.setFieldValue;return(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsxs)(i.Z,{size:"small",name:"schema",label:"Select a schema for the foreign table",children:[(0,w.jsx)(i.Z.Option,{id:"custom",label:"Create a new schema",value:"custom",addOnBefore:function(){return(0,w.jsx)(u.Z,{size:16,strokeWidth:1.5})},children:"Create a new schema"},"custom"),(0,w.jsx)($.C.Separator,{}),l.map((function(e){return(0,w.jsx)(i.Z.Option,{id:e.name,label:e.name,value:e.name,addOnBefore:function(){return(0,w.jsx)($e.Z,{size:16,strokeWidth:1.5})},children:e.name},e.id)}))]}),"custom"===n.schema&&(0,w.jsx)(o.Z,{id:"schema_name",name:"schema_name",label:"Schema name"}),(0,w.jsx)(o.Z,{id:"table_name",name:"table_name",label:"Table name",descriptionText:"You can query from this table after the wrapper is enabled."}),d.map((function(e){return(0,w.jsx)(pt,{option:e},e.name)})),(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsx)("label",{className:"!w-full",children:a.availableColumns?"Select the columns to be added to your table":"Add columns to your table"}),(0,w.jsx)("div",{className:"flex flex-wrap gap-2 w-full",children:a.availableColumns?a.availableColumns.map((function(e){var t=Boolean(n.columns.find((function(t){return t.name===e.name})));return(0,w.jsx)("div",{className:["px-2 py-1 rounded cursor-pointer transition","".concat(t?"bg-brand-800":"bg-scale-500 hover:bg-scale-700")].join(" "),onClick:function(){r("columns",t?n.columns.filter((function(t){return t.name!==e.name})):n.columns.concat([e]))},children:(0,w.jsx)("p",{className:"text-sm",children:e.name})},e.name)})):(0,w.jsx)(at,{initialColumns:n.columns,onChange:function(e){r("columns",e)},errors:t})}),t.columns&&(0,w.jsx)("span",{className:"text-red-900 text-sm mt-2",children:t.columns})]}),m.map((function(e){return(0,w.jsx)(pt,{option:e},e.name)}))]})}})};function ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ft(Object(n),!0).forEach((function(t){(0,T.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var vt=(0,s.Pi)((function(){var e="create-wrapper-form",t=(0,Ae.useRouter)(),n=(0,j.oR)().ui,r=(0,ae.UO)(),s=r.ref,i=r.type,c=(0,Pe.d2)().project,l=Be().mutateAsync,u=(0,a.useState)([]),m=u[0],p=u[1],h=(0,a.useState)(!1),v=h[0],g=h[1],y=(0,a.useState)(),N=y[0],Z=y[1],k=(0,a.useState)({}),_=k[0],O=k[1],C=(0,j.FH)(b.KA.TENANT_SQL_ADMIN_WRITE,"wrappers"),E=fe.find((function(e){return e.name===i})),F=void 0!==E?xt({wrapper_name:"",server_name:""},Object.fromEntries(E.server.options.map((function(e){var t;return[e.name,null!==(t=e.defaultValue)&&void 0!==t?t:""]})))):{};if(void 0===E)return(0,w.jsxs)("div",{className:"flex flex-col items-center justify-center w-full h-full space-y-4",children:[(0,w.jsxs)("div",{className:"space-y-2 flex flex-col items-center w-[400px]",children:[(0,w.jsx)("p",{children:"Unsupported wrapper type"}),(0,w.jsxs)("p",{className:"text-sm text-center text-scale-1000",children:["The wrapper type ",i," not supported by the dashboard. Head back to create a different wrapper."]})]}),(0,w.jsx)(le(),{href:"/project/".concat(s,"/database/wrappers"),children:(0,w.jsx)("a",{children:(0,w.jsx)(d.z,{type:"default",children:"Head back"})})})]});var z=function(){var e=(0,S.Z)(P().mark((function e(r,a){var i,o,d,u;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a.setSubmitting,o=ot(E.server.options),d=o(r),0===(u=r.wrapper_name).length&&(d.name="Please provide a name for your wrapper"),0===m.length&&(d.tables="Please add at least one table"),(0,x.isEmpty)(d)){e.next=8;break}return e.abrupt("return",O(d));case 8:return i(!0),e.prev=9,e.next=12,l({projectRef:null===c||void 0===c?void 0:c.ref,connectionString:null===c||void 0===c?void 0:c.connectionString,wrapperMeta:E,formState:xt(xt({},r),{},{server_name:"".concat(u,"_server")}),tables:m});case 12:n.setNotification({category:"success",message:"Successfully created ".concat(E.label," foreign data wrapper")}),p([]),t.push("/project/".concat(s,"/database/wrappers")),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(9),n.setNotification({error:e.t0,category:"error",message:"Failed to create ".concat(E.label," foreign data wrapper: ").concat(e.t0.message)});case 20:return e.prev=20,i(!1),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[9,17,20,23]])})));return function(t,n){return e.apply(this,arguments)}}();return(0,w.jsxs)(D.ld,{children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("div",{className:"relative flex items-center justify-between mb-6",children:[(0,w.jsx)("div",{className:["transition cursor-pointer","absolute -left-20 top-1 opacity-75 hover:opacity-100"].join(" "),children:(0,w.jsx)(le(),{href:"/project/".concat(s,"/database/wrappers"),children:(0,w.jsx)("a",{children:(0,w.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,w.jsx)(Ve.Z,{strokeWidth:1.5,size:14}),(0,w.jsx)("p",{className:"text-sm",children:"Back"})]})})})}),(0,w.jsxs)("h3",{className:"mb-2 text-xl text-scale-1200",children:["Create a ",E.label," Wrapper"]}),(0,w.jsx)("div",{className:"flex items-center space-x-2",children:(0,w.jsx)(le(),{href:E.docsUrl,children:(0,w.jsx)("a",{target:"_blank",rel:"noreferrer",children:(0,w.jsx)(d.z,{type:"default",icon:(0,w.jsx)(ue.Z,{strokeWidth:1.5}),children:"Documentation"})})})})]}),(0,w.jsx)(I.Z,{id:e,initialValues:F,onSubmit:z,children:function(t){var n,r=t.isSubmitting,a=t.handleReset,s=t.values,i=t.initialValues,c=JSON.stringify(s)!==JSON.stringify(i);return(0,w.jsxs)(D.by,{disabled:!C,footer:(0,w.jsx)("div",{className:"flex px-8 py-4",children:(0,w.jsx)(D.iN,{form:e,isSubmitting:r,hasChanges:c,handleReset:a,disabled:!C,helper:C?void 0:"You need additional permissions to create a foreign data wrapper"})}),children:[(0,w.jsx)(D.hj,{header:(0,w.jsx)(D.S0,{children:"Wrapper Configuration"}),children:(0,w.jsx)(D.B4,{loading:!1,children:(0,w.jsx)(o.Z,{id:"wrapper_name",label:"Wrapper Name",error:_.wrapper_name,descriptionText:(null!==(n=null===s||void 0===s?void 0:s.wrapper_name)&&void 0!==n?n:"").length>0?(0,w.jsxs)(w.Fragment,{children:["Your wrapper's server name will be"," ",(0,w.jsxs)("code",{className:"text-xs",children:[s.wrapper_name,"_server"]})]}):""})})}),(0,w.jsx)(D.hj,{header:(0,w.jsxs)(D.S0,{children:[E.label," Configuration"]}),children:(0,w.jsx)(D.B4,{loading:!1,children:E.server.options.map((function(e){return(0,w.jsx)(Ge,{option:e,loading:!1,error:_[e.name]},e.name)}))})}),(0,w.jsx)(D.hj,{header:(0,w.jsxs)(D.S0,{children:[(0,w.jsx)("p",{children:"Foreign Tables"}),(0,w.jsx)("p",{className:"text-scale-1000 mt-2 w-[90%]",children:"You can query your data from these foreign tables after the wrapper is created"})]}),children:(0,w.jsxs)(D.B4,{loading:!1,children:[0===m.length?(0,w.jsx)("div",{className:"flex justify-end translate-y-4",children:(0,w.jsx)(d.z,{type:"default",onClick:function(){return g(!0)},children:"Add foreign table"})}):(0,w.jsx)("div",{className:"space-y-2",children:m.map((function(e,t){return(0,w.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border rounded-md border-scale-600",children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("p",{className:"text-sm",children:[e.schema_name,".",e.table_name]}),(0,w.jsxs)("p",{className:"text-sm text-scale-1000",children:[E.tables[e.index].label,":"," ",e.columns.map((function(e){return e.name})).join(", ")]})]}),(0,w.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,w.jsx)(d.z,{type:"default",className:"px-1",icon:(0,w.jsx)(be.Z,{}),onClick:function(){g(!0),Z(xt(xt({},e),{},{tableIndex:t}))}}),(0,w.jsx)(d.z,{type:"default",className:"px-1",icon:(0,w.jsx)(f.Z,{}),onClick:function(){p((function(e){return e.filter((function(e,n){return n!==t}))}))}})]})]},"".concat(e.schema_name,".").concat(e.table_name))}))}),m.length>0&&(0,w.jsx)("div",{className:"flex justify-end",children:(0,w.jsx)(d.z,{type:"default",onClick:function(){return g(!0)},children:"Add foreign table"})}),0===m.length&&_.tables&&(0,w.jsx)("p",{className:"text-sm text-right text-red-900",children:_.tables})]})})]})}})]}),(0,w.jsx)(mt,{visible:v,tables:E.tables,onCancel:function(){Z(void 0),g(!1)},onSave:function(e){p((function(t){if(void 0!==e.tableIndex){var n=e.tableIndex,r=(0,Ie.Z)(t);return delete e.tableIndex,r[n]=e,r}return[].concat((0,Ie.Z)(t),[e])})),g(!1),Z(void 0)},initialData:N})]})})),bt=["onSuccess"];function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(n),!0).forEach((function(t){(0,T.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var yt=function(e){var t=e.wrapper,n=e.wrapperMeta,r=e.formState,a=e.tables,s=_e({wrapper:t,wrapperMeta:n}),i=Me({wrapperMeta:n,formState:r,tables:a});return"\n    ".concat(s,"\n\n    ").concat(i,"\n  ")};function Nt(e){return wt.apply(this,arguments)}function wt(){return(wt=(0,S.Z)(P().mark((function e(t){var n,r,a,s,i,c,o,l,d;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.projectRef,r=t.connectionString,a=t.wrapper,s=t.wrapperMeta,i=t.formState,c=t.tables,n){e.next=3;break}throw new Error("projectRef is required");case 3:return o=Ne(yt({wrapper:a,wrapperMeta:s,formState:i,tables:c})),e.next=6,(0,me.Rj)({projectRef:n,connectionString:r,sql:o});case 6:return l=e.sent,d=l.result,e.abrupt("return",d);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Zt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onSuccess,n=(0,R.Z)(e,bt),r=(0,je.NL)(),a=(0,j.oR)(),s=a.vault;return(0,ge.D)((function(e){return Nt(e)}),gt({onSuccess:function(e,n,a){return(0,S.Z)(P().mark((function i(){var c;return P().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return c=n.projectRef,i.next=3,Promise.all([r.invalidateQueries(ye.M.query(c,["fdws"])),s.load()]);case 3:return i.next=5,null===t||void 0===t?void 0:t(e,n,a);case 5:case"end":return i.stop()}}),i)})))()}},n))},kt=n(97588);function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function St(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach((function(t){(0,T.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ot=(0,s.Pi)((function(){var e,t,n,s="edit-wrapper-form",i=(0,Ae.useRouter)(),c=(0,j.oR)(),l=c.ui,u=c.vault,m=(0,ae.UO)(),p=m.ref,h=m.id,v=(0,Pe.d2)().project,g=pe({projectRef:null===v||void 0===v?void 0:v.ref,connectionString:null===v||void 0===v?void 0:v.connectionString}),y=g.data,N=g.isLoading,Z=(null!==(e=null===y||void 0===y?void 0:y.result)&&void 0!==e?e:[]).find((function(e){return Number(e.id)===Number(h)})),k=(0,j.Je)(Z),_=fe.find((function(e){return e.handlerName===(null===k||void 0===k?void 0:k.handler)})),O=Zt(),C=O.mutateAsync,E=O.isLoading,F=(0,a.useState)([]),z=F[0],R=F[1],A=(0,a.useState)(!1),V=A[0],L=A[1],W=(0,a.useState)(),q=W[0],M=W[1],Y=(0,a.useState)({}),U=Y[0],B=Y[1],H=(0,j.FH)(b.KA.TENANT_SQL_ADMIN_WRITE,"wrappers"),K=void 0!==_?St({wrapper_name:null===k||void 0===k?void 0:k.name,server_name:null===k||void 0===k?void 0:k.server_name},(n=null!==(t=null===k||void 0===k?void 0:k.server_options)&&void 0!==t?t:[],Object.fromEntries(n.map((function(e){return e.split("=")}))))):{};if((0,a.useEffect)((function(){var e;null!==k&&void 0!==k&&k.id&&R(lt(null!==(e=null===k||void 0===k?void 0:k.tables)&&void 0!==e?e:[]))}),[null===k||void 0===k?void 0:k.id]),N)return(0,w.jsx)("div",{className:"flex items-center justify-center w-full h-full",children:(0,w.jsx)(kt.Z,{})});if(void 0===k||void 0===_)return E?(0,w.jsx)("div",{className:"flex flex-col items-center justify-center w-full h-full space-y-4",children:(0,w.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,w.jsx)(He.Z,{className:"animate-spin",size:16}),(0,w.jsx)("p",{className:"text-sm",children:"Updating wrapper"})]})}):(0,w.jsxs)("div",{className:"flex flex-col items-center justify-center w-full h-full space-y-4",children:[(0,w.jsxs)("div",{className:"space-y-2 flex flex-col items-center w-[400px]",children:[(0,w.jsx)("p",{children:"Unknown wrapper"}),(0,w.jsxs)("p",{className:"text-sm text-center text-scale-1000",children:["The wrapper ID ",h," cannot be found in your project. Head back to select another wrapper."]})]}),(0,w.jsx)(le(),{href:"/project/".concat(p,"/database/wrappers"),children:(0,w.jsx)("a",{children:(0,w.jsx)(d.z,{type:"default",children:"Head back"})})})]});var Q=function(){var e=(0,S.Z)(P().mark((function e(t,n){var r,a,s,c;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.setSubmitting,a=ot(_.server.options),s=a(t),0===(c=t.wrapper_name).length&&(s.name="Please provide a name for your wrapper"),0===z.length&&(s.tables="Please add at least one table"),(0,x.isEmpty)(s)){e.next=8;break}return e.abrupt("return",B(s));case 8:return r(!0),e.prev=9,e.next=12,C({projectRef:null===v||void 0===v?void 0:v.ref,connectionString:null===v||void 0===v?void 0:v.connectionString,wrapper:k,wrapperMeta:_,formState:St(St({},t),{},{server_name:"".concat(c,"_server")}),tables:z});case 12:l.setNotification({category:"success",message:"Successfully updated ".concat(_.label," foreign data wrapper")}),R([]),i.push("/project/".concat(p,"/database/wrappers")),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(9),l.setNotification({error:e.t0,category:"error",message:"Failed to create ".concat(_.label," foreign data wrapper: ").concat(e.t0.message)});case 20:return e.prev=20,r(!1),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[9,17,20,23]])})));return function(t,n){return e.apply(this,arguments)}}();return(0,w.jsxs)(D.ld,{children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("div",{className:"relative flex items-center justify-between mb-6",children:[(0,w.jsx)("div",{className:["transition cursor-pointer","absolute -left-20 top-1 opacity-75 hover:opacity-100"].join(" "),children:(0,w.jsx)(le(),{href:"/project/".concat(p,"/database/wrappers"),children:(0,w.jsx)("a",{children:(0,w.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,w.jsx)(Ve.Z,{strokeWidth:1.5,size:14}),(0,w.jsx)("p",{className:"text-sm",children:"Back"})]})})})}),(0,w.jsxs)("h3",{className:"mb-2 text-xl text-scale-1200",children:["Edit wrapper: ",k.name]}),(0,w.jsx)("div",{className:"flex items-center space-x-2",children:(0,w.jsx)(le(),{href:"https://supabase.github.io/wrappers/stripe/",children:(0,w.jsx)("a",{target:"_blank",rel:"noreferrer",children:(0,w.jsx)(d.z,{type:"default",icon:(0,w.jsx)(ue.Z,{strokeWidth:1.5}),children:"Documentation"})})})})]}),(0,w.jsx)(I.Z,{id:s,initialValues:K,onSubmit:Q,children:function(e){var t,n=e.isSubmitting,i=e.handleReset,c=e.values,l=e.initialValues,m=e.resetForm,p=(0,a.useState)(!1),h=p[0],x=p[1],v=lt(null!==(t=null===k||void 0===k?void 0:k.tables)&&void 0!==t?t:[]),b=JSON.stringify(c)!==JSON.stringify(l),j=JSON.stringify(v)!==JSON.stringify(z),g=b||j,y=_.server.options.filter((function(e){return e.encrypted}));return(0,a.useEffect)((function(){var e=function(){var e=(0,S.Z)(P().mark((function e(){var t,n;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.next=3,Promise.all(y.map(function(){var e=(0,S.Z)(P().mark((function e(t){var n,a,s,i;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.listSecrets((function(e){return e.name==="".concat(k.name,"_").concat(t.name)})),a=(0,r.Z)(n,1),void 0===(s=a[0])){e.next=8;break}return e.next=4,u.fetchSecretValue(s.id);case 4:return i=e.sent,e.abrupt("return",(0,T.Z)({},t.name,i));case 8:return e.abrupt("return",(0,T.Z)({},t.name,""));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:t=e.sent,n=t.reduce((function(e,t){var n=Object.keys(t),a=(0,r.Z)(n,1)[0];return St(St({},e),{},(0,T.Z)({},a,t[a]))}),{}),m({values:St(St({},c),n),initialValues:St(St({},l),n)}),x(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();y.length>0&&e()}),[]),(0,w.jsxs)(D.by,{disabled:!H,footer:(0,w.jsx)("div",{className:"flex px-8 py-4",children:(0,w.jsx)(D.iN,{form:s,isSubmitting:n,hasChanges:g,handleReset:function(){i(),R(v)},disabled:!H,helper:H?void 0:"You need additional permissions to edit a foreign data wrapper"})}),children:[(0,w.jsx)(D.hj,{header:(0,w.jsx)(D.S0,{children:"Wrapper Configuration"}),children:(0,w.jsx)(D.B4,{loading:!1,children:(0,w.jsx)(o.Z,{id:"wrapper_name",label:"Wrapper Name",error:U.wrapper_name,descriptionText:c.wrapper_name!==l.wrapper_name?(0,w.jsxs)(w.Fragment,{children:["Your wrapper's server name will be updated to"," ",(0,w.jsxs)("code",{className:"text-xs",children:[c.wrapper_name,"_server"]})]}):(0,w.jsxs)(w.Fragment,{children:["Your wrapper's server name is"," ",(0,w.jsxs)("code",{className:"text-xs",children:[c.wrapper_name,"_server"]})]})})})}),(0,w.jsx)(D.hj,{header:(0,w.jsxs)(D.S0,{children:[_.label," Configuration"]}),children:(0,w.jsx)(D.B4,{loading:!1,children:_.server.options.map((function(e){return(0,w.jsx)(Ge,{option:e,loading:!!e.encrypted&&h,error:U[e.name]},e.name)}))})}),(0,w.jsx)(D.hj,{header:(0,w.jsxs)(D.S0,{children:[(0,w.jsx)("p",{children:"Foreign Tables"}),(0,w.jsx)("p",{className:"text-scale-1000 mt-2 w-[90%]",children:"You can query your data from these foreign tables after the wrapper is created"})]}),children:(0,w.jsxs)(D.B4,{loading:!1,children:[0===z.length?(0,w.jsx)("div",{className:"flex justify-end translate-y-4",children:(0,w.jsx)(d.z,{type:"default",onClick:function(){return L(!0)},children:"Add foreign table"})}):(0,w.jsx)("div",{className:"space-y-2",children:z.map((function(e,t){return(0,w.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border rounded-md border-scale-600",children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("p",{className:"text-sm",children:[e.schema_name,".",e.table_name]}),(0,w.jsxs)("p",{className:"text-sm text-scale-1000",children:[_.tables[e.index].label,":"," ",e.columns.map((function(e){return e.name})).join(", ")]})]}),(0,w.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,w.jsx)(d.z,{type:"default",className:"px-1",icon:(0,w.jsx)(be.Z,{}),onClick:function(){L(!0),M(St(St({},e),{},{tableIndex:t}))}}),(0,w.jsx)(d.z,{type:"default",className:"px-1",icon:(0,w.jsx)(f.Z,{}),onClick:function(){R((function(e){return e.filter((function(e,n){return n!==t}))}))}})]})]},"".concat(e.schema_name,".").concat(e.table_name))}))}),z.length>0&&(0,w.jsx)("div",{className:"flex justify-end",children:(0,w.jsx)(d.z,{type:"default",onClick:function(){return L(!0)},children:"Add foreign table"})}),0===z.length&&U.tables&&(0,w.jsx)("p",{className:"text-sm text-right text-red-900",children:U.tables})]})})]})}})]}),(0,w.jsx)(mt,{visible:V,tables:_.tables,onCancel:function(){M(void 0),L(!1)},onSave:function(e){R((function(t){if(void 0!==e.tableIndex){var n=e.tableIndex,r=(0,Ie.Z)(t);return delete e.tableIndex,r[n]=e,r}return[].concat((0,Ie.Z)(t),[e])})),L(!1),M(void 0)},initialData:q})]})})),Ct=(0,s.Pi)((function(e){var t=e.onSelectPublication,n=void 0===t?function(){}:t,r=(0,j.oR)(),s=r.ui,i=r.meta,c=(0,a.useState)(""),u=c[0],m=c[1],p=(0,j.FH)(b.KA.TENANT_SQL_ADMIN_WRITE,"publications"),h=[{event:"Insert",key:"publish_insert"},{event:"Update",key:"publish_update"},{event:"Delete",key:"publish_delete"},{event:"Truncate",key:"publish_truncate"}],f=0===u.length?i.publications.list():i.publications.list((function(e){return e.name.includes(u)})),x=function(){var e=(0,S.Z)(P().mark((function e(t,n,r){var a;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=r?"stop":"start",(0,Ee._)({title:"Confirm",message:"Are you sure you want to ".concat(a," sending ").concat(n," events for ").concat(t.name,"?"),onAsyncConfirm:function(){var e=(0,S.Z)(P().mark((function e(){var a,c,o,l;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(a={id:t.id})["publish_".concat(n)]=!r,e.next=5,i.publications.update(t.id,a);case 5:if(c=e.sent,o=c.data,!(l=c.error)){e.next=12;break}throw l;case 12:return e.abrupt("return",o);case 13:e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(0),s.setNotification({category:"error",message:"Failed to toggle for ".concat(t.name,": ").concat(e.t0.message)}),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}()});case 2:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"mb-4",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsx)("div",{className:"flex items-center",children:(0,w.jsx)(o.Z,{size:"small",icon:(0,w.jsx)(l.Z,{size:"tiny"}),placeholder:"Filter",value:u,onChange:function(e){return m(e.target.value)}})}),!p&&(0,w.jsx)("div",{className:"w-[500px]",children:(0,w.jsx)(ce.Z,{icon:(0,w.jsx)(ne.Z,{className:"text-scale-1100",strokeWidth:2}),title:"You need additional permissions to update database replications"})})]})}),0===f.length?(0,w.jsx)(ee.Z,{searchString:u,onResetFilter:function(){return m("")}}):(0,w.jsx)("div",{className:"overflow-hidden rounded",children:(0,w.jsx)(g.Z,{head:[(0,w.jsx)(g.Z.th,{children:"Name"},"header.name"),(0,w.jsx)(g.Z.th,{className:"hidden lg:table-cell",children:"System ID"},"header.id"),(0,w.jsx)(g.Z.th,{children:"Insert"},"header.insert"),(0,w.jsx)(g.Z.th,{children:"Update"},"header.update"),(0,w.jsx)(g.Z.th,{children:"Delete"},"header.delete"),(0,w.jsx)(g.Z.th,{children:"Truncate"},"header.truncate"),(0,w.jsx)(g.Z.th,{className:"text-right",children:"Source"},"header.source")],body:f.map((function(e,t){return(0,w.jsxs)(g.Z.tr,{className:"border-t ",children:[(0,w.jsx)(g.Z.td,{className:"px-4 py-3",style:{width:"25%"},children:e.name}),(0,w.jsx)(g.Z.td,{className:"hidden lg:table-cell",style:{width:"25%"},children:e.id}),h.map((function(t){return(0,w.jsx)(g.Z.td,{children:(0,w.jsx)(q.Z,{size:"tiny",checked:e[t.key],disabled:!p,onChange:function(){return x(e,t.event.toLowerCase(),e[t.key])}})},t.key)})),(0,w.jsx)(g.Z.td,{className:"px-4 py-3 pr-2",children:(0,w.jsx)("div",{className:"flex justify-end gap-2",children:(0,w.jsx)(d.z,{type:"default",style:{paddingTop:3,paddingBottom:3},onClick:function(){return n(e.id)},children:null==e.tables?"All tables":"".concat(e.tables.length," ").concat(e.tables.length>1||0==e.tables.length?"tables":"table")})})})]},e.name)}))})})]})})),Pt=(0,s.Pi)((function(e){var t,n=e.table,r=e.selectedPublication,s=(0,j.oR)(),i=s.ui,c=s.meta,o=null==r.tables,l=(0,a.useState)(!1),d=l[0],u=l[1],m=(0,a.useState)(void 0!=(null===(t=r.tables)||void 0===t?void 0:t.find((function(e){return e.id==n.id})))),p=m[0],h=m[1],f=(0,j.FH)(b.KA.TENANT_SQL_ADMIN_WRITE,"publications"),x=function(){var e=(0,S.Z)(P().mark((function e(t,n){var r,a,s,o,l,d,m,f,x;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=p,h(!p),u(!0),s=null!==(r=null===n||void 0===n?void 0:n.tables)&&void 0!==r?r:[],o=s.some((function(e){return e.id==t.id})),l=o?s.filter((function(e){return e.id!=t.id})).map((function(e){return"".concat(e.schema,".").concat(e.name)})):["".concat(t.schema,".").concat(t.name)].concat(s.map((function(e){return"".concat(e.schema,".").concat(e.name)}))),e.prev=6,d=n.id,m={tables:l,id:d},e.next=11,c.publications.update(d,m);case 11:if(f=e.sent,!(x=f.error)){e.next=15;break}throw x;case 15:u(!1),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(6),i.setNotification({category:"error",message:"Failed to toggle replication for ".concat(t.name,": ").concat(e.t0.message)}),h(a),u(!1);case 23:case"end":return e.stop()}}),e,null,[[6,18]])})));return function(t,n){return e.apply(this,arguments)}}();return(0,w.jsxs)(g.Z.tr,{children:[(0,w.jsx)(g.Z.td,{className:"whitespace-nowrap",children:n.name}),(0,w.jsx)(g.Z.td,{className:"whitespace-nowrap",children:n.schema}),(0,w.jsx)(g.Z.td,{className:"hidden max-w-sm truncate whitespace-nowrap lg:table-cell",children:n.comment}),(0,w.jsx)(g.Z.td,{className:"px-4 py-3 pr-2",children:(0,w.jsx)("div",{className:"flex justify-end gap-2",children:o?(0,w.jsxs)(F.Z,{color:"scale",children:[(0,w.jsx)("span",{children:"Enabled"}),(0,w.jsx)("span",{className:"hidden lg:inline-block",children:"\xa0for all tables"})]}):(0,w.jsx)(q.Z,{size:"tiny",align:"right",disabled:!f||d,className:"m-0 ml-2 mt-1 -mb-1 p-0",checked:p,onChange:function(){return x(n,r)}})})})]},n.id)})),Et=(0,s.Pi)((function(e){var t=e.selectedPublication,n=e.onSelectBack,r=(0,j.oR)().meta,s=(0,a.useState)(""),i=s[0],c=s[1],u=(0,j.FH)(b.KA.TENANT_SQL_ADMIN_WRITE,"publications"),m=0===i.length?r.tables.list((function(e){return!r.excludedSchemas.includes(e.schema)})):r.tables.list((function(e){return!r.excludedSchemas.includes(e.schema)&&e.name.includes(i)}));return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"mb-4",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,w.jsx)(d.z,{type:"outline",onClick:function(){return n()},icon:(0,w.jsx)(k.Z,{}),style:{padding:"5px"}}),(0,w.jsx)("div",{children:(0,w.jsx)(o.Z,{size:"small",placeholder:"Filter",value:i,onChange:function(e){return c(e.target.value)},icon:(0,w.jsx)(l.Z,{size:"tiny"})})})]}),!u&&(0,w.jsx)("div",{className:"w-[500px]",children:(0,w.jsx)(ce.Z,{icon:(0,w.jsx)(ne.Z,{className:"text-scale-1100",strokeWidth:2}),title:"You need additional permissions to update database replications"})})]})}),0===m.length?(0,w.jsx)(y.Z,{}):(0,w.jsx)("div",{children:(0,w.jsx)(g.Z,{head:[(0,w.jsx)(g.Z.th,{children:"Name"},"header-name"),(0,w.jsx)(g.Z.th,{children:"Schema"},"header-schema"),(0,w.jsx)(g.Z.th,{className:"hidden text-left lg:table-cell",children:"Description"},"header-desc"),(0,w.jsx)(g.Z.th,{},"header-all")],body:m.map((function(e,n){return(0,w.jsx)(Pt,{table:e,selectedPublication:t},e.id)}))})})]})})),Ft=n(69497),zt=n(96423),Dt=n(27693),Tt=n.n(Dt),Rt=n(65194),It=n(14919),At=(0,s.Pi)((function(e){var t,n,r=e.projectRef,s=e.backup,i=e.index,c=(0,Ae.useRouter)(),o=(0,j.oR)(),l=o.app,u=o.ui,m=(0,a.useState)(!1),p=m[0],h=m[1],f=(0,a.useState)(!1),x=f[0],v=f[1],g=null!==(t=null===(n=u.selectedProject)||void 0===n?void 0:n.id)&&void 0!==t?t:-1,y=(0,j.FH)(b.KA.INFRA_EXECUTE,"queue_job.restore.prepare");function N(e){return Z.apply(this,arguments)}function Z(){return Z=(0,S.Z)(P().mark((function e(t){return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v(!0);try{(0,It.v_)("".concat(he.T5,"/database/").concat(r,"/backups/restore"),t).then((function(){setTimeout((function(){l.onProjectStatusUpdated(g,he.S.RESTORING),u.setNotification({category:"success",message:"Restoring database back to ".concat(Tt()(t.inserted_at).format("DD MMM YYYY HH:mm:ss"))}),c.push("/project/".concat(r))}),3e3)}))}catch(n){u.setNotification({error:n,category:"error",message:"You do not have permission to restore from this backup"}),v(!1)}case 2:case"end":return e.stop()}}),e)}))),Z.apply(this,arguments)}function k(){return k=(0,S.Z)(P().mark((function e(t){var n,a,s,i;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.prev=1,e.next=4,(0,It.v_)("".concat(he.T5,"/database/").concat(r,"/backups/download"),t);case 4:return n=e.sent,e.next=7,n;case 7:a=e.sent,s=a.fileUrl,(i=document.createElement("a")).href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),h(!1),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(1),u.setNotification({error:e.t0,category:"error",message:"You do not have permission to download this backup"}),h(!1);case 21:case"end":return e.stop()}}),e,null,[[1,17]])}))),k.apply(this,arguments)}function _(){(0,Ee._)({title:"Confirm to restore",message:"Are you sure you want to restore from ".concat(Tt()(s.inserted_at).format("DD MMM YYYY"),"? This will destroy any new data written since this backup was made."),onAsyncConfirm:function(){var e=(0,S.Z)(P().mark((function e(){return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(s);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})}return(0,w.jsxs)("div",{className:"flex h-12 items-center justify-between px-6 ".concat(i?"border-t dark:border-dark":""),children:[(0,w.jsx)("p",{className:"text-sm text-scale-1200 ",children:Tt()(s.inserted_at).format("DD MMM YYYY HH:mm:ss")}),(0,w.jsx)("div",{className:"",children:function(e){return"COMPLETED"===e.status?(0,w.jsxs)("div",{className:"flex space-x-4",children:[e.data.canRestore&&(0,w.jsx)(d.z,{type:"default",disabled:!y||x||p,onClick:_,children:"Restore"}),(0,w.jsx)(d.z,{type:"default",disabled:!y||x||p,onClick:function(){return function(e){return k.apply(this,arguments)}(e)},loading:p,icon:(0,w.jsx)(Rt.Z,{}),children:"Download"})]}):(0,w.jsx)(F.Z,{color:"yellow",children:"Backup In Progress..."})}(s)})]})})),Vt=n(84427),Lt=n(33944),Wt=n(43881),qt=(0,s.Pi)((function(e){var t,n;(0,O.Z)(e);var r=(0,j.oR)(),a=r.ui,s=r.backups,i=(null===(t=a.selectedProject)||void 0===t?void 0:t.ref)||"default",c=(0,j.FH)(b.KA.INFRA_EXECUTE,"queue_job.restore.prepare"),o=null===s||void 0===s||null===(n=s.configuration)||void 0===n?void 0:n.walg_enabled;if(s.isLoading)return(0,w.jsx)(kt.Z,{});if(s.error)return(0,w.jsx)(Vt.Z,{});var l=s.configuration.tierKey,d=s.list();return"FREE"===l?(0,w.jsx)(Ft.Z,{icon:(0,w.jsx)(Wt.Z,{size:"large"}),primaryText:"Free Plan does not include project backups.",projectRef:i,secondaryText:"Upgrade to the Pro plan for up to 7 days of scheduled backups."}):(0,w.jsx)("div",{className:"space-y-6",children:null!==d&&void 0!==d&&d.length||"FREE"===l?(0,w.jsxs)(w.Fragment,{children:[!c&&(0,w.jsx)(ce.Z,{icon:(0,w.jsx)(ne.Z,{className:"text-scale-1100",strokeWidth:2}),title:"You need additional permissions to trigger a scheduled backup"}),(0,w.jsx)(zt.Z,{children:null===d||void 0===d?void 0:d.map((function(e,t){return(0,w.jsx)(At,{projectRef:i,backup:e,index:t},e.id)}))})]}):o?(0,w.jsx)(w.Fragment,{}):(0,w.jsx)(Lt.Z,{})})})),Mt=(n(8178),n(43350)),Yt=n(80040),Ut=n(79588),Bt=n(90907),Ht=n(93359),Kt=n(35548),Qt=n(12163);function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Jt=function(e){return(0,w.jsx)(Qt.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){(0,T.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:Kt.Z},e))},$t=n(49077),Xt=n(38480),en=n(30335),tn=n(51664),nn=n(78906),rn=n(89744),an=function(){function e(){(0,Mt.Z)(this,e),(0,T.Z)(this,"triggerFunctions",[])}return(0,Yt.Z)(e,[{key:"functionSchemas",get:function(){return(0,x.map)((0,x.uniqBy)(this.triggerFunctions,"schema"),"schema")}}]),e}(),sn=(0,a.createContext)(null),cn=(0,s.Pi)((function(e){var t=e.triggerFunctions,n=e.visible,r=e.onChange,a=e.setVisible,i=(0,s.fv)((function(){return new an}));function c(e){r(e),a(!n)}i.triggerFunctions=t;var o=i.triggerFunctions.length>=1;return(0,w.jsx)(G.ZP,{size:"large",header:"Pick a function",visible:n,onCancel:function(){return a(!n)},className:"hooks-sidepanel",children:(0,w.jsx)("div",{className:"py-6",children:o?(0,w.jsx)(sn.Provider,{value:i,children:(0,w.jsxs)("div",{className:"space-y-6",children:[(0,w.jsx)(on,{}),i.functionSchemas.map((function(e){return(0,w.jsx)(dn,{schema:e,selectFunction:c},e)}))]})}):(0,w.jsx)(ln,{})})})})),on=function(e){(0,O.Z)(e);var t=(0,Ae.useRouter)(),n=t.query.ref;return(0,w.jsx)("div",{className:"px-6",children:(0,w.jsx)(ce.Z,{icon:(0,w.jsx)(M.Z,{size:"large",strokeWidth:1.5}),title:"Only functions that return a trigger will be displayed below",description:"You can make functions by using the Database Functions",button:(0,w.jsx)(d.z,{type:"default",onClick:function(){t.push("/project/".concat(n,"/database/functions"))},children:"Go to Functions"})})})},ln=function(e){(0,O.Z)(e);var t=(0,Ae.useRouter)(),n=t.query.ref;return(0,w.jsx)(rn.Z,{title:"No Trigger Functions found in database",ctaButtonLabel:"Create a trigger function",onClickCta:function(){t.push("/project/".concat(n,"/database/functions"))},children:(0,w.jsx)("p",{className:"text-sm text-scale-1100",children:"You will need to create a trigger based function before you can add it to your trigger."})})},dn=(0,s.Pi)((function(e){var t=e.schema,n=e.selectFunction,r=(0,a.useContext)(sn).triggerFunctions.filter((function(e){return e.schema==t}));return(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsxs)("div",{className:"sticky top-0 flex items-center space-x-1 px-6 backdrop-blur backdrop-filter",children:[(0,w.jsx)("h5",{className:"text-scale-1000",children:"schema"}),(0,w.jsx)("h5",{children:t})]}),(0,w.jsx)("div",{className:"space-y-0 divide-y border-t border-b dark:divide-dark dark:border-dark",children:r.map((function(e){return(0,w.jsx)(un,{id:e.id,completeStatement:e.complete_statement,name:e.name,onClick:n},e.id)}))})]})})),un=function(e){var t=e.id,n=e.completeStatement,r=e.name,s=e.onClick,i=(0,a.useState)(!1),c=i[0],o=i[1];return(0,w.jsxs)("div",{className:"cursor-pointer rounded p-3 px-6 hover:bg-scale-200 dark:hover:bg-scale-200",onClick:function(){return s(t)},children:[(0,w.jsxs)("div",{className:"flex items-center justify-between space-x-3",children:[(0,w.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,w.jsx)("div",{className:"flex items-center justify-center rounded bg-scale-1200 p-1 text-scale-100 ",children:(0,w.jsx)($t.Z,{strokeWidth:2,size:14})}),(0,w.jsx)("p",{className:"mb-0 text-sm",children:r})]}),(0,w.jsx)(d.z,{type:"text",onClick:function(e){e.stopPropagation(),o(!c)},icon:(0,w.jsx)(tn.Z,{className:c?"rotate-180 transform":"rotate-0 transform"}),children:c?"Hide definition":"View definition"})]}),(0,w.jsx)(en.u,{show:c,enter:"transition ease-out duration-300",enterFrom:"transform opacity-0",enterTo:"transform opacity-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100",leaveTo:"transform opacity-0",children:(0,w.jsx)("div",{className:"mt-4 h-64 border dark:border-dark",children:(0,w.jsx)(nn.Z,{defaultValue:n,readOnly:!0,contextmenu:!1})})})]})},mn=function(e){var t=e.icon,n=e.text;return(0,w.jsxs)("div",{className:"flex items-center justify-center flex-row py-4 space-x-2",children:[(0,w.jsx)("div",{className:"relative bg-scale-300 text-scale-900 w-6 h-6 rounded-full flex items-center justify-center",children:t}),(0,w.jsx)("p",{className:"text-scale-1000",children:n})]})},pn=n(95439);function hn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hn(Object(n),!0).forEach((function(t){(0,T.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xn=function(){function e(){(0,Mt.Z)(this,e),(0,T.Z)(this,"id",void 0),(0,T.Z)(this,"originalName",void 0),(0,T.Z)(this,"activation",void 0),(0,T.Z)(this,"enabledMode",void 0),(0,T.Z)(this,"events",void 0),(0,T.Z)(this,"functionName",void 0),(0,T.Z)(this,"functionSchema",void 0),(0,T.Z)(this,"orientation",void 0),(0,T.Z)(this,"name",void 0),(0,T.Z)(this,"schema",void 0),(0,T.Z)(this,"table",void 0),(0,T.Z)(this,"tableId",void 0),(0,Ut.ky)(this),this.reset()}return(0,Yt.Z)(e,[{key:"requestBody",get:function(){return{id:this.id,activation:this.activation.value,enabled_mode:this.enabledMode.value,events:this.events.value,function_name:this.functionName.value,function_schema:this.functionSchema.value,orientation:this.orientation.value,name:this.name.value,schema:this.schema.value,table:this.table.value}}},{key:"reset",value:function(e){var t,n,r,a,s,i,c,o,l,d;this.id=null===e||void 0===e?void 0:e.id,this.originalName=null===e||void 0===e?void 0:e.name,this.activation={value:null!==(t=null===e||void 0===e?void 0:e.activation)&&void 0!==t?t:"BEFORE"},this.enabledMode={value:null!==(n=null===e||void 0===e?void 0:e.enabled_mode)&&void 0!==n?n:"ORIGIN"},this.events={value:null!==(r=null===e||void 0===e?void 0:e.events)&&void 0!==r?r:[]},this.functionName={value:null!==(a=null===e||void 0===e?void 0:e.function_name)&&void 0!==a?a:""},this.functionSchema={value:null!==(s=null===e||void 0===e?void 0:e.function_schema)&&void 0!==s?s:""},this.orientation={value:null!==(i=null===e||void 0===e?void 0:e.orientation)&&void 0!==i?i:"STATEMENT"},this.name={value:null!==(c=null===e||void 0===e?void 0:e.name)&&void 0!==c?c:""},this.schema={value:null!==(o=null===e||void 0===e?void 0:e.schema)&&void 0!==o?o:""},this.table={value:null!==(l=null===e||void 0===e?void 0:e.table)&&void 0!==l?l:""},this.tableId={value:null!==(d=null===e||void 0===e?void 0:e.table_id)&&void 0!==d?d:""}}},{key:"update",value:function(e){this.activation=e.activation,this.enabledMode=e.enabledMode,this.events=e.events,this.functionName=e.functionName,this.functionSchema=e.functionSchema,this.orientation=e.orientation,this.name=e.name,this.schema=e.schema,this.table=e.table,this.tableId=e.tableId}}]),e}(),vn=function(){function e(){var t=this;(0,Mt.Z)(this,e),(0,T.Z)(this,"chooseFunctionFormVisible",!1),(0,T.Z)(this,"loading",!1),(0,T.Z)(this,"formState",new xn),(0,T.Z)(this,"meta",null),(0,T.Z)(this,"tables",[]),(0,T.Z)(this,"triggerFunctions",[]),(0,T.Z)(this,"setChooseFunctionFormVisible",(function(e){t.chooseFunctionFormVisible=e})),(0,T.Z)(this,"setDefaultSelectedTable",(function(){var e;0!=(null===(e=t.tables)||void 0===e?void 0:e.length)&&(t.formState.table.value=t.tables[0].name,t.formState.schema.value=t.tables[0].schema,t.formState.tableId.value=t.tables[0].id)})),(0,T.Z)(this,"setLoading",(function(e){t.loading=e})),(0,T.Z)(this,"setTables",(function(e){t.tables=e,t.setDefaultSelectedTable()})),(0,T.Z)(this,"setTriggerFunctions",(function(e){t.triggerFunctions=e})),(0,T.Z)(this,"onFormChange",(function(e){var n=e.key,r=e.value;if((0,x.has)(t.formState,n)){var a=t.formState[n];t.formState[n]=fn(fn({},a),{},{value:r,error:void 0})}else t.formState[n]={value:r}})),(0,T.Z)(this,"onSelectFunction",(function(e){var n=t.triggerFunctions.find((function(t){return t.id==e}));n&&(t.formState.functionName.value=n.name,t.formState.functionSchema.value=n.schema)})),(0,T.Z)(this,"validateForm",(function(){var e=!0,n=(0,x.mapValues)(t.formState,(function(t,n){switch(n){case"name":return(0,x.isEmpty)(t.value)||(r=t.value,/\s/.test(r))?(e=!1,fn(fn({},t),{},{error:"Invalid trigger name"})):t;case"activation":return(0,x.isEmpty)(t.value)?(e=!1,fn(fn({},t),{},{error:"you have an error"})):t;case"events":return(0,x.isEmpty)(t.value)?(e=!1,fn(fn({},t),{},{error:"Select at least 1 event"})):t;case"tableId":return(0,x.isEmpty)("".concat(t.value))?(e=!1,fn(fn({},t),{},{error:"You must choose a table"})):t;default:return t}var r}));return e||t.formState.update(n),e})),(0,Ut.ky)(this)}return(0,Yt.Z)(e,[{key:"selectedFunction",get:function(){var e=this;return this.triggerFunctions.find((function(t){return t.name==e.formState.functionName.value&&t.schema==e.formState.functionSchema.value}))}},{key:"title",get:function(){return this.formState.id?"Edit '".concat(this.formState.originalName,"' trigger"):"Add a new Trigger"}},{key:"isEditing",get:function(){return void 0!=this.formState.id}}]),e}();var bn=(0,a.createContext)(null),jn=(0,s.Pi)((function(e){var t=e.trigger,n=e.visible,r=e.setVisible,i=(0,j.oR)(),c=i.ui,o=i.meta,l=(0,s.fv)((function(){return new vn}));l.meta=o;(0,Ae.useRouter)().query.ref;function d(){return(d=(0,S.Z)(P().mark((function e(){var t,a,s,i;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!l.validateForm()){e.next=15;break}if(l.setLoading(!0),t=l.formState.requestBody,!l.isEditing){e.next=10;break}return e.next=7,l.meta.triggers.update(t.id,t);case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,l.meta.triggers.create(t);case 12:e.t0=e.sent;case 13:(a=e.t0).error?(c.setNotification({category:"error",message:"Failed to create trigger: ".concat(null!==(s=null===(i=a.error)||void 0===i?void 0:i.message)&&void 0!==s?s:"submit request failed")}),l.setLoading(!1)):(c.setNotification({category:"success",message:"".concat(l.isEditing?"Updated":"Created new"," trigger called ").concat(a.name)}),l.setLoading(!1),r(!n));case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(0),c.setNotification({category:"error",message:"Filed to create trigger: ".concat(e.t1.message)}),l.setLoading(!1);case 21:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}(0,a.useEffect)((function(){var e=function(){var e=(0,S.Z)(P().mark((function e(){var t;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.meta.tables.load();case 2:t=l.meta.tables.list(),l.setTables(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=(0,S.Z)(P().mark((function e(){var t;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.meta.functions.load();case 2:t=l.meta.functions.listTriggerFunctions(),l.setTriggerFunctions(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),t()}),[]),(0,a.useEffect)((function(){t?l.formState.reset(t):(l.formState.reset(),l.setDefaultSelectedTable())}),[n,t]);var u=l.tables.length>=1;return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(G.ZP,{size:"large",visible:n,onCancel:function(){return r(!n)},header:l.title,hideFooter:!u,className:l.chooseFunctionFormVisible?"hooks-sidepanel mr-16 transform transition-all duration-300 ease-in-out":"hooks-sidepanel mr-0 transform transition-all duration-300 ease-in-out",loading:l.loading,onConfirm:function(){return d.apply(this,arguments)},children:u?(0,w.jsx)("div",{className:"",children:(0,w.jsxs)(bn.Provider,{value:l,children:[(0,w.jsx)("div",{className:"my-6 space-y-10",children:l.isEditing?(0,w.jsxs)("div",{className:"space-y-6 px-6",children:[(0,w.jsx)(gn,{}),(0,w.jsx)(yn,{})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"px-6",children:(0,w.jsx)(gn,{})}),(0,w.jsx)(G.ZP.Separator,{}),(0,w.jsxs)("div",{className:"space-y-12 px-6",children:[(0,w.jsx)("h5",{children:"Conditions to fire trigger"}),(0,w.jsx)(wn,{}),(0,w.jsx)(Zn,{}),(0,w.jsx)(kn,{}),(0,w.jsx)(Nn,{})]}),(0,w.jsx)(G.ZP.Separator,{}),(0,w.jsx)(_n,{})]})}),(0,w.jsx)(cn,{triggerFunctions:l.triggerFunctions,visible:l.chooseFunctionFormVisible,setVisible:l.setChooseFunctionFormVisible,onChange:function(e){return l.onSelectFunction(e)}})]})}):(0,w.jsx)(pn.Z,{message:"You will need to create a table first before you can make a trigger"})})})})),gn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(bn);return(0,w.jsx)(o.Z,{id:"name",label:"Name of trigger",layout:"horizontal",placeholder:"Name of trigger",value:t.formState.name.value,onChange:function(e){return t.onFormChange({key:"name",value:e.target.value})},size:"small",error:t.formState.name.error,descriptionText:"The name is also stored as the actual postgres name of the trigger. Do not use spaces/whitespace."})})),yn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(bn);return(0,w.jsxs)(i.Z,{id:"enabled-mode",label:"Enabled mode",layout:"horizontal",value:t.formState.enabledMode.value,onChange:function(e){return t.onFormChange({key:"enabledMode",value:e})},size:"small",descriptionText:"Determines if a trigger should or should not fire. Can also be used to disable a trigger, but not delete it.",children:[(0,w.jsxs)(i.Z.Option,{addOnBefore:function(e){e.active,e.selected;return(0,w.jsx)("div",{className:"h-3 w-3 rounded-full border border-green-700 bg-green-900 shadow-sm"})},value:"ORIGIN",label:"Origin",children:["Origin",(0,w.jsx)("span",{className:"block text-scale-900",children:"This is a default behaviour"})]}),(0,w.jsxs)(i.Z.Option,{addOnBefore:function(e){e.active,e.selected;return(0,w.jsx)("div",{className:"h-3 w-3 rounded-full border border-green-700 bg-green-900 shadow-sm"})},value:"REPLICA",label:"Replica",children:["Replica",(0,w.jsx)("span",{className:"block text-scale-900",children:"Will only fire if the session is in \u201creplica\u201d mode"})]}),(0,w.jsxs)(i.Z.Option,{addOnBefore:function(e){e.active,e.selected;return(0,w.jsx)("div",{className:"h-3 w-3 rounded-full border border-green-700 bg-green-900 shadow-sm"})},value:"ALWAYS",label:"Always",children:["Always",(0,w.jsx)("span",{className:"block text-scale-900",children:"Will fire regardless of the current replication role"})]}),(0,w.jsxs)(i.Z.Option,{addOnBefore:function(e){e.active,e.selected;return(0,w.jsx)("div",{className:"h-3 w-3 rounded-full border border-red-700 bg-red-900 shadow-sm"})},value:"DISABLED",label:"Disabled",children:["Disabled",(0,w.jsx)("span",{className:"block text-scale-900",children:"Will not fire"})]})]})})),Nn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(bn);return(0,w.jsxs)(i.Z,{id:"orientation",label:"Orientation",layout:"horizontal",value:t.formState.orientation.value,onChange:function(e){return t.onFormChange({key:"orientation",value:e})},size:"small",descriptionText:"Identifies whether the trigger fires once for each processed row or once for each statement",children:[(0,w.jsxs)(i.Z.Option,{value:"ROW",label:"Row",children:["Row",(0,w.jsx)("span",{className:"block text-scale-900",children:"fires once for each processed row"})]}),(0,w.jsxs)(i.Z.Option,{value:"STATEMENT",label:"Statement",children:["Statement",(0,w.jsx)("span",{className:"block text-scale-900",children:"fires once for each statement"})]})]})})),wn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(bn);return(0,w.jsx)(i.Z,{id:"table",label:"Table",layout:"horizontal",value:t.formState.tableId.value,onChange:function(e){var n=t.tables.find((function(t){return t.id===e}));n&&(t.onFormChange({key:"table",value:n.name}),t.onFormChange({key:"schema",value:n.schema}),t.onFormChange({key:"tableId",value:e}))},size:"small",error:t.formState.tableId.error,descriptionText:"This is the table the trigger will watch for changes. You can only select 1 table for a trigger.",children:t.tables.map((function(e){return(0,w.jsx)(i.Z.Option,{id:e.id,value:e.id,label:e.name,addOnBefore:function(){return(0,w.jsx)("div",{className:"flex items-center justify-center rounded bg-scale-1200 p-1 text-scale-100 ",children:(0,w.jsx)(Xt.Z,{src:"".concat(he.GW,"/img/table-editor.svg"),style:{width:"16px",height:"16px",strokeWidth:"1px"},preProcessor:function(e){return e.replace(/svg/,'svg class="m-auto text-color-inherit"')}})})},children:(0,w.jsxs)("div",{className:"flex flex-row items-center space-x-1",children:[(0,w.jsx)("p",{children:e.name}),(0,w.jsx)("p",{className:"text-sm text-scale-1000",children:e.schema})]})},e.id)}))})})),Zn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(bn);return(0,w.jsxs)(Bt.Z.Group,{name:"events",label:"Events",id:"events",labelOptional:"The type of events that will trigger your trigger",layout:"horizontal",descriptionText:"These are the events that are watched by the trigger, only the events selected above will fire the trigger on the table you've selected.",size:"small",onChange:function(e){var n=t.formState.events.value,r=e.target.checked?(0,x.union)(n,[e.target.value]):(0,x.without)(n,e.target.value);t.onFormChange({key:"events",value:r})},error:t.formState.events.error,children:[(0,w.jsx)(Bt.Z,{value:"INSERT",label:"Insert",description:"Any insert operation on the table",checked:t.formState.events.value.includes("INSERT")}),(0,w.jsx)(Bt.Z,{value:"UPDATE",label:"Update",description:"Any update operation, of any column in the table",checked:t.formState.events.value.includes("UPDATE")}),(0,w.jsx)(Bt.Z,{value:"DELETE",label:"Delete",description:"Any deletion of a record",checked:t.formState.events.value.includes("DELETE")})]})})),kn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(bn);return(0,w.jsxs)(i.Z,{id:"activation",label:"Trigger type",descriptionText:"This determines when your Hook fires",onChange:function(e){t.onFormChange({key:"activation",value:e})},value:t.formState.activation.value,layout:"horizontal",size:"small",error:t.formState.activation.error,children:[(0,w.jsx)(i.Z.Option,{id:"before",value:"BEFORE",label:"Before the event",addOnBefore:function(){return(0,w.jsx)("div",{className:"flex  items-center justify-center rounded bg-scale-1200 p-1 text-scale-100 ",children:(0,w.jsx)(Ht.Z,{strokeWidth:2,size:"small"})})},children:(0,w.jsxs)("div",{className:"flex flex-col",children:[(0,w.jsx)("span",{children:"before"}),(0,w.jsx)("span",{className:"block text-scale-900",children:"Trigger fires before the operation is attempted"})]})}),(0,w.jsx)(i.Z.Option,{id:"after",value:"AFTER",label:"After the event",addOnBefore:function(){return(0,w.jsx)("div",{className:"flex  items-center justify-center rounded bg-green-1200 p-1 text-scale-100 ",children:(0,w.jsx)(Jt,{strokeWidth:2,size:"small"})})},children:(0,w.jsxs)("div",{className:"flex flex-col",children:[(0,w.jsx)("span",{children:"after"}),(0,w.jsx)("span",{className:"block text-scale-900",children:"Trigger fires after the operation has completed"})]})})]})})),_n=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(bn);return(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsx)("div",{className:"space-y-6 px-6",children:(0,w.jsx)("h5",{children:"Function to trigger"})}),(0,w.jsx)("div",{className:"px-6",children:(0,x.isEmpty)(t.formState.functionName.value)?(0,w.jsx)(Sn,{}):(0,w.jsx)(On,{})})]})})),Sn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(bn);return(0,w.jsx)("button",{type:"button",onClick:function(){return t.setChooseFunctionFormVisible(!0)},className:"relative w-full rounded border border-scale-600 bg-scale-200 px-5 py-1 shadow-sm transition-all hover:border-scale-700 hover:bg-scale-300 dark:bg-scale-400 dark:hover:bg-scale-500 ",children:(0,w.jsx)(mn,{icon:(0,w.jsx)($t.Z,{size:14,strokeWidth:2}),text:"Choose a function to trigger"})})})),On=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(bn);return(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)("div",{className:" relative flex w-full items-center justify-between space-x-3 rounded border border-scale-200 px-5 py-4 shadow-sm transition-shadow dark:border-scale-500",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded bg-scale-1200 text-scale-100 focus-within:bg-opacity-10",children:(0,w.jsx)($t.Z,{size:"small",strokeWidth:2,width:14})}),(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("p",{className:"text-scale-1000",children:t.formState.functionName.value}),(0,w.jsx)("div",{children:(0,w.jsx)(F.Z,{children:t.formState.functionSchema.value})})]})]}),(0,w.jsx)(d.z,{type:"default",onClick:function(){return t.setChooseFunctionFormVisible(!0)},children:"Change function"})]})})})),Cn=n(44198),Pn=(0,s.Pi)((function(e){e.store;var t=e.trigger,n=e.visible,r=e.setVisible,s=(0,j.oR)(),i=s.ui,c=s.meta,o=(0,a.useState)(!1),l=o[0],d=o[1],u=null!==t&&void 0!==t?t:{},m=u.id,p=u.name,h=u.schema;function f(){return(f=(0,S.Z)(P().mark((function e(){var t;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,d(!0),m){e.next=4;break}throw Error("Invalid trigger info");case 4:return e.next=6,c.triggers.del(m);case 6:if(!(t=e.sent).error){e.next=11;break}throw t.error;case 11:i.setNotification({category:"success",message:"Successfully removed ".concat(p)}),r(!1);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),i.setNotification({category:"error",message:"Failed to delete ".concat(p,": ").concat(e.t0.message)});case 18:return e.prev=18,d(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[0,15,18,21]])})))).apply(this,arguments)}return(0,w.jsx)(Cn.Z,{visible:n,onCancel:function(){return r(!n)},onConfirm:function(){return f.apply(this,arguments)},title:"Delete this trigger",loading:l,confirmLabel:"Delete trigger ".concat(p),confirmPlaceholder:"Type in name of trigger",confirmString:p,text:"This will delete your trigger called ".concat(p," of schema ").concat(h,"."),alert:"You cannot recover this trigger once it is deleted!"})})),En=n(84954),Fn=n(53797),zn=n(63840);function Dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dn(Object(n),!0).forEach((function(t){(0,T.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Rn=function(){function e(){(0,Mt.Z)(this,e),(0,T.Z)(this,"id",void 0),(0,T.Z)(this,"originalName",void 0),(0,T.Z)(this,"args",void 0),(0,T.Z)(this,"behavior",void 0),(0,T.Z)(this,"configParams",void 0),(0,T.Z)(this,"definition",void 0),(0,T.Z)(this,"language",void 0),(0,T.Z)(this,"name",void 0),(0,T.Z)(this,"returnType",void 0),(0,T.Z)(this,"schema",void 0),(0,T.Z)(this,"securityDefiner",void 0),(0,Ut.ky)(this),this.reset()}return(0,Yt.Z)(e,[{key:"requestBody",get:function(){return{id:this.id,name:this.name.value,schema:this.schema.value,definition:this.definition.value,return_type:this.returnType.value,language:this.language.value,behavior:this.behavior.value,security_definer:this.securityDefiner.value,args:this.args.value.map((function(e){return"".concat(e.name," ").concat(e.type)})),config_params:(0,x.mapValues)((0,x.keyBy)(this.configParams.value,"name"),"value")}}},{key:"reset",value:function(e){var t,n,r,a,s,i,c;this.id=null===e||void 0===e?void 0:e.id,this.originalName=null===e||void 0===e?void 0:e.name,this.args=function(e){var t=null===e||void 0===e?void 0:e.split(",");return(0,x.isEmpty)(e)||!t||0==(null===t||void 0===t?void 0:t.length)?{value:[]}:{value:t.map((function(e){var t=e.trim(),n=t.indexOf(" ");return{name:t.slice(0,1!==n?n:0),type:t.slice(n+1)}}))}}(null===e||void 0===e?void 0:e.argument_types),this.behavior={value:null!==(t=null===e||void 0===e?void 0:e.behavior)&&void 0!==t?t:"VOLATILE"},this.configParams=function(e){var t=[];if(e)for(var n in e)t.push({name:n,value:e[n]});return{value:t}}(null===e||void 0===e?void 0:e.config_params),this.definition={value:null!==(n=null===e||void 0===e?void 0:e.definition)&&void 0!==n?n:""},this.language={value:null!==(r=null===e||void 0===e?void 0:e.language)&&void 0!==r?r:"plpgsql"},this.name={value:null!==(a=null===e||void 0===e?void 0:e.name)&&void 0!==a?a:""},this.returnType={value:null!==(s=null===e||void 0===e?void 0:e.return_type)&&void 0!==s?s:"void"},this.schema={value:null!==(i=null===e||void 0===e?void 0:e.schema)&&void 0!==i?i:"public"},this.securityDefiner={value:null!==(c=null===e||void 0===e?void 0:e.security_definer)&&void 0!==c&&c}}},{key:"update",value:function(e){this.args=e.args,this.behavior=e.behavior,this.configParams=e.configParams,this.definition=e.definition,this.language=e.language,this.name=e.name,this.returnType=e.returnType,this.schema=e.schema,this.securityDefiner=e.securityDefiner}}]),e}();var In=function(){function e(){var t=this;(0,Mt.Z)(this,e),(0,T.Z)(this,"loading",!1),(0,T.Z)(this,"formState",new Rn),(0,T.Z)(this,"meta",null),(0,T.Z)(this,"schemas",[]),(0,T.Z)(this,"advancedVisible",!1),(0,T.Z)(this,"isDirty",!1),(0,T.Z)(this,"toggleAdvancedVisible",(function(){t.advancedVisible=!t.advancedVisible})),(0,T.Z)(this,"setSchemas",(function(e){t.schemas=e})),(0,T.Z)(this,"setLoading",(function(e){t.loading=e})),(0,T.Z)(this,"setIsDirty",(function(e){t.isDirty=e})),(0,T.Z)(this,"onFormChange",(function(e){var n=e.key,r=e.value;if(t.isDirty=!0,(0,x.has)(t.formState,n)){var a=t.formState[n];t.formState[n]=Tn(Tn({},a),{},{value:r,error:void 0})}else t.formState[n]={value:r}})),(0,T.Z)(this,"onFormArrayChange",(function(e){var n=e.operation,r=e.key,a=e.idx,s=e.value;switch(n){case"add":if((0,x.has)(t.formState,r))t.formState[r].value.push(s);else{t.formState[r]={value:[s]}}break;case"delete":if((0,x.has)(t.formState,r)){var i=(0,x.filter)(t.formState[r].value,(function(e,t){return t!=a}));t.formState[r].value=i}break;default:(0,x.has)(t.formState,r)&&!(0,x.isUndefined)(a)?t.formState[r].value[a]=s:t.formState[r]={value:[s]}}})),(0,T.Z)(this,"validateForm",(function(){var e=!0,n=(0,x.mapValues)(t.formState,(function(t,n){switch(n){case"name":return(0,x.isEmpty)(t.value)||An(t.value)?(e=!1,Tn(Tn({},t),{},{error:"Invalid function name"})):t;case"args":var r,a=null===(r=t.value)||void 0===r?void 0:r.map((function(t){return(0,x.isEmpty)(t.name)||An(t.name)?(e=!1,Tn(Tn({},t),{},{error:"Invalid argument name"})):t}));return t.value=a,t;case"configParams":var s,i=null===(s=t.value)||void 0===s?void 0:s.map((function(t){var n={name:void 0,value:void 0};return((0,x.isEmpty)(t.name)||An(t.name))&&(e=!1,n.name="Invalid config name"),(0,x.isEmpty)(t.value)&&(e=!1,n.value="Missing config value"),Tn(Tn({},t),{},{error:n})}));return t.value=i,t;default:return t}}));return e||t.formState.update(n),e})),(0,Ut.ky)(this)}return(0,Yt.Z)(e,[{key:"title",get:function(){return this.formState.id?"Edit '".concat(this.formState.originalName,"' function"):"Add a new function"}},{key:"isEditing",get:function(){return void 0!=this.formState.id}}]),e}();function An(e){return/\s/.test(e)}var Vn=(0,a.createContext)(null),Ln=(0,s.Pi)((function(e){var t=e.func,n=e.visible,r=e.setVisible,i=(0,j.oR)(),c=i.ui,o=i.meta,l=(0,s.fv)((function(){return new In}));l.meta=o;var d=(0,a.useState)(!1),u=d[0],m=d[1];function p(){return(p=(0,S.Z)(P().mark((function e(){var t,a,s,i;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!l.validateForm()){e.next=15;break}if(l.setLoading(!0),!(t=l.formState.requestBody).id){e.next=10;break}return e.next=7,l.meta.functions.update(t.id,t);case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,l.meta.functions.create(t);case 12:e.t0=e.sent;case 13:(a=e.t0).error?(c.setNotification({category:"error",message:"Failed to create function: ".concat(null!==(s=null===(i=a.error)||void 0===i?void 0:i.message)&&void 0!==s?s:"Submit request failed")}),l.setLoading(!1)):(c.setNotification({category:"success",message:"".concat(l.isEditing?"Updated":"Created new"," function called ").concat(a.name)}),l.setLoading(!1),r(!n));case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(0),c.setNotification({category:"error",message:"Failed to create function: ".concat(e.t1.message)}),l.setLoading(!1);case 21:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}return(0,a.useEffect)((function(){var e=function(){var e=(0,S.Z)(P().mark((function e(){var t;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.meta.schemas.load();case 2:t=l.meta.schemas.list(),l.setSchemas(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,a.useEffect)((function(){l.formState.reset(t),l.setIsDirty(!1)}),[n,t]),(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(G.ZP,{size:"large",visible:n,onCancel:function(){l.isDirty?m(!0):r(!n)},header:l.title,className:"hooks-sidepanel mr-0 transform transition-all duration-300 ease-in-out",loading:l.loading,onConfirm:function(){return p.apply(this,arguments)},children:[(0,w.jsx)(Vn.Provider,{value:l,children:(0,w.jsx)("div",{className:"mt-4 space-y-10",children:l.isEditing?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(G.ZP.Content,{children:(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsx)(Wn,{}),(0,w.jsx)(Hn,{})]})}),(0,w.jsx)(G.ZP.Separator,{}),(0,w.jsx)(G.ZP.Content,{children:(0,w.jsx)(qn,{readonly:!0})}),(0,w.jsx)(G.ZP.Separator,{}),(0,w.jsx)(G.ZP.Content,{children:(0,w.jsx)(Bn,{})})]}):(0,w.jsxs)("div",{className:"space-y-6",children:[(0,w.jsx)(G.ZP.Content,{children:(0,w.jsx)(Wn,{})}),(0,w.jsx)(G.ZP.Separator,{}),(0,w.jsx)(G.ZP.Content,{children:(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsx)(Hn,{}),(0,w.jsx)(Qn,{})]})}),(0,w.jsx)(G.ZP.Separator,{}),(0,w.jsx)(G.ZP.Content,{children:(0,w.jsx)(qn,{})}),(0,w.jsx)(G.ZP.Separator,{}),(0,w.jsx)(G.ZP.Content,{children:(0,w.jsx)(Bn,{})}),(0,w.jsx)(G.ZP.Separator,{}),(0,w.jsx)(G.ZP.Content,{children:(0,w.jsx)(zt.Z,{children:(0,w.jsx)("div",{className:"space-y-8 rounded bg-scale-200 py-4",children:(0,w.jsx)("div",{className:"px-6",children:(0,w.jsx)(q.Z,{onChange:function(){return l.toggleAdvancedVisible()},label:"Show advanced settings",checked:l.advancedVisible,labelOptional:"These are settings that might be familiar for postgres heavy users "})})})})}),l.advancedVisible&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(G.ZP.Content,{children:(0,w.jsxs)("div",{className:"space-y-2",children:[(0,w.jsx)(Kn,{}),(0,w.jsx)(Gn,{})]})}),(0,w.jsx)(G.ZP.Separator,{}),(0,w.jsx)(G.ZP.Content,{children:(0,w.jsx)(Yn,{})}),(0,w.jsx)(G.ZP.Separator,{}),(0,w.jsx)(G.ZP.Content,{children:(0,w.jsx)(Jn,{})})]})]})})}),(0,w.jsx)(zn.Z,{visible:u,header:"Confirm to close",buttonLabel:"Confirm",onSelectCancel:function(){return m(!1)},onSelectConfirm:function(){m(!1),r(!n)},children:(0,w.jsx)($.C.Content,{children:(0,w.jsx)("p",{className:"py-4 text-sm text-scale-1100",children:"There are unsaved changes. Are you sure you want to close the panel? Your changes will be lost."})})})]})})})),Wn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(Vn);return(0,w.jsx)(o.Z,{id:"name",label:"Name of function",layout:"horizontal",placeholder:"Name of function",value:t.formState.name.value,onChange:function(e){return t.onFormChange({key:"name",value:e.target.value})},size:"small",error:t.formState.name.error,descriptionText:"Name will also be used for the function name in postgres"})})),qn=(0,s.Pi)((function(e){var t=e.readonly,n=(0,a.useContext)(Vn);return(0,w.jsxs)("div",{children:[(0,w.jsxs)("div",{className:"flex flex-col",children:[(0,w.jsx)("h5",{className:"text-base text-scale-1200",children:"Arguments"}),(0,w.jsx)("p",{className:"text-sm text-scale-1100",children:"Arguments can be referenced in the function body using either names or numbers."})]}),(0,w.jsxs)("div",{className:"space-y-2 pt-4",children:[t&&(0,x.isEmpty)(n.formState.args.value)&&(0,w.jsx)("span",{className:"text-scale-900",children:"No argument for this function"}),n.formState.args.value.map((function(e,n){return(0,w.jsx)(Mn,{idx:n,name:e.name,type:e.type,error:e.error,readonly:t},"arg-".concat(n))})),!t&&(0,w.jsx)("div",{className:"",children:(0,w.jsx)(d.z,{type:"default",icon:(0,w.jsx)(u.Z,{}),onClick:function(){n.onFormArrayChange({key:"args",value:{name:"",type:"bool"},operation:"add"})},disabled:t,children:"Add a new argument"})})]})]})})),Mn=(0,s.Pi)((function(e){var t=e.idx,n=e.name,r=e.type,s=e.error,c=e.readonly,l=(0,a.useContext)(Vn);return(0,w.jsxs)("div",{className:"flex flex-row space-x-1 items-center",children:[(0,w.jsx)(o.Z,{id:"name-".concat(t),className:"flex-1 flex-grow",value:n,placeholder:"Name of argument",onChange:function(e){var n=e.currentTarget.value;l.onFormArrayChange({key:"args",value:{name:n,type:r},idx:t,operation:"update"})},size:"small",error:s,disabled:c}),(0,w.jsxs)(i.Z,{id:"type-".concat(t),className:"flex-1",value:r,size:"small",onChange:function(e){l.onFormArrayChange({key:"args",value:{name:n,type:e},idx:t,operation:"update"})},disabled:c,children:[(0,w.jsx)(i.Z.Option,{value:"integer",label:"integer",children:"integer"}),Fn.DL.map((function(e){return(0,w.jsx)(i.Z.Option,{value:e,label:e,children:e},e)}))]}),!c&&(0,w.jsx)("div",{children:(0,w.jsx)(d.z,{danger:!0,type:"default",icon:(0,w.jsx)(f.Z,{size:"tiny"}),onClick:function(){l.onFormArrayChange({key:"args",idx:t,operation:"delete"})},size:"small"})})]})})),Yn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(Vn);return(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{className:"flex items-center justify-between",children:(0,w.jsx)("h5",{className:"text-base text-scale-1200",children:"Config Params"})}),(0,w.jsx)("div",{className:"space-y-2 pt-4",children:t.formState.configParams.value.map((function(e,t){return(0,w.jsx)(Un,{idx:t,name:e.name,value:e.value,error:e.error},"configParam-".concat(t))}))}),(0,w.jsx)("div",{className:"pt-2",children:(0,w.jsx)(d.z,{type:"default",icon:(0,w.jsx)(u.Z,{}),onClick:function(){t.onFormArrayChange({key:"configParams",value:{name:"",value:""},operation:"add"})},children:"Add a new config"})})]})})),Un=(0,s.Pi)((function(e){var t=e.idx,n=e.name,r=e.value,s=e.error,i=(0,a.useContext)(Vn);return(0,w.jsxs)("div",{className:"flex space-x-1 items-center",children:[(0,w.jsx)(o.Z,{id:"name-".concat(t),className:"flex-1",placeholder:"Name of config",value:n,onChange:function(e){var n=e.currentTarget.value;i.onFormArrayChange({key:"configParams",value:{name:n,value:r},idx:t,operation:"update"})},size:"small",error:null===s||void 0===s?void 0:s.name}),(0,w.jsx)(o.Z,{id:"value-".concat(t),className:"flex-1",placeholder:"Value of config",value:r,onChange:function(e){var r=e.currentTarget.value;i.onFormArrayChange({key:"configParams",value:{name:n,value:r},idx:t,operation:"update"})},size:"small",error:null===s||void 0===s?void 0:s.value}),(0,w.jsx)("div",{children:(0,w.jsx)(d.z,{danger:!0,type:"default",icon:(0,w.jsx)(f.Z,{size:"tiny"}),onClick:function(){i.onFormArrayChange({key:"configParams",idx:t,operation:"delete"})},size:"small"})})]})})),Bn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(Vn);return(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsxs)("div",{className:"flex flex-col",children:[(0,w.jsx)("h5",{className:"text-base text-scale-1200",children:"Definition"}),(0,w.jsxs)("p",{className:"text-sm text-scale-1100",children:["The language below should be written in `",t.formState.language.value,"`."]}),!(null!==t&&void 0!==t&&t.isEditing)&&(0,w.jsx)("p",{className:"text-sm text-scale-1100",children:"Change the language in the Advanced Settings below."})]}),(0,w.jsx)("div",{className:"h-40 border dark:border-dark",children:(0,w.jsx)(nn.Z,{defaultValue:t.formState.definition.value,onInputChange:function(e){t.onFormChange({key:"definition",value:e})},contextmenu:!1})})]})})),Hn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(Vn);return(0,w.jsx)(i.Z,{id:"schema",label:"Schema",size:"small",layout:"horizontal",placeholder:"Pick a schema",value:t.formState.schema.value,descriptionText:"Tables made in the table editor will be in 'public'",onChange:function(e){return t.onFormChange({key:"schema",value:e})},children:t.schemas.map((function(e){return(0,w.jsx)(i.Z.Option,{label:e.name,value:e.name,children:e.name},e.name)}))})})),Kn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,j.oR)().meta,n=(0,a.useContext)(Vn),s=(0,x.partition)(t.extensions.list(),(function(e){return!(0,x.isNull)(e.installed_version)})),c=(0,r.Z)(s,1)[0];return(0,w.jsxs)(i.Z,{id:"language",size:"small",label:"Language",layout:"horizontal",value:n.formState.language.value,placeholder:"Pick a language",onChange:function(e){return n.onFormChange({key:"language",value:e})},children:[(0,w.jsx)(i.Z.Option,{value:"sql",label:"sql",children:"sql"}),c.filter((function(e){return e.name.startsWith("pl")})).map((function(e){return(0,w.jsx)(i.Z.Option,{value:e.name,label:e.name,children:e.name},e.name)}))]})})),Qn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(Vn);return(0,w.jsxs)(i.Z,{id:"returnType",size:"small",label:"Return type",layout:"horizontal",value:t.formState.returnType.value,onChange:function(e){return t.onFormChange({key:"returnType",value:e})},children:[(0,w.jsx)(i.Z.Option,{value:"void",label:"void",children:"void"}),(0,w.jsx)(i.Z.Option,{value:"record",label:"record",children:"record"}),(0,w.jsx)(i.Z.Option,{value:"trigger",label:"trigger",children:"trigger"}),(0,w.jsx)(i.Z.Option,{value:"integer",label:"integer",children:"integer"}),Fn.DL.map((function(e){return(0,w.jsx)(i.Z.Option,{value:e,label:e,children:e},e)}))]})})),Gn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(Vn);return(0,w.jsxs)(i.Z,{id:"behavior",size:"small",label:"Behavior",layout:"horizontal",value:t.formState.behavior.value,onChange:function(e){return t.onFormChange({key:"behavior",value:e})},children:[(0,w.jsx)(i.Z.Option,{value:"IMMUTABLE",label:"immutable",children:"immutable"}),(0,w.jsx)(i.Z.Option,{value:"STABLE",label:"stable",children:"stable"}),(0,w.jsx)(i.Z.Option,{value:"VOLATILE",label:"volatile",children:"volatile"})]})})),Jn=(0,s.Pi)((function(e){(0,O.Z)(e);var t=(0,a.useContext)(Vn);return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)("div",{className:"space-y-4",children:(0,w.jsxs)(En.Z.Group,{type:"cards",label:"Type of security",layout:"vertical",onChange:function(e){t.onFormChange({key:"securityDefiner",value:"SECURITY_DEFINER"==e.target.value})},value:t.formState.securityDefiner.value?"SECURITY_DEFINER":"SECURITY_INVOKER",error:t.formState.securityDefiner.error,children:[(0,w.jsx)(En.Z,{id:"SECURITY_INVOKER",label:"SECURITY INVOKER",value:"SECURITY_INVOKER",checked:!t.formState.securityDefiner.value,description:"Function is to be executed with the privileges of the user that calls it."}),(0,w.jsx)(En.Z,{id:"SECURITY_DEFINER",label:"SECURITY DEFINER",value:"SECURITY_DEFINER",checked:t.formState.securityDefiner.value,description:"Function is to be executed with the privileges of the user that created it."})]})})})})),$n=(0,s.Pi)((function(e){var t=e.func,n=e.visible,r=e.setVisible,s=(0,j.oR)(),i=s.ui,c=s.meta,o=(0,a.useState)(!1),l=o[0],d=o[1],u=null!==t&&void 0!==t?t:{},m=u.id,p=u.name,h=u.schema;function f(){return(f=(0,S.Z)(P().mark((function e(){var t;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,d(!0),m){e.next=4;break}throw Error("Invalid function info");case 4:return e.next=6,c.functions.del(m);case 6:if(!(t=e.sent).error){e.next=11;break}throw t.error;case 11:i.setNotification({category:"success",message:"Successfully removed ".concat(p)}),r(!1);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),i.setNotification({category:"error",message:"Failed to delete ".concat(p,": ").concat(e.t0.message)});case 18:return e.prev=18,d(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[0,15,18,21]])})))).apply(this,arguments)}return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(Cn.Z,{visible:n,onCancel:function(){return r(!n)},onConfirm:function(){return f.apply(this,arguments)},title:"Delete this function",loading:l,confirmLabel:"Delete function ".concat(p),confirmPlaceholder:"Type in name of function",confirmString:p,text:"This will delete your function called ".concat(p," of schema ").concat(h,"."),alert:"You cannot recover this function once it is deleted!"})})}))},30259:function(e,t,n){var r=n(38480),a=n(20796),s=n(24246);t.Z=function(){return(0,s.jsxs)("div",{className:"flex h-64 flex-col items-center justify-center",children:[(0,s.jsx)(r.Z,{src:"".concat(a.GW,"/img/no-search-results.svg"),preProcessor:function(e){return e.replace(/svg/,'svg className="mb-2 w-16 h-16 text-color-inherit"')}}),(0,s.jsx)("p",{className:"w-64 text-center text-sm opacity-50",children:"Hmm, we couldn't find any results that matches your query. Try another?"})]})}},15916:function(e,t,n){var r=n(47314),a=n(24246);t.Z=function(e){var t=e.searchString,n=e.onResetFilter;return(0,a.jsxs)("div",{className:"bg-scale-100 dark:bg-scale-300 border border-scale-300 dark:border-scale-500 px-6 py-4 rounded flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-scale-1100",children:"No results found"}),(0,a.jsxs)("p",{className:"text-sm text-scale-1000",children:['Your search for "',t,'" did not return any results']})]}),void 0!==n&&(0,a.jsx)(r.z,{type:"default",onClick:function(){return n()},children:"Reset filter"})]})}},78906:function(e,t,n){var r=n(55732),a=n(34707),s=n.n(a),i=n(90085),c=n(27378),o=n(27102),l=n(24246);t.Z=function(e){var t=e.queryId,n=e.language,a=void 0===n?"pgsql":n,d=e.defaultValue,u=void 0===d?"":d,m=e.readOnly,p=void 0!==m&&m,h=e.contextmenu,f=void 0===h||h,x=e.onInputChange,v=void 0===x?function(){}:x,b=(0,i.Ik)(),j=(0,o.oR)().meta,g=(0,c.useRef)();function y(e){return N.apply(this,arguments)}function N(){return(N=(0,r.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.formatQuery(t);case 3:if(!(n=e.sent).error){e.next=6;break}throw n.error;case 6:return e.abrupt("return",n);case 9:return e.prev=9,e.t0=e.catch(0),console.error("formatPgsql error:",e.t0),e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}(0,c.useEffect)((function(){if(b){b.editor.defineTheme("supabase",{base:"vs-dark",inherit:!0,colors:{},rules:[{token:"",background:"4a5568"},{token:"string.sql",foreground:"24b47e"},{token:"comment",foreground:"666666"},{token:"predefined.sql",foreground:"D4D4D4"}]});var e=b.languages.registerDocumentFormattingEditProvider("pgsql",{provideDocumentFormattingEdits:function(e){return(0,r.Z)(s().mark((function t(){var n,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getValue(),t.next=3,y(n);case 3:return r=t.sent,t.abrupt("return",[{range:e.getFullModelRange(),text:r}]);case 5:case"end":return t.stop()}}),t)})))()}});return function(){e.dispose()}}}),[b]),(0,c.useEffect)((function(){var e;g.current&&(null===(e=g.current)||void 0===e||e.changeViewZones((function(e){e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})})))}),[t]);var w=function(){return(0,l.jsx)("h4",{className:"text-lg",children:"Loading"})};return(0,l.jsx)(i.ZP,{className:"monaco-editor",theme:"vs-dark",defaultLanguage:a,defaultValue:u,path:t,loading:(0,l.jsx)(w,{}),options:{readOnly:p,tabSize:2,fontSize:13,minimap:{enabled:!1},wordWrap:"on",fixedOverflowWidgets:!0,contextmenu:f},onMount:function(e,t){g.current=e,e.changeViewZones((function(e){e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})}))},onChange:v})}},95439:function(e,t,n){var r=n(86677),a=n(89744),s=n(24246);t.Z=function(e){var t=e.message,n=(0,r.useRouter)(),i=n.query.ref;return(0,s.jsx)(a.Z,{title:"No public tables found",ctaButtonLabel:"Create a new table",onClickCta:function(){n.push("/project/".concat(i,"/editor"))},children:(0,s.jsx)("p",{className:"text-sm text-scale-1100",children:t})})}},69497:function(e,t,n){var r=n(47314),a=n(43659),s=n(79894),i=n.n(s),c=n(98213),o=n(27102),l=n(36802),d=n(20796),u=n(68043),m=n(24246);t.Z=(0,a.Pi)((function(e){var t,n=e.icon,a=e.primaryText,s=(e.projectRef,e.secondaryText),p=(0,o.oR)().ui,h=(0,l.UO)().ref,f=null===(t=p.selectedProject)||void 0===t?void 0:t.subscription_tier,x=(0,o.FH)(u.KA.BILLING_WRITE,"stripe.subscriptions"),v=(0,o.P5)("disableProjectCreationAndUpdate"),b=f===d.ev.ENTERPRISE;return(0,m.jsx)("div",{className:["block w-full rounded border border-opacity-20 py-4 px-6","border-gray-600 bg-gray-100","dark:border-gray-300 dark:bg-gray-400"].join(" "),children:(0,m.jsxs)("div",{className:"flex space-x-3",children:[n&&(0,m.jsx)("div",{className:"mt-1",children:n}),(0,m.jsxs)("div",{className:"flex w-full items-center justify-between space-x-32",children:[(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)("p",{className:"text-sm",children:a}),(0,m.jsx)("div",{children:(0,m.jsx)("p",{className:"text-sm text-scale-1100",children:s})})]}),(0,m.jsxs)(c.fC,{delayDuration:0,children:[(0,m.jsx)(c.xz,{children:(0,m.jsx)(r.z,{type:"primary",disabled:!x||v,children:(0,m.jsx)(i(),{href:"/project/".concat(h,b?"/settings/billing/update/enterprise":"/settings/billing/update"),children:(0,m.jsx)("a",{children:f===d.ev.FREE?"Upgrade to Pro":"Modify subscription"})})})}),!x||v?(0,m.jsx)(c.h_,{children:(0,m.jsxs)(c.VY,{side:"bottom",children:[(0,m.jsx)(c.Eh,{className:"radix-tooltip-arrow"}),(0,m.jsx)("div",{className:["border border-scale-200 text-center","rounded bg-scale-100 py-1 px-2 leading-none shadow"].join(" "),children:(0,m.jsx)("span",{className:"text-xs text-scale-1200",children:v?(0,m.jsxs)(m.Fragment,{children:["Subscription changes are currently disabled.",(0,m.jsx)("br",{}),"Our engineers are working on a fix."]}):x?"":"You need additional permissions to amend subscriptions"})})]})}):(0,m.jsx)(m.Fragment,{})]})]})]})})}))},81343:function(e,t,n){var r=n(90849),a=(n(27378),n(24387)),s=n(12163),i=n(24246);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}t.Z=function(e){return(0,i.jsx)(s.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:a.Z},e))}},62929:function(e,t,n){var r=n(90849),a=(n(27378),n(63680)),s=n(12163),i=n(24246);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}t.Z=function(e){return(0,i.jsx)(s.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:a.Z},e))}},49077:function(e,t,n){var r=n(90849),a=(n(27378),n(36596)),s=n(12163),i=n(24246);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}t.Z=function(e){return(0,i.jsx)(s.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:a.Z},e))}},84954:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(27378),a=n(44204),s=(0,r.createContext)({parentCallback:function(e){},type:"",name:"",activeId:"",parentSize:""}),i=n(54329),c=n(64355);var o=n(24246);function l(e){var t=e.id,n=void 0===t?function(){var e=46656*Math.random()|0,t=46656*Math.random()|0;return("00000"+e.toString(36)).slice(-3)+("00000"+t.toString(36)).slice(-3)}():t,r=e.disabled,a=e.value,l=e.label,d=e.afterLabel,u=e.beforeLabel,m=e.description,p=e.name,h=e.checked,f=e.className,x=e.onChange,v=e.onBlur,b=e.hidden,j=void 0!==b&&b,g=e.size,y=void 0===g?"medium":g,N=e.align,w=void 0===N?"vertical":N,Z=e.optionalLabel,k=e.addOnBefore,_=e.children,S=(0,c.Z)("radio"),O=p,C=(0,i.G)().handleBlur;function P(e){C&&C(e),v&&v(e)}return(0,o.jsx)(s.Consumer,{children:function(e){var t=e.parentCallback,s=e.type,i=e.name,c=e.activeId,p=e.parentSize,v=n,b=i||O;y=p||y;var g=c===v||(!!h||!1!==h&&void 0),N=[f,S.variants[s].container.base,"list"===s&&!j&&S.variants[s].container.size[y]];function C(e){t&&t(e),x&&x(e)}return N.push(S.variants[s].base),N.push(S.variants[s].size[y]),g?N.push(S.variants[s].active):N.push(S.variants[s].inactive),r&&N.push(S.disabled),"list"!==s&&(j=!0),(0,o.jsxs)("label",{htmlFor:v,className:N.join(" "),children:[(0,o.jsx)("input",{id:v,name:b,type:"radio",className:[S.base,S.size[y],j&&S.hidden,S.variants[s].radio_offset,""].join(" "),checked:g,disabled:r,value:a||v,onChange:function(e){return C(e)},onBlur:P}),k,_||(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:[S.label.base,S.label[y],S.variants[s].container.align[w]].join(" "),children:[u&&(0,o.jsx)("div",{className:[S.label_before.base,S.label_before[y]].join(" "),children:u}),(0,o.jsx)("div",{children:l}),d&&(0,o.jsx)("div",{className:[S.label_after.base,S.label_after[y]].join(" "),children:d}),m&&(0,o.jsx)("div",{className:[S.description.base,S.description[y]].join(" "),children:m})]}),Z&&(0,o.jsx)("div",{className:[S.optionalLabel.base,S.optionalLabel[y]].join(" "),children:Z})]})]})}})}l.Group=function(e){var t=e.id,n=e.layout,d=e.error,u=e.descriptionText,m=e.label,p=e.afterLabel,h=e.beforeLabel,f=e.labelOptional,x=e.children,v=e.className,b=e.type,j=void 0===b?"list":b,g=e.options,y=e.value,N=e.name,w=e.onChange,Z=e.size,k=void 0===Z?"medium":Z,_=e.validation,S=e.groupClassName,O=e.labelsLayout,C=void 0===O?"vertical":O,P=(0,r.useState)(""),E=P[0],F=P[1],z=(0,c.Z)("radio"),D=(0,i.G)(),T=D.formContextOnChange,R=D.values,I=D.errors,A=D.touched,V=D.fieldLevelValidation;return R&&!y&&(y=R[t||N]),d||(I&&!d&&(d=I[t||N]),d=A&&A[t||N]?d:void 0),(0,r.useEffect)((function(){_&&V(t,_(y))}),[]),(0,r.useEffect)((function(){F(y)}),[y]),(0,o.jsx)("fieldset",{name:N,className:v,children:(0,o.jsx)(a.l,{nonBoxInput:!0,label:m,afterLabel:p,beforeLabel:h,labelOptional:f,layout:n,id:t,error:d,descriptionText:u,size:k,labelLayout:C,children:(0,o.jsx)("div",{className:S||z.variants[j].group,children:(0,o.jsx)(s.Provider,{value:{parentCallback:function(e){w&&w(e),T&&T(e),_&&V(t,_(e.target.value)),F(e.target.id)},type:j,name:N,activeId:E,parentSize:k},children:g?g.map((function(e){return(0,o.jsx)(l,{id:e.id,label:e.label,beforeLabel:e.beforeLabel,afterLabel:e.afterLabel,value:e.value,description:e.description})})):x})})})})};var d=l}}]);
//# sourceMappingURL=6666-a998b8d32a728f33.js.map