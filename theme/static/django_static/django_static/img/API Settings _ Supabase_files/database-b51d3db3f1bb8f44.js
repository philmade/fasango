(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1675],{33003:function(e,s,t){"use strict";t.d(s,{iN:function(){return h},ph:function(){return c},by:function(){return p},hj:function(){return o},B4:function(){return u},S0:function(){return l},ld:function(){return n}});var r=t(24246);function n(e){return(0,r.jsxs)("div",{className:"mx-auto max-w-4xl px-5 pt-12 pb-20",children:[e.header&&(0,r.jsx)("h1",{className:"text-scale-1200 mb-8 text-3xl",children:e.header}),(0,r.jsx)("div",{className:"space-y-20",children:e.children})]})}var a=t(16792),c=function(e){var s=e.title,t=e.description;return(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h3",{className:"text-scale-1200 mb-2 text-xl",children:(0,r.jsx)(a.D,{unwrapDisallowed:!0,disallowedElements:["p"],children:s})}),t&&(0,r.jsx)("div",{className:"text-scale-900 text-sm",children:(0,r.jsx)(a.D,{children:t})})]})},i=t(27378),o=function(e){var s=e.children,t=e.header,n=e.disabled,a=e.visible,c=void 0===a||a,i=e.className,o=["grid grid-cols-12 gap-6 px-8 py-8","".concat(n?" opacity-30":" opacity-100"),"".concat(c?" block":" hidden"),"".concat(i)];return(0,r.jsxs)("div",{className:o.join(" "),children:[t,s]})},l=function(e){var s=e.children,t=e.className,n=void 0===t?"":t,a=e.description;return void 0!==a?(0,r.jsxs)("div",{className:"flex flex-col space-y-2 col-span-12 lg:col-span-5 ".concat(n),children:[(0,r.jsx)("label",{className:"text-scale-1200 text-sm",children:s}),a]}):(0,r.jsx)("label",{className:"text-scale-1200 col-span-12 text-sm lg:col-span-5 ".concat(n),children:s})},d=function(){return(0,r.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,r.jsx)("div",{className:"shimmering-loader h-2 w-1/3 rounded"}),(0,r.jsx)("div",{className:"flex flex-col justify-between space-y-2",children:(0,r.jsx)("div",{className:"shimmering-loader h-[34px] w-2/3 rounded"})})]})},u=function(e){var s=e.children,t=e.loading,n=void 0===t||t,a=e.fullWidth,c=e.className;return(0,r.jsx)("div",{className:"\n        relative col-span-12 flex flex-col gap-6 lg:col-span-7\n        ".concat(a&&"!col-span-12","\n        ").concat(c,"\n      "),children:n?i.Children.map(s,(function(e){return(0,r.jsx)(d,{})})):s})},p=function(e){var s=e.children,t=e.header,n=e.footer;return(0,r.jsxs)("div",{className:" bg-scale-100 dark:bg-scale-300 border-scale-400 overflow-hidden  rounded-md border shadow",children:[t&&(0,r.jsx)("div",{className:" border-scale-400 border-b px-8 py-4",children:t}),(0,r.jsx)("div",{className:"divide-scale-400 flex flex-col gap-0 divide-y",children:s}),n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"border-scale-400 border-t"}),n]})]})},x=t(47314),h=function(e){var s=e.form,t=e.hasChanges,n=void 0===t?void 0:t,a=e.handleReset,c=e.helper,i=e.disabled,o=void 0!==i&&i,l=e.isSubmitting,d=e.submitText,u=void 0===d?"Save":d,p=l||o||!n&&void 0!==n;return(0,r.jsxs)("div",{className:["flex w-full items-center gap-2",c?"justify-between":"justify-end"].join(" "),children:[c&&(0,r.jsx)("span",{className:"text-sm text-scale-900",children:c}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(x.z,{disabled:p,type:"default",htmlType:"reset",onClick:function(){return a()},children:"Cancel"}),(0,r.jsx)(x.z,{form:s,type:"primary",htmlType:"submit",disabled:p,loading:l,children:u})]})]})}},33114:function(e,s,t){"use strict";var r=t(79894),n=t.n(r),a=t(27378),c=t(93942),i=t(78651),o=t(47314),l=t(65961),d=t(24246);s.Z=function(e){var s=e.icon,t=e.title,r=e.description,u=e.url,p=e.urlLabel,x=void 0===p?"Read more":p,h=e.defaultVisibility,f=void 0!==h&&h,j=e.hideCollapse,m=void 0!==j&&j,b=e.button,v=e.className,y=void 0===v?"":v,g=e.block,w=void 0!==g&&g,N=(0,a.useState)(f),O=N[0],k=N[1];return(0,d.jsx)("div",{className:"".concat(w?"block w-full":"","\n      block w-full rounded border border-scale-600 bg-scale-100 py-3 dark:border-scale-500 dark:bg-scale-400 ").concat(y),children:(0,d.jsxs)("div",{className:"flex flex-col px-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex w-full space-x-3 lg:items-start",children:[s&&(0,d.jsx)("span",{className:"text-scale-900",children:s}),(0,d.jsx)("div",{className:"flex-grow",children:(0,d.jsx)("h5",{className:"text-sm text-scale-1200",children:t})})]}),r&&!m?(0,d.jsx)("div",{className:"cursor-pointer text-scale-900",onClick:function(){return k(!O)},children:O?(0,d.jsx)(c.Z,{size:14,strokeWidth:1.5}):(0,d.jsx)(i.Z,{size:14,strokeWidth:1.5})}):null]}),(r||u||b)&&(0,d.jsxs)("div",{className:"flex flex-col space-y-3 overflow-hidden transition-all ".concat(O?"mt-3":""),style:{maxHeight:O?500:0},children:[(0,d.jsx)("div",{className:"text-scale-1100 text-sm",children:r}),u&&(0,d.jsx)(n(),{href:u,children:(0,d.jsx)("a",{target:"_blank",rel:"noreferrer",className:"pt-2",children:(0,d.jsx)(o.z,{type:"default",icon:(0,d.jsx)(l.Z,{}),children:x})})}),b&&(0,d.jsx)("div",{children:b})]})]})})}},12401:function(e,s,t){"use strict";var r=t(20796),n=t(24246);s.Z=function(e){var s=e.passwordStrengthScore,t=void 0===s?0:s,a=e.passwordStrengthMessage,c=void 0===a?"":a,i=e.password,o=void 0===i?"":i,l=e.generateStrongPassword;return(0,n.jsxs)(n.Fragment,{children:[o&&(0,n.jsx)("div",{"aria-valuemax":100,"aria-valuemin":0,"aria-valuenow":r.sL[t],"aria-valuetext":r.sL[t],role:"progressbar",className:"mb-2 overflow-hidden transition-all border rounded bg-scale-200 dark:bg-scale-200 dark:border-dark",children:(0,n.jsx)("div",{style:{width:r.sL[t]},className:"relative h-2 w-full ".concat(r.bV[t]," transition-all duration-500 ease-out shadow-inner")})}),(0,n.jsxs)("p",{children:[c||"This is the password to your postgres database, so it must be a strong password and hard to guess."," ",(0,n.jsx)("span",{className:"text-brand-800 underline hover:text-brand-900 transition cursor-pointer",onClick:l,children:"Generate a password"})]})]})}},37043:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Ue}});var r=t(43659),n=t(27102),a=t(36802),c=t(42753),i=t(8178),o=t(79305),l=t(79894),d=t.n(l),u=t(27378),p=t(98213),x=t(47314),h=t(65961),f=t(33769),j=t(86223),m=t(83451),b=t(68043),v=t(96423),y=t(33003),g=t(51452),w=t(90849),N=t(44285),O=t(55732),k=t(34707),C=t.n(k),P=t(83174),S=t(94269),Z=t(77758),R=t(3648),z=t(29432),D=t(33114),_=[new P.gJ("10.0.0.0/8"),new P.gJ("172.16.0.0/12"),new P.gJ("192.168.0.0/16")],A=function(e){var s=new P.gJ(e);return _.map((function(e){return s.isInSubnet(e)})).includes(!0)},E=t(90089),I=t(85945),T=t(48228),U=t(14919),F=t(20796),B=function(e){return["projects",e,"network-restrictions"]},Y=["onSuccess"];function L(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);s&&(r=r.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,r)}return t}function q(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?L(Object(t),!0).forEach((function(s){(0,w.Z)(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}function V(e){return W.apply(this,arguments)}function W(){return(W=(0,O.Z)(C().mark((function e(s){var t,r,n;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.projectRef,r=s.dbAllowedCidrs,t){e.next=3;break}throw new Error("projectRef is required");case 3:return e.next=5,(0,U.v_)("".concat(F.Q2,"/projects/").concat(t,"/network-restrictions/apply"),{dbAllowedCidrs:r});case 5:if(!(n=e.sent).error){e.next=8;break}throw n.error;case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=e.onSuccess,t=(0,E.Z)(e,Y),r=(0,I.NL)();return(0,T.D)((function(e){return V(e)}),q({onSuccess:function(e,t,n){return(0,O.Z)(C().mark((function a(){var c;return C().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return c=t.projectRef,a.next=3,r.invalidateQueries(B(c));case 3:return a.next=5,null===s||void 0===s?void 0:s(e,t,n);case 5:case"end":return a.stop()}}),a)})))()}},t))},J=t(24246);function Q(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);s&&(r=r.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,r)}return t}function G(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?Q(Object(t),!0).forEach((function(s){(0,w.Z)(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Q(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}var M=function(e){var s=e.restrictedIps,t=e.visible,r=e.hasOverachingRestriction,c=e.onClose,i=(0,n.oR)().ui,o=(0,a.UO)().ref,l=H().mutateAsync,d=function(){var e=(0,O.Z)(C().mark((function e(t,n){var a,d,u;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.setSubmitting,o){e.next=3;break}return e.abrupt("return",console.error("Project ref is required"));case 3:if(a(!0),d="".concat(t.ipAddress,"/").concat(t.cidrBlockSize),!s.includes(d)){e.next=8;break}return e.abrupt("return",i.setNotification({category:"info",message:"The address ".concat(d," is already restricted")}));case 8:return u=r?[d]:[].concat((0,N.Z)(s),[d]),e.prev=9,e.next=12,l({projectRef:o,dbAllowedCidrs:u});case 12:c(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(9),i.setNotification({category:"error",message:"Failed to add restriction: ".concat(e.t0.message)});case 18:return e.prev=18,a(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[9,15,18,21]])})));return function(s,t){return e.apply(this,arguments)}}();return(0,J.jsx)(S.C,{closable:!0,hideFooter:!0,size:"medium",visible:t,onCancel:c,header:"Add a new restriction",children:(0,J.jsx)(Z.Z,{validateOnBlur:!0,id:"add-restriction-form",className:"!border-t-0",initialValues:{ipAddress:"",cidrBlockSize:void 0},validate:function(e){var s={},t=e.ipAddress,r=e.cidrBlockSize;return(r<0||r>32)&&(s.cidrBlockSize="Size has to be between 0 to 32"),P.gJ.isValid(t)?(A(t)&&(s.ipAddress="Private IP addresses are not supported"),s):(s.ipAddress="Please enter a valid IP address",s)},onSubmit:d,children:function(e){var s,t=e.isSubmitting,r=e.values,n=e.resetForm,a=!!P.gJ.isValid(r.ipAddress)&&A(r.ipAddress),o=""!==r.cidrBlockSize&&r.cidrBlockSize>=0&&r.cidrBlockSize<=32,l=Math.pow(2,32-(null!==(s=null===r||void 0===r?void 0:r.cidrBlockSize)&&void 0!==s?s:0)),d=function(e){try{var s=new P.gJ(e);return{start:s.startAddress().address,end:s.endAddress().address}}catch(t){return}}("".concat(r.ipAddress,"/").concat(r.cidrBlockSize)),h=o&&!a&&void 0!==d,f=(0,u.useState)(!1),j=f[0],m=f[1],b=function(){var e=(0,O.Z)(C().mark((function e(){var s,t,a,c;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,fetch("http://www.geoplugin.net/json.gp",{method:"GET"});case 3:return s=e.sent,e.next=6,s.json();case 6:t=e.sent,(a=t.geoplugin_request)?(c=G(G({},r),{},{ipAddress:a,cidrBlockSize:32}),n({initialValues:c,values:c})):i.setNotification({category:"error",duration:4e3,message:"Failed to retrieve client IP address, please enter address manually"}),m(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(S.C.Content,{children:(0,J.jsxs)("div",{className:"py-6 space-y-4",children:[(0,J.jsx)("p",{className:"text-sm text-scale-1100",children:"This will add an IP address range to a list of allowed ranges that can access your database. Only IPv4 addresses are supported at the moment."}),(0,J.jsx)(D.Z,{title:"Note: Restrictions only apply to your database and PgBouncer",description:"They do not currently apply to Supabase services such as PostgREST, Storage, or Authentication"}),(0,J.jsxs)("div",{className:"flex space-x-4",children:[(0,J.jsx)("div",{className:"w-[55%]",children:(0,J.jsx)(R.Z,{label:"IPv4 address",id:"ipAddress",name:"ipAddress",placeholder:"0.0.0.0",className:""})}),(0,J.jsx)("div",{className:"flex-grow",children:(0,J.jsx)(R.Z,{label:(0,J.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,J.jsx)("p",{children:"CIDR Block Size"}),(0,J.jsxs)(p.fC,{delayDuration:0,children:[(0,J.jsx)(p.xz,{children:(0,J.jsx)(z.Z,{size:"tiny",strokeWidth:2})}),(0,J.jsx)(p.h_,{children:(0,J.jsxs)(p.VY,{side:"bottom",children:[(0,J.jsx)(p.Eh,{className:"radix-tooltip-arrow"}),(0,J.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 w-[300px]"].join(" "),children:(0,J.jsx)("span",{className:"text-xs text-scale-1200",children:"Classless inter-domain routing (CIDR) notation is the notation used to identify networks and hosts in the networks. The block size tells us how many bits we need to take for the network prefix, and is a value between 0 to 32."})})]})})]})]}),id:"cidrBlockSize",name:"cidrBlockSize",type:"number",placeholder:"0",min:0,max:32})})]}),(0,J.jsx)(x.z,{type:"default",loading:j,disabled:j,onClick:function(){return b()},children:"Use my IP address"})]})}),(0,J.jsx)(S.C.Separator,{}),h?(0,J.jsx)(S.C.Content,{children:(0,J.jsxs)("div",{className:"space-y-1 pt-2 pb-4",children:[(0,J.jsxs)("p",{className:"text-sm",children:["The address range"," ",(0,J.jsxs)("code",{className:"text-xs",children:[r.ipAddress,"/",r.cidrBlockSize]})," ","will be restricted"]}),(0,J.jsxs)("p",{className:"text-sm text-scale-1000",children:["Selected address space: ",(0,J.jsx)("code",{className:"text-xs",children:d.start})," ","to ",(0,J.jsx)("code",{className:"text-xs",children:d.end})," "]}),(0,J.jsxs)("p",{className:"text-sm text-scale-1000",children:["Number of addresses: ",l]})]})}):(0,J.jsx)(S.C.Content,{children:(0,J.jsx)("div",{className:"pt-2 pb-4",children:(0,J.jsx)("div",{className:"h-[68px] flex items-center",children:(0,J.jsx)("p",{className:"text-sm text-scale-1000",children:"A summary of your restriction will be shown here after entering a valid IP address and CIDR block size"})})})}),(0,J.jsxs)("div",{className:"flex items-center justify-end px-6 py-4 border-t space-x-2",children:[(0,J.jsx)(x.z,{type:"default",disabled:t,onClick:function(){return c()},children:"Cancel"}),(0,J.jsx)(x.z,{htmlType:"submit",loading:t,disabled:t,children:"Save restriction"})]})]})}})})},K=t(11597),X=function(e){var s=e.visible,t=e.restrictedIps,r=e.selectedRestriction,c=e.onClose,i=(0,n.oR)().ui,o=(0,a.UO)().ref,l=(0,u.useState)(!1),d=l[0],p=l[1],h=H().mutateAsync,f=1===t.length&&t[0]===r,j=function(){var e=(0,O.Z)(C().mark((function e(){var s;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}return e.abrupt("return",console.error("Project ref is required"));case 2:if(p(!0),s=t.filter((function(e){return e!==r})),e.prev=4,0!==s.length){e.next=10;break}return e.next=8,h({projectRef:o,dbAllowedCidrs:["0.0.0.0/0"]});case 8:e.next=12;break;case 10:return e.next=12,h({projectRef:o,dbAllowedCidrs:s});case 12:c(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),i.setNotification({category:"error",message:"Failed to remove restriction: ".concat(e.t0.message)});case 18:return e.prev=18,p(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[4,15,18,21]])})));return function(){return e.apply(this,arguments)}}();return(0,J.jsxs)(S.C,{closable:!0,hideFooter:!0,size:"medium",visible:s,onCancel:c,header:"Confirm to remove restriction",children:[(0,J.jsx)(S.C.Content,{children:(0,J.jsxs)("div",{className:"py-6 space-y-4",children:[(0,J.jsxs)("p",{className:"text-sm text-scale-1100",children:["The IPv4 address ",(0,J.jsx)("code",{className:"text-xs",children:r})," will be removed from your list of network restrictions",f?".":", and no longer have access to your project's database."]}),f&&(0,J.jsx)(K.Z,{withIcon:!0,variant:"warning",title:"Database access will no longer be restricted",children:"Removing all network restrictions will default to your database being accessible from all IP addresses."})]})}),(0,J.jsxs)("div",{className:"flex items-center justify-end px-6 py-4 border-t space-x-2",children:[(0,J.jsx)(x.z,{type:"default",disabled:d,onClick:function(){return c()},children:"Cancel"}),(0,J.jsx)(x.z,{loading:d,disabled:d,onClick:function(){return j()},children:"Remove restriction"})]})]})},$=function(e){var s=e.visible,t=e.onClose,r=(0,n.oR)().ui,c=(0,a.UO)().ref,i=(0,u.useState)(!1),o=i[0],l=i[1],d=H().mutateAsync,p=function(){var e=(0,O.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=2;break}return e.abrupt("return",console.error("Project ref is required"));case 2:return l(!0),e.prev=3,e.next=6,d({projectRef:c,dbAllowedCidrs:["127.0.0.1/32"]});case 6:t(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),r.setNotification({category:"error",message:"Failed to update restriction: ".concat(e.t0.message)});case 12:return e.prev=12,l(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[3,9,12,15]])})));return function(){return e.apply(this,arguments)}}();return(0,J.jsxs)(S.C,{closable:!0,hideFooter:!0,size:"medium",visible:s,onCancel:t,header:"Restrict access from all IP addresses",children:[(0,J.jsx)(S.C.Content,{children:(0,J.jsxs)("div",{className:"py-6 space-y-4",children:[(0,J.jsx)("p",{className:"text-sm text-scale-1100",children:"This will prevent any external IP addresses from accessing your project's database. Are you sure?"}),(0,J.jsx)(D.Z,{defaultVisibility:!0,hideCollapse:!0,title:"Note: Restrictions only apply to your database and PgBouncer",description:"They do not currently apply to APIs offered over HTTPS, such as PostgREST, Storage, or Authentication"})]})}),(0,J.jsxs)("div",{className:"flex items-center justify-end px-6 py-4 border-t space-x-2",children:[(0,J.jsx)(x.z,{type:"default",disabled:o,onClick:function(){return t()},children:"Cancel"}),(0,J.jsx)(x.z,{loading:o,disabled:o,onClick:function(){return p()},children:"Confirm"})]})]})},ee=function(e){var s=e.visible,t=e.onClose,r=(0,n.oR)().ui,c=(0,a.UO)().ref,i=(0,u.useState)(!1),o=i[0],l=i[1],d=H().mutateAsync,p=function(){var e=(0,O.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=2;break}return e.abrupt("return",console.error("Project ref is required"));case 2:return l(!0),e.prev=3,e.next=6,d({projectRef:c,dbAllowedCidrs:["0.0.0.0/0"]});case 6:t(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),r.setNotification({category:"error",message:"Failed to update restriction: ".concat(e.t0.message)});case 12:return e.prev=12,l(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[3,9,12,15]])})));return function(){return e.apply(this,arguments)}}();return(0,J.jsxs)(S.C,{closable:!0,hideFooter:!0,size:"small",visible:s,onCancel:t,header:"Allow access from all IP addresses",children:[(0,J.jsx)(S.C.Content,{children:(0,J.jsx)("div",{className:"py-6 space-y-4",children:(0,J.jsx)("p",{className:"text-sm text-scale-1100",children:"This will allow any IP address to access your project's database. Are you sure?"})})}),(0,J.jsxs)("div",{className:"flex items-center justify-end px-6 py-4 border-t space-x-2",children:[(0,J.jsx)(x.z,{type:"default",disabled:o,onClick:function(){return t()},children:"Cancel"}),(0,J.jsx)(x.z,{loading:o,disabled:o,onClick:function(){return p()},children:"Confirm"})]})]})},se=t(36492),te=["enabled"];function re(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);s&&(r=r.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,r)}return t}function ne(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?re(Object(t),!0).forEach((function(s){(0,w.Z)(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):re(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}function ae(e,s){return ce.apply(this,arguments)}function ce(){return(ce=(0,O.Z)(C().mark((function e(s,t){var r,n,a,c,i;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.projectRef){e.next=3;break}throw new Error("projectRef is required");case 3:return e.next=5,(0,U.U2)("".concat(F.Q2,"/projects/").concat(r,"/network-restrictions"),{signal:t});case 5:if(!(n=e.sent).error){e.next=13;break}if(!(400===(null===(a=n.error)||void 0===a?void 0:a.code)&&(null===(c=n.error)||void 0===c||null===(i=c.message)||void 0===i?void 0:i.includes("not allowed to set up network restrictions")))){e.next=12;break}return e.abrupt("return",{entitlement:"disallowed",config:{dbAllowedCidrs:[]},status:""});case 12:throw n.error;case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ie=function(e){var s=e.disabled,t=e.onClick;return(0,J.jsxs)(p.fC,{delayDuration:0,children:[(0,J.jsx)(p.xz,{children:(0,J.jsx)(x.z,{type:"default",disabled:s,onClick:function(){return t(!0)},children:"Allow all access"})}),s&&(0,J.jsx)(p.h_,{children:(0,J.jsxs)(p.VY,{align:"center",side:"bottom",children:[(0,J.jsx)(p.Eh,{className:"radix-tooltip-arrow"}),(0,J.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 w-[250px]"].join(" "),children:(0,J.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to update network restrictions"})})]})})]})},oe=function(e){var s=e.disabled,t=e.onClick;return(0,J.jsxs)(p.fC,{delayDuration:0,children:[(0,J.jsx)(p.xz,{children:(0,J.jsx)(x.z,{type:"default",disabled:s,onClick:function(){return t(!0)},children:"Restrict all access"})}),s&&(0,J.jsx)(p.h_,{children:(0,J.jsxs)(p.VY,{align:"center",side:"bottom",children:[(0,J.jsx)(p.Eh,{className:"radix-tooltip-arrow"}),(0,J.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 w-[250px]"].join(" "),children:(0,J.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to update network restrictions"})})]})})]})},le=function(e){var s,t,r;(0,o.Z)(e);var c=(0,a.UO)().ref,i=(0,u.useState)(!1),l=i[0],w=i[1],N=(0,u.useState)(!1),O=N[0],k=N[1],C=(0,u.useState)(!1),P=C[0],S=C[1],Z=(0,u.useState)(),R=Z[0],z=Z[1],D=function(e){var s=e.projectRef,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.enabled,n=void 0===r||r,a=(0,E.Z)(t,te);return(0,se.a)(B(s),(function(e){var t=e.signal;return ae({projectRef:s},t)}),ne({enabled:n&&"undefined"!==typeof s},a))}({projectRef:c}),_=D.data,A=D.isLoading,I=(0,n.FH)(b.KA.UPDATE,"projects"),T="allowed"===(null===_||void 0===_?void 0:_.entitlement),U=null!==(s=null===_||void 0===_||null===(t=_.config)||void 0===t?void 0:t.dbAllowedCidrs)&&void 0!==s?s:[],F=null!==(r=null===_||void 0===_?void 0:_.status)&&void 0!==r?r:"",Y=0===U.length&&"stored"===F,L=0===U.length&&0===F.length,q=U.includes("0.0.0.0/0"),V=1===U.length&&"127.0.0.1/32"===U[0];return T?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)("section",{children:[(0,J.jsxs)("div",{className:"flex items-center justify-between",children:[(0,J.jsx)(y.ph,{title:"Network Restrictions",description:"Allow specific IP ranges to have access to your database."}),(0,J.jsxs)("div",{className:"flex items-center space-x-2 mb-6",children:[(0,J.jsx)(d(),{href:"https://supabase.com/docs/guides/platform/network-restrictions",children:(0,J.jsx)("a",{target:"_blank",rel:"noreferrer",children:(0,J.jsx)(x.z,{type:"default",icon:(0,J.jsx)(h.Z,{}),children:"Documentation"})})}),(0,J.jsxs)(p.fC,{delayDuration:0,children:[(0,J.jsx)(p.xz,{children:(0,J.jsx)(x.z,{disabled:!I,onClick:function(){return w(!0)},children:"Add restriction"})}),!I&&(0,J.jsx)(p.h_,{children:(0,J.jsxs)(p.VY,{align:"center",side:"bottom",children:[(0,J.jsx)(p.Eh,{className:"radix-tooltip-arrow"}),(0,J.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 w-[250px]"].join(" "),children:(0,J.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to update network restrictions"})})]})})]})]})]}),A?(0,J.jsx)(v.Z,{children:(0,J.jsx)(v.Z.Content,{children:(0,J.jsxs)("div",{className:"space-y-2",children:[(0,J.jsx)(g.Z,{}),(0,J.jsx)(g.Z,{className:"w-[70%]"}),(0,J.jsx)(g.Z,{className:"w-[50%]"})]})})}):Y?(0,J.jsx)(v.Z,{children:(0,J.jsx)(v.Z.Content,{children:(0,J.jsxs)("div",{className:"flex items-center justify-between",children:[(0,J.jsxs)("div",{className:"space-y-2",children:[(0,J.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,J.jsx)(f.Z,{strokeWidth:1.5,className:"text-scale-1000"}),(0,J.jsx)("p",{className:"text-sm",children:"Your network restrictions were not applied correctly"})]}),(0,J.jsx)("p",{className:"text-sm text-scale-1000",children:"Please try to add your network restrictions again"})]}),(0,J.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,J.jsx)(ie,{disabled:!I,onClick:k}),(0,J.jsx)(oe,{disabled:!I,onClick:S})]})]})})}):(0,J.jsx)(y.by,{children:L||q?(0,J.jsxs)("div",{className:"px-8 py-8 flex items-center justify-between",children:[(0,J.jsx)("div",{className:"flex items-start space-x-4",children:(0,J.jsxs)("div",{className:"space-y-1",children:[(0,J.jsx)("p",{className:"text-scale-1100 text-sm",children:"Your database can be accessed by all IP addresses"}),(0,J.jsx)("p",{className:"text-scale-1000 text-sm",children:"You may start limiting access to your database by adding a network restriction."})]})}),(0,J.jsx)("div",{children:(0,J.jsx)(oe,{disabled:!I,onClick:S})})]}):V?(0,J.jsxs)("div",{className:"px-8 py-8 flex items-center justify-between",children:[(0,J.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,J.jsx)(j.Z,{className:"text-scale-1100",strokeWidth:1.5}),(0,J.jsxs)("div",{className:"space-y-1",children:[(0,J.jsxs)("p",{className:"text-scale-1100 text-sm",children:["Your database ",(0,J.jsx)("span",{className:"text-amber-900 opacity-80",children:"cannot"})," be accessed externally"]}),(0,J.jsx)("p",{className:"text-scale-1000 text-sm",children:"All external IP addresses have been disallowed from accessing your project's database."}),(0,J.jsx)("p",{className:"text-scale-1000 text-sm",children:"Note: Restrictions only apply to your database, and not to Supabase services"})]})]}),(0,J.jsx)("div",{children:(0,J.jsx)(ie,{disabled:!I,onClick:k})})]}):(0,J.jsxs)("div",{className:"divide-y",children:[(0,J.jsxs)("div",{className:"px-8 py-3 flex items-center justify-between",children:[(0,J.jsxs)("div",{children:[(0,J.jsx)("p",{className:"text-scale-1100 text-sm",children:"Only the following IP addresses have access to your database"}),(0,J.jsx)("p",{className:"text-scale-1000 text-sm",children:"You may remove all of them to allow all IP addresses to have access to your database"}),(0,J.jsx)("p",{className:"text-scale-1000 text-sm",children:"Note: Restrictions only apply to your database, and not to Supabase services"})]}),(0,J.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,J.jsx)(ie,{disabled:!I,onClick:k}),(0,J.jsx)(oe,{disabled:!I,onClick:S})]})]}),U.map((function(e){return(0,J.jsxs)("div",{className:"px-8 py-4 flex items-center justify-between",children:[(0,J.jsxs)("div",{className:"flex items-center space-x-5",children:[(0,J.jsx)(m.Z,{size:16,className:"text-scale-1000"}),(0,J.jsx)("p",{className:"text-sm font-mono",children:e})]}),(0,J.jsx)(x.z,{type:"default",onClick:function(){return z(e)},children:"Remove"})]},e)}))]})})]}),(0,J.jsx)(ee,{visible:O,onClose:function(){return k(!1)}}),(0,J.jsx)($,{visible:P,onClose:function(){return S(!1)}}),(0,J.jsx)(M,{visible:l,restrictedIps:U,hasOverachingRestriction:q||V,onClose:function(){return w(!1)}}),(0,J.jsx)(X,{visible:void 0!==R,restrictedIps:U,selectedRestriction:R,onClose:function(){return z(void 0)}})]}):(0,J.jsx)(J.Fragment,{})},de=t(86677),ue=t(13405),pe=t(24903),xe=t(18229),he=t(22917),fe=t(30398),je=t(98784),me=t(77725),be=t(12401),ve=function(e){var s=e.disabled,t=void 0!==s&&s,r=(0,n.oR)(),c=r.ui,i=r.app,o=r.meta,l=(0,a.UO)().ref,d=(0,n.FH)(b.KA.UPDATE,"projects"),h=(0,u.useState)(!1),f=h[0],j=h[1],m=(0,u.useState)(!1),y=m[0],g=m[1],w=(0,u.useState)(""),N=w[0],k=w[1],P=(0,u.useState)(""),Z=P[0],z=P[1],D=(0,u.useState)(""),_=D[0],A=D[1],E=(0,u.useState)(0),I=E[0],T=E[1];function B(){return(B=(0,O.Z)(C().mark((function e(s){var t,r,n,a;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,pe._h)(s);case 2:t=e.sent,r=t.message,n=t.warning,a=t.strength,T(a),A(n),z(r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,u.useEffect)((function(){f&&(g(!1),k(""),z(""),A(""),T(0))}),[f]);var Y=(0,u.useRef)((0,je.debounce)((function(e){return function(e){return B.apply(this,arguments)}(e)}),300)).current,L=function(){var e=(0,O.Z)(C().mark((function e(){var s;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=2;break}return e.abrupt("return");case 2:if(!(I>=F.lS)){e.next=16;break}return g(!0),e.next=6,(0,U.r$)("".concat(F.T5,"/projects/").concat(l,"/db-password"),{password:N});case 6:if((s=e.sent).error){e.next=14;break}return e.next=10,i.projects.fetchDetail(l,(function(e){return o.setProjectDetails(e)}));case 10:c.setNotification({category:"success",message:s.message}),j(!1),e.next=15;break;case 14:c.setNotification({category:"error",message:"Failed to reset password"});case 15:g(!1);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(v.Z,{className:"!m-0",children:(0,J.jsx)(v.Z.Content,{children:(0,J.jsxs)("div",{className:"grid grid-cols-1 items-center lg:grid-cols-3",children:[(0,J.jsxs)("div",{className:"col-span-2 space-y-1",children:[(0,J.jsx)("p",{className:"block",children:"Database password"}),(0,J.jsx)("p",{className:"text-sm opacity-50",children:"You can use this password to connect directly to your Postgres database."})]}),(0,J.jsx)("div",{className:"flex items-end justify-end",children:(0,J.jsxs)(p.fC,{delayDuration:0,children:[(0,J.jsx)(p.xz,{children:(0,J.jsx)(x.z,{type:"default",disabled:!d||t,onClick:function(){return j(!0)},children:"Reset Database Password"})}),!d&&(0,J.jsx)(p.h_,{children:(0,J.jsxs)(p.VY,{side:"bottom",children:[(0,J.jsx)(p.Eh,{className:"radix-tooltip-arrow"}),(0,J.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 "].join(" "),children:(0,J.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to reset the database password"})})]})})]})})]})})}),(0,J.jsxs)(S.C,{hideFooter:!0,header:(0,J.jsx)("h5",{className:"text-sm text-scale-1200",children:"Reset database password"}),confirmText:"Reset password",alignFooter:"right",size:"medium",visible:f,loading:y,onCancel:function(){return j(!1)},children:[(0,J.jsx)(S.C.Content,{children:(0,J.jsx)("div",{className:"w-full space-y-8 py-8",children:(0,J.jsx)(R.Z,{type:"password",value:N,copy:N.length>0,onChange:function(e){var s=e.target.value;k(s),""==s?(T(-1),z("")):Y(s)},error:_,descriptionText:(0,J.jsx)(be.Z,{passwordStrengthScore:I,passwordStrengthMessage:Z,password:N,generateStrongPassword:function(){var e=me.generate({length:16,numbers:!0,uppercase:!0});k(e),Y(e)}})})})}),(0,J.jsx)(S.C.Separator,{}),(0,J.jsx)(S.C.Content,{children:(0,J.jsxs)("div",{className:"flex space-x-2 pb-2",children:[(0,J.jsx)(x.z,{type:"default",onClick:function(){return j(!1)},children:"Cancel"}),(0,J.jsx)(x.z,{type:"primary",loading:y,disabled:y,onClick:function(){return L()},children:"Reset password"})]})})]})]})},ye=function(e){var s=e.projectRef,t=(0,xe.oF)({projectRef:s}),r=t.data,n=t.isLoading,a=t.isError,c=(0,de.useRouter)(),i=(0,he.Mk)();if(a)return(0,J.jsx)("div",{className:"mx-auto p-6 text-center sm:w-full md:w-3/4",children:(0,J.jsx)("p",{className:"text-scale-1000",children:"Error loading database settings"})});if(n)return(0,J.jsxs)("div",{className:"space-y-10",children:[(0,J.jsxs)("section",{className:"space-y-6",children:[(0,J.jsx)("h3",{className:"text-scale-1200 mb-2 text-xl",children:"Database Settings"}),(0,J.jsx)(v.Z,{title:(0,J.jsx)("h5",{className:"mb-0",children:"Connection info"},"panel-title"),className:"!m-0",children:(0,J.jsx)(v.Z.Content,{className:"space-y-8",children:Array.from({length:5}).map((function(e,s){return(0,J.jsxs)("div",{className:"grid gap-2 items-center md:grid md:grid-cols-12 md:gap-x-4 w-full",children:[(0,J.jsx)(g.Z,{className:"h-4 w-1/3 col-span-4",delayIndex:s}),(0,J.jsx)(g.Z,{className:"h-8 w-full col-span-8",delayIndex:s})]},s)}))})})]}),(0,J.jsx)(ve,{disabled:!0}),(0,J.jsx)("section",{className:"space-y-6",children:(0,J.jsx)(v.Z,{title:(0,J.jsx)("h5",{className:"mb-0",children:"Connection string"},"panel-title"),className:"!m-0",children:(0,J.jsx)(v.Z.Content,{children:(0,J.jsxs)(ue.Z,{type:"underlined",size:"small",children:[(0,J.jsx)(ue.Z.Panel,{id:"psql",label:"PSQL",children:(0,J.jsx)(g.Z,{className:"h-8 w-full"})}),(0,J.jsx)(ue.Z.Panel,{id:"uri",label:"URI",children:(0,J.jsx)(g.Z,{className:"h-8 w-full"})}),(0,J.jsx)(ue.Z.Panel,{id:"golang",label:"Golang",children:(0,J.jsx)(g.Z,{className:"h-8 w-full"})}),(0,J.jsx)(ue.Z.Panel,{id:"jdbc",label:"JDBC",children:(0,J.jsx)(g.Z,{className:"h-8 w-full"})}),(0,J.jsx)(ue.Z.Panel,{id:"dotnet",label:".NET",children:(0,J.jsx)(g.Z,{className:"h-8 w-full"})}),(0,J.jsx)(ue.Z.Panel,{id:"nodejs",label:"Nodejs",children:(0,J.jsx)(g.Z,{className:"h-8 w-full"})}),(0,J.jsx)(ue.Z.Panel,{id:"php",label:"PHP",children:(0,J.jsx)(g.Z,{className:"h-8 w-full"})}),(0,J.jsx)(ue.Z.Panel,{id:"python",label:"Python",children:(0,J.jsx)(g.Z,{className:"h-8 w-full"})})]})})})})]});var o=r.project,l=(0,pe.Ff)(o,["db_host","db_name","db_port","db_user","inserted_at"]),d=function(e){return fe.Z.sendEvent({category:"settings",action:"copy_connection_string",label:e||""},i,c)},u="postgresql://".concat(l.db_user,":[YOUR-PASSWORD]@")+"".concat(l.db_host,":").concat(l.db_port.toString())+"/".concat(l.db_name),p="user=".concat(l.db_user," password=[YOUR-PASSWORD] ")+"host=".concat(l.db_host," port=").concat(l.db_port.toString())+" dbname=".concat(l.db_name),x="psql -h ".concat(l.db_host," -p ")+"".concat(l.db_port.toString()," -d ").concat(l.db_name," ")+"-U ".concat(l.db_user);return(0,J.jsxs)("div",{className:"space-y-10",children:[(0,J.jsxs)("section",{className:"space-y-6",children:[(0,J.jsx)("h3",{className:"text-scale-1200 mb-2 text-xl",children:"Database Settings"}),(0,J.jsx)(v.Z,{title:(0,J.jsx)("h5",{className:"mb-0",children:"Connection info"},"panel-title"),className:"!m-0",children:(0,J.jsxs)(v.Z.Content,{className:"space-y-6",children:[(0,J.jsx)(R.Z,{className:"input-mono",layout:"horizontal",readOnly:!0,copy:!0,disabled:!0,value:l.db_host,label:"Host",onCopy:function(){d("Host")}}),(0,J.jsx)(R.Z,{className:"input-mono",layout:"horizontal",readOnly:!0,copy:!0,disabled:!0,value:l.db_name,label:"Database name"}),(0,J.jsx)(R.Z,{className:"input-mono",layout:"horizontal",readOnly:!0,copy:!0,disabled:!0,value:l.db_port.toString(),label:"Port"}),(0,J.jsx)(R.Z,{layout:"horizontal",className:"input-mono table-input-cell text-base",readOnly:!0,copy:!0,disabled:!0,value:l.db_user,label:"User"}),(0,J.jsx)(R.Z,{className:"input-mono",layout:"horizontal",disabled:!0,readOnly:!0,value:"[The password you provided when you created this project]",label:"Password"})]})})]}),(0,J.jsx)(ve,{}),(0,J.jsx)("section",{className:"space-y-6",children:(0,J.jsx)(v.Z,{title:(0,J.jsx)("h5",{className:"mb-0",children:"Connection string"},"panel-title"),className:"!m-0",children:(0,J.jsx)(v.Z.Content,{children:(0,J.jsxs)(ue.Z,{type:"underlined",size:"small",children:[(0,J.jsx)(ue.Z.Panel,{id:"psql",label:"PSQL",children:(0,J.jsx)(R.Z,{copy:!0,readOnly:!0,disabled:!0,value:x,onCopy:function(){d("PSQL")}})}),(0,J.jsx)(ue.Z.Panel,{id:"uri",label:"URI",children:(0,J.jsx)(R.Z,{copy:!0,readOnly:!0,disabled:!0,value:u,onCopy:function(){d("URI")}})}),(0,J.jsx)(ue.Z.Panel,{id:"golang",label:"Golang",children:(0,J.jsx)(R.Z,{copy:!0,readOnly:!0,disabled:!0,value:p,onCopy:function(){d("Golang")}})}),(0,J.jsx)(ue.Z.Panel,{id:"jdbc",label:"JDBC",children:(0,J.jsx)(R.Z,{copy:!0,readOnly:!0,disabled:!0,value:"jdbc:postgresql://".concat(l.db_host,":").concat(l.db_port.toString())+"/".concat(l.db_name,"?user=").concat(l.db_user,"&password=[YOUR-PASSWORD]"),onCopy:function(){d("JDBC")}})}),(0,J.jsx)(ue.Z.Panel,{id:"dotnet",label:".NET",children:(0,J.jsx)(R.Z,{copy:!0,readOnly:!0,disabled:!0,value:"User Id=".concat(l.db_user,";Password=[YOUR-PASSWORD];")+"Server=".concat(l.db_host,";Port=").concat(l.db_port.toString(),";")+"Database=".concat(l.db_name),onCopy:function(){d(".NET")}})}),(0,J.jsx)(ue.Z.Panel,{id:"nodejs",label:"Nodejs",children:(0,J.jsx)(R.Z,{copy:!0,readOnly:!0,disabled:!0,value:u,onCopy:function(){d("Nodejs")}})}),(0,J.jsx)(ue.Z.Panel,{id:"php",label:"PHP",children:(0,J.jsx)(R.Z,{copy:!0,readOnly:!0,disabled:!0,value:p,onCopy:function(){d("PHP")}})}),(0,J.jsx)(ue.Z.Panel,{id:"python",label:"Python",children:(0,J.jsx)(R.Z,{copy:!0,readOnly:!0,disabled:!0,value:"user=".concat(l.db_user," password=[YOUR-PASSWORD]")+" host=".concat(l.db_host," port=").concat(l.db_port.toString())+" database=".concat(l.db_name),onCopy:function(){d("Python")}})})]})})})})]})},ge=t(14971),we=t(17634),Ne=t(65194),Oe=function(e){return["projects",e,"ssl-enforcement"]},ke=["enabled"];function Ce(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);s&&(r=r.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,r)}return t}function Pe(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?Ce(Object(t),!0).forEach((function(s){(0,w.Z)(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ce(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}function Se(e,s){return Ze.apply(this,arguments)}function Ze(){return(Ze=(0,O.Z)(C().mark((function e(s,t){var r,n,a,c,i;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.projectRef){e.next=3;break}throw new Error("projectRef is required");case 3:return e.next=5,(0,U.U2)("".concat(F.Q2,"/projects/").concat(r,"/ssl-enforcement"),{signal:t});case 5:if(!(n=e.sent).error){e.next=13;break}if(!(400===(null===(a=n.error)||void 0===a?void 0:a.code)&&(null===(c=n.error)||void 0===c||null===(i=c.message)||void 0===i?void 0:i.includes("not allowed to configure SSL enforcements")))){e.next=12;break}return e.abrupt("return",{appliedSuccessfully:!1,currentConfig:{database:!1},isNotAllowed:!0});case 12:throw n.error;case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Re=["onSuccess"];function ze(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);s&&(r=r.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,r)}return t}function De(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?ze(Object(t),!0).forEach((function(s){(0,w.Z)(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ze(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}function _e(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=(0,O.Z)(C().mark((function e(s){var t,r,n;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.projectRef,r=s.requestedConfig,t){e.next=3;break}throw new Error("projectRef is required");case 3:return e.next=5,(0,U.gz)("".concat(F.Q2,"/projects/").concat(t,"/ssl-enforcement"),{requestedConfig:r});case 5:if(!(n=e.sent).error){e.next=8;break}throw n.error;case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=e.onSuccess,t=(0,E.Z)(e,Re),r=(0,I.NL)();return(0,T.D)((function(e){return _e(e)}),De({onSuccess:function(e,t,n){return(0,O.Z)(C().mark((function a(){var c;return C().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return c=t.projectRef,a.next=3,r.invalidateQueries(Oe(c));case 3:return a.next=5,null===s||void 0===s?void 0:s(e,t,n);case 5:case"end":return a.stop()}}),a)})))()}},t))},Ie=function(){var e=(0,n.oR)().ui,s=(0,a.UO)().ref,t=(0,u.useState)(!1),r=t[0],c=t[1],i=(0,u.useState)(!1),o=i[0],l=i[1],h=(0,n.P5)("sslEnforcement"),f=(0,xe.oF)({projectRef:s}).data,j=function(e){var s=e.projectRef,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.enabled,n=void 0===r||r,a=(0,E.Z)(t,ke);return(0,se.a)(Oe(s),(function(e){var t=e.signal;return Se({projectRef:s},t)}),Pe({enabled:n&&"undefined"!==typeof s},a))}({projectRef:s}),m=j.data,v=j.isLoading,g=Ee().mutateAsync,w=(0,n.FH)(b.KA.UPDATE,"projects"),N=!(null!==m&&void 0!==m&&m.isNotAllowed),k="prod",P=void 0!==(null===f||void 0===f?void 0:f.project)&&new Date(f.project.inserted_at)>=new Date("2021-04-30");(0,u.useEffect)((function(){!v&&m&&c(m.appliedSuccessfully&&m.currentConfig.database)}),[v]);var S=function(){var t=(0,O.Z)(C().mark((function t(){return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=2;break}return t.abrupt("return",console.error("Project ref is required"));case 2:return c(!r),l(!0),t.prev=4,t.next=7,g({projectRef:s,requestedConfig:{database:!r}});case 7:t.next=13;break;case 9:t.prev=9,t.t0=t.catch(4),e.setNotification({category:"error",message:"Failed to update SSL enforcement: ".concat(t.t0.message)}),c(r);case 13:return t.prev=13,l(!1),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[4,9,13,16]])})));return function(){return t.apply(this,arguments)}}();return(0,J.jsxs)("div",{children:[(0,J.jsx)("div",{className:"flex items-center justify-between",children:(0,J.jsx)(y.ph,{title:"SSL Configuration",description:""})}),(0,J.jsxs)(y.by,{children:[h&&N&&(0,J.jsx)(y.hj,{header:(0,J.jsx)(y.S0,{className:"lg:col-span-7",description:(0,J.jsxs)("div",{className:"space-y-4",children:[(0,J.jsx)("p",{className:"text-sm text-scale-1000",children:"Reject non-SSL connections to your database"}),!(null!==m&&void 0!==m&&m.appliedSuccessfully)&&(0,J.jsxs)(K.Z,{withIcon:!0,variant:"warning",title:"SSL enforcement was not updated successfully",children:["Please try updating again, or contact"," ",(0,J.jsx)(d(),{href:"/support/new",children:(0,J.jsx)("a",{target:"_blank",rel:"noreferrer",className:"underline",children:"support"})})," ","if this error persists"]})]}),children:"Enforce SSL on incoming connections"}),children:(0,J.jsx)(y.B4,{loading:!1,className:"lg:!col-span-5",children:(0,J.jsxs)("div",{className:"flex items-center justify-end mt-2.5 space-x-2",children:[(v||o)&&(0,J.jsx)(ge.Z,{className:"animate-spin",strokeWidth:1.5,size:16}),(0,J.jsx)(we.Z,{checked:r,disabled:v||o||!w,onChange:S})]})})}),(0,J.jsxs)("div",{className:"grid grid-cols-1 items-center lg:grid-cols-2 p-8",children:[(0,J.jsxs)("div",{className:"space-y-2",children:[(0,J.jsx)("p",{className:"block text-sm",children:"SSL Certificate"}),(0,J.jsx)("div",{style:{maxWidth:"420px"},children:(0,J.jsx)("p",{className:"text-sm opacity-50",children:"Use this certificate when connecting to your database to prevent snooping and man-in-the-middle attacks."})})]}),(0,J.jsx)("div",{className:"flex items-end justify-end",children:(0,J.jsxs)(p.fC,{delayDuration:0,children:[(0,J.jsx)(p.xz,{children:(0,J.jsx)(x.z,{type:"default",disabled:!P,icon:(0,J.jsx)(Ne.Z,{}),children:(0,J.jsx)("a",{href:"https://supabase-downloads.s3-ap-southeast-1.amazonaws.com/".concat(k,"/ssl/").concat(k,"-ca-2021.crt"),children:"Download Certificate"})})}),!P&&(0,J.jsx)(p.h_,{children:(0,J.jsxs)(p.VY,{align:"center",side:"bottom",children:[(0,J.jsx)(p.Eh,{className:"radix-tooltip-arrow"}),(0,J.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200 w-[250px]"].join(" "),children:(0,J.jsx)("span",{className:"text-xs text-scale-1200",children:"Projects before 15:08 (GMT+08), 29th April 2021 do not have SSL certificates installed"})})]})})]})})]})]})]})},Te=function(){var e=(0,a.UO)().ref,s=(0,n.P5)("networkRestrictions");return(0,J.jsx)("div",{className:"1xl:px-28 mx-auto flex flex-col px-5 pt-6 pb-14 lg:px-16 xl:px-24 2xl:px-32",children:(0,J.jsxs)("div",{className:"content h-full w-full overflow-y-auto space-y-10",children:[(0,J.jsx)(ye,{projectRef:e}),(0,J.jsx)(i.C,{}),(0,J.jsx)(Ie,{}),s&&(0,J.jsx)(le,{})]})})};Te.getLayout=function(e){return(0,J.jsx)(c.dU,{title:"Database",children:e})};var Ue=(0,r.Pi)(Te)},83451:function(e,s,t){"use strict";var r=t(90849),n=(t(27378),t(88750)),a=t(12163),c=t(24246);function i(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);s&&(r=r.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,r)}return t}s.Z=function(e){return(0,c.jsx)(a.Z,function(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?i(Object(t),!0).forEach((function(s){(0,r.Z)(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}({icon:n.Z},e))}},13405:function(e,s,t){"use strict";t.d(s,{Z:function(){return u}});var r=t(11246),n=t(27378),a=(0,n.createContext)({activeId:""}),c=t(47912),i=t(86677),o=t(64355),l=t(24246),d=function(e){var s,t,d=e.defaultActiveId,u=e.activeId,p=e.type,x=void 0===p?"pills":p,h=e.size,f=void 0===h?"tiny":h,j=e.block,m=e.onChange,b=e.onClick,v=e.scrollable,y=e.addOnBefore,g=e.addOnAfter,w=e.listClassNames,N=e.children,O=n.useState(d||(N&&N[0].props?N[0].props.id:"")),k=(0,r.Z)(O,2),C=k[0],P=k[1],S=(0,i.useRouter)(),Z=null===S||void 0===S||null===(s=S.asPath)||void 0===s||null===(t=s.split("#")[1])||void 0===t?void 0:t.toUpperCase(),R=(0,o.Z)("tabs"),z=u||(C||Z);function D(e){var s=e!==z;P(e),b&&b(e),m&&s&&m(e)}var _=[R[x].list];return v&&_.push(R.scrollable),w&&_.push(w),N&&!Array.isArray(N)&&(N=[N]),(0,l.jsxs)(c.fC,{defaultValue:d,value:z,className:R.base,children:[(0,l.jsxs)(c.aV,{className:_.join(" "),children:[y,N.map((function(e){var s=z===e.props.id,t=[R[x].base,R.size[f]];return s?t.push(R[x].active):t.push(R[x].inactive),j&&t.push(R.block),(0,l.jsxs)(c.xz,{onKeyDown:function(s){13===s.keyCode&&(s.preventDefault(),D(e.props.id))},onClick:function(){return D(e.props.id)},value:e.props.id,className:t.join(" "),children:[e.props.icon,(0,l.jsx)("span",{children:e.props.label})]},"".concat(e.props.id,"-tab-button"))})),g]}),(0,l.jsx)(a.Provider,{value:{activeId:z},children:N})]})};d.Panel=function(e){var s=e.children,t=e.id,r=e.className,n=(0,o.Z)("tabs");return(0,l.jsx)(a.Consumer,{children:function(e){e.activeId;return(0,l.jsx)(c.VY,{value:t,className:[n.content,r].join(" "),children:s})}})};var u=d},64502:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/settings/database",function(){return t(37043)}])}},function(e){e.O(0,[6337,7930,1188,6792,8094,922,3360,2056,5286,8178,9774,2888,179],(function(){return s=64502,e(e.s=s);var s}));var s=e.O();_N_E=s}]);
//# sourceMappingURL=database-b51d3db3f1bb8f44.js.map