(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2469],{33003:function(e,t,r){"use strict";r.d(t,{iN:function(){return f},ph:function(){return i},by:function(){return p},hj:function(){return o},B4:function(){return u},S0:function(){return l},ld:function(){return s}});var n=r(24246);function s(e){return(0,n.jsxs)("div",{className:"mx-auto max-w-4xl px-5 pt-12 pb-20",children:[e.header&&(0,n.jsx)("h1",{className:"text-scale-1200 mb-8 text-3xl",children:e.header}),(0,n.jsx)("div",{className:"space-y-20",children:e.children})]})}var a=r(16792),i=function(e){var t=e.title,r=e.description;return(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h3",{className:"text-scale-1200 mb-2 text-xl",children:(0,n.jsx)(a.D,{unwrapDisallowed:!0,disallowedElements:["p"],children:t})}),r&&(0,n.jsx)("div",{className:"text-scale-900 text-sm",children:(0,n.jsx)(a.D,{children:r})})]})},c=r(27378),o=function(e){var t=e.children,r=e.header,s=e.disabled,a=e.visible,i=void 0===a||a,c=e.className,o=["grid grid-cols-12 gap-6 px-8 py-8","".concat(s?" opacity-30":" opacity-100"),"".concat(i?" block":" hidden"),"".concat(c)];return(0,n.jsxs)("div",{className:o.join(" "),children:[r,t]})},l=function(e){var t=e.children,r=e.className,s=void 0===r?"":r,a=e.description;return void 0!==a?(0,n.jsxs)("div",{className:"flex flex-col space-y-2 col-span-12 lg:col-span-5 ".concat(s),children:[(0,n.jsx)("label",{className:"text-scale-1200 text-sm",children:t}),a]}):(0,n.jsx)("label",{className:"text-scale-1200 col-span-12 text-sm lg:col-span-5 ".concat(s),children:t})},d=function(){return(0,n.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,n.jsx)("div",{className:"shimmering-loader h-2 w-1/3 rounded"}),(0,n.jsx)("div",{className:"flex flex-col justify-between space-y-2",children:(0,n.jsx)("div",{className:"shimmering-loader h-[34px] w-2/3 rounded"})})]})},u=function(e){var t=e.children,r=e.loading,s=void 0===r||r,a=e.fullWidth,i=e.className;return(0,n.jsx)("div",{className:"\n        relative col-span-12 flex flex-col gap-6 lg:col-span-7\n        ".concat(a&&"!col-span-12","\n        ").concat(i,"\n      "),children:s?c.Children.map(t,(function(e){return(0,n.jsx)(d,{})})):t})},p=function(e){var t=e.children,r=e.header,s=e.footer;return(0,n.jsxs)("div",{className:" bg-scale-100 dark:bg-scale-300 border-scale-400 overflow-hidden  rounded-md border shadow",children:[r&&(0,n.jsx)("div",{className:" border-scale-400 border-b px-8 py-4",children:r}),(0,n.jsx)("div",{className:"divide-scale-400 flex flex-col gap-0 divide-y",children:t}),s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"border-scale-400 border-t"}),s]})]})},x=r(47314),f=function(e){var t=e.form,r=e.hasChanges,s=void 0===r?void 0:r,a=e.handleReset,i=e.helper,c=e.disabled,o=void 0!==c&&c,l=e.isSubmitting,d=e.submitText,u=void 0===d?"Save":d,p=l||o||!s&&void 0!==s;return(0,n.jsxs)("div",{className:["flex w-full items-center gap-2",i?"justify-between":"justify-end"].join(" "),children:[i&&(0,n.jsx)("span",{className:"text-sm text-scale-900",children:i}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(x.z,{disabled:p,type:"default",htmlType:"reset",onClick:function(){return a()},children:"Cancel"}),(0,n.jsx)(x.z,{form:t,type:"primary",htmlType:"submit",disabled:p,loading:l,children:u})]})]})}},27434:function(e,t,r){"use strict";r.d(t,{Z:function(){return m}});var n=r(44285),s=r(27378),a=r(98784),i=r(4158),c=r(1296),o=r(66804),l=r(87474),d=r(33769),u=r(51664),p=r(70946),x=r(24246),f=function(e){var t=e.name;return(0,x.jsx)("div",{className:["text-typography-body-light dark:text-typography-body-dark","flex cursor-not-allowed items-center space-x-2 rounded bg-gray-600","py-0.5 px-2 text-sm"].join(" "),children:(0,x.jsx)("span",{className:"opacity-50",children:t})})},h=function(e){var t=e.name,r=e.handleRemove;return(0,x.jsxs)("div",{className:["text-typography-body-light dark:text-typography-body-dark","flex items-center space-x-2 rounded bg-gray-500","py-0.5 px-2 text-sm"].join(" "),onClick:function(e){return e.preventDefault()},children:[(0,x.jsx)("span",{children:t}),(0,x.jsx)(p.Z,{size:12,className:"cursor-pointer opacity-50 transition hover:opacity-100",onClick:function(e){e.preventDefault(),r()}})]})};function m(e){var t=e.options,r=e.value,p=e.label,m=e.error,j=e.descriptionText,v=e.placeholder,b=e.searchPlaceholder,g=void 0===b?"Search for option":b,y=e.emptyMessage,w=e.disabled,N=e.allowDuplicateSelection,O=void 0!==N&&N,P=e.onChange,S=void 0===P?function(){}:P,k=(0,s.useRef)(null),Z=(0,s.useState)(r||[]),_=Z[0],T=Z[1],A=(0,s.useState)(""),E=A[0],C=A[1],I=(0,s.useState)(128),R=I[0],U=I[1],D=r||_;(0,s.useEffect)((function(){U(k.current?k.current.offsetWidth:R)}),[k.current]);var W="".concat(R,"px"),z=(0,a.orderBy)(t,["disabled"],["desc"]),F=E.length>0?(0,a.filter)(z,(function(e){return!e.disabled&&e.name.includes(E)})):(0,a.filter)(z,{disabled:!1}),J=function(e){var r=D,s=function(e){return void 0!==(D||[]).find((function(t){return t===e.value}))}(e),i=O?(0,n.Z)(r.concat([e.value])):s?(0,n.Z)((0,a.without)(r,e.value)):(0,n.Z)(r.concat([e.value])),c=t.filter((function(e){return e.disabled})).map((function(e){return e.name})),o=O?i.concat(c):(0,n.Z)(new Set(i.concat(c)));T(o),S(o)};return(0,x.jsxs)("div",{className:"form-group ".concat(w?"pointer-events-none opacity-50":""),children:[p&&(0,x.jsx)("label",{className:"!w-full",children:p}),(0,x.jsx)("div",{className:["form-control form-control--multi-select","border border-scale-700 bg-scaleA-200","multi-select relative block w-full w-full space-x-1 overflow-auto rounded","".concat(void 0!==m?"border-red-800 bg-red-100":"")].join(" "),ref:k,children:(0,x.jsx)(i.Z,{sideOffset:4,side:"bottom",align:"start",style:{width:W},header:(0,x.jsxs)("div",{className:"flex items-center space-x-2 py-1",children:[(0,x.jsx)(c.Z,{size:14}),(0,x.jsx)("input",{autoFocus:!0,className:"w-72 bg-transparent text-sm placeholder-scale-1000 outline-none",value:E,placeholder:g,onKeyPress:function(e){"Enter"===e.key&&E.length>0&&1===F.length&&J(F[0])},onChange:function(e){return C(e.currentTarget.value)}})]}),overlay:(0,x.jsx)("div",{className:"max-h-[225px] space-y-1 overflow-y-auto p-1",children:F.length>=1?F.map((function(e){var t=!(O||!D||!D.find((function(t){return t===e.value})));return(0,x.jsxs)("div",{onClick:function(){return J(e)},className:["text-typography-body-light dark:text-typography-body-dark","group flex cursor-pointer items-center justify-between transition","space-x-1 rounded bg-transparent p-2 px-4 text-sm hover:bg-gray-600","".concat(t?" dark:bg-green-600 dark:bg-opacity-25":"")].join(" "),children:[(0,x.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,x.jsx)("p",{children:e.name}),void 0!==e.description&&(0,x.jsx)("p",{className:"opacity-50",children:e.description})]}),t&&(0,x.jsx)(o.Z,{size:16,strokeWidth:3,className:"cursor-pointer transition ".concat(t?" dark:text-green-500":"")}),O&&(0,x.jsxs)("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition space-x-1",children:[(0,x.jsx)(l.Z,{size:14}),(0,x.jsx)("p",{className:"text-sm",children:"Add value"})]})]},"multiselect-option-".concat(e.id))})):0===t.length?(0,x.jsx)("div",{className:["flex h-full w-full flex-col dark:border-dark","items-center justify-center border border-dashed p-3"].join(" "),children:y||(0,x.jsxs)("div",{className:"flex w-full items-center space-x-2",children:[(0,x.jsx)(d.Z,{strokeWidth:1.5,size:18,className:"text-scale-1000"}),(0,x.jsx)("p",{className:"text-sm text-scale-1000",children:"No options available"})]})}):(0,x.jsx)("div",{className:["flex h-full w-full flex-col dark:border-dark","items-center justify-center border border-dashed p-3"].join(" "),children:y||(0,x.jsx)("div",{className:"flex w-full items-center space-x-2",children:(0,x.jsx)("p",{className:"text-sm text-scale-1000",children:"No options found"})})})}),onOpenChange:function(){return C("")},children:(0,x.jsxs)("div",{className:["flex w-full flex-wrap items-start gap-1.5 p-1.5 cursor-default","".concat(0===D.length?"h-9":"")].join(" "),children:[0===D.length&&v&&(0,x.jsx)("div",{className:"px-2 text-sm text-scale-1000 h-full flex items-center",children:v}),D.map((function(e,t){var r,n="".concat(e,"-").concat(t),s=z.find((function(t){return t.value===e})),a=null!==(r=null===s||void 0===s?void 0:s.disabled)&&void 0!==r&&r;return s?a?(0,x.jsx)(f,{name:e},n):(0,x.jsx)(h,{name:e,handleRemove:function(){return O?function(e){var t=_.filter((function(t,r){return r!==e}));T(t),S(t)}(t):J(s)}},n):(0,x.jsx)(x.Fragment,{})})),(0,x.jsx)("div",{className:"absolute inset-y-0 right-0 pl-3 pr-2 flex space-x-1 items-center cursor-pointer ",children:(0,x.jsx)(u.Z,{size:16,strokeWidth:2,className:"text-scale-900"})})]})})}),j&&(0,x.jsx)("span",{className:"form-text text-muted mt-2 text-sm",children:j}),m&&(0,x.jsx)("span",{className:"text-red-900 text-sm mt-2",children:m})]})}},40529:function(e,t,r){"use strict";r.r(t),r.d(t,{PageContext:function(){return ke},default:function(){return _e}});var n,s,a=r(27378),i=r(43659),c=r(27102),o=r(36802),l=r(42753),d=r(85945),u=r(25024),p=r(33769),x=r(3648),f=r(43109),h=r(2288),m=r(49175),j=r(96423),v=r(941),b=r(90849),g=(n={},(0,b.Z)(n,u.$X.APIServicesConfigurationUpdateFailed,"failed to update configuration for API services"),(0,b.Z)(n,u.$X.APIServicesRestartFailed,"failed to restart API services"),(0,b.Z)(n,u.$X.DatabaseAdminAPIConfigurationUpdateFailed,"failed to update configuration for database admin API"),(0,b.Z)(n,u.$X.PostgreSQLRestartFailed,"failed to restart PostgreSQL service"),(0,b.Z)(n,u.$X.SupabaseAPIKeyUpdateFailed,"failed to update Supabase API key"),(0,b.Z)(n,u.$X.APIGatewayUpdateFailed,"failed to update API Gateway"),n),y=(s={},(0,b.Z)(s,u.GJ.RestartedAPIServices,"restarted API services"),(0,b.Z)(s,u.GJ.RestartedPostgreSQL,"restarted PostgreSQL service"),(0,b.Z)(s,u.GJ.Started,"started updating"),(0,b.Z)(s,u.GJ.UpdatedAPIServicesConfiguration,"updated configuration for API services"),(0,b.Z)(s,u.GJ.UpdatedDatabaseAdminAPIConfiguration,"updated configuration for database admin API"),(0,b.Z)(s,u.GJ.UpdatedAPIGatewayConfiguration,"updated configuration for API Gateway"),s),w=r(55732),N=r(79305),O=r(34707),P=r.n(O),S=r(98213),k=r(14971),Z=r(47314),_=r(51664),T=r(2674),A=r(95992),E=r(23615),C=r.n(E);function I(){return I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I.apply(this,arguments)}function R(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var U=(0,a.forwardRef)((function(e,t){var r=e.color,n=void 0===r?"currentColor":r,s=e.size,i=void 0===s?24:s,c=R(e,["color","size"]);return a.createElement("svg",I({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),a.createElement("path",{d:"M12 19l7-7 3 3-7 7-3-3z"}),a.createElement("path",{d:"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"}),a.createElement("path",{d:"M2 2l7.586 7.586"}),a.createElement("circle",{cx:"11",cy:"11",r:"2"}))}));U.propTypes={color:C().string,size:C().oneOfType([C().string,C().number])},U.displayName="PenTool";var D=U,W=r(12163),z=r(24246);function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var J=function(e){return(0,z.jsx)(W.Z,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({icon:D},e))},L=r(11597),G=r(94269),$=r(85742),M=r(44292),Q=r(51669),X=r(68043),q=r(24903),Y=r(90089),B=r(48228),K=r(14919),V=r(20796),H=["onSuccess"];function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function re(e){return ne.apply(this,arguments)}function ne(){return(ne=(0,w.Z)(P().mark((function e(t){var r,n,s,a;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectRef,n=t.jwtSecret,s=t.changeTrackingId,e.next=3,(0,K.r$)("".concat(V.T5,"/projects/").concat(r,"/config/secrets"),{jwt_secret:n,change_tracking_id:s});case 3:if(!(a=e.sent).error){e.next=6;break}throw a.error;case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var se=r(36492),ae=["enabled"];function ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ce(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ie(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oe(e,t){return le.apply(this,arguments)}function le(){return(le=(0,w.Z)(P().mark((function e(t,r){var n,s;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.projectRef){e.next=3;break}throw new Error("projectRef is required");case 3:return e.next=5,(0,K.U2)("".concat(V.T5,"/projects/").concat(n,"/config/postgrest"),{signal:r});case 5:if(!(s=e.sent).error){e.next=8;break}throw s.error;case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var de=function(e){var t=e.projectRef,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.enabled,s=void 0===n||n,a=(0,Y.Z)(r,ae);return(0,se.a)(m.U.postgrest(t),(function(e){var r=e.signal;return oe({projectRef:t},r)}),ce({enabled:s&&"undefined"!==typeof t},a))},ue=r(96364),pe=function(e){(0,N.Z)(e);var t=(0,c.oR)().ui,r=(0,o.UO)().ref,n=(0,a.useState)(""),s=n[0],i=n[1],l=(0,a.useState)(!1),h=l[0],v=l[1],b=(0,a.useState)(!1),O=b[0],E=b[1],C=(0,a.useState)(!1),I=C[0],R=C[1],U=(0,a.useState)(!1),D=U[0],W=U[1],F=(0,c.FH)(X.KA.READ,"field.jwt_secret"),K=(0,c.FH)(X.KA.INFRA_EXECUTE,"queue_job.projects.update_jwt"),V=(0,f.tb)({projectRef:r}).data,ee=de({projectRef:r}),ne=ee.data,se=ee.isError,ae=u.iL.Failed,ie=u.iL.Updated,ce=u.iL.Updating,oe=(null===V||void 0===V?void 0:V.jwtSecretUpdateStatus)===ae,le=void 0===(null===V||void 0===V?void 0:V.jwtSecretUpdateStatus)||(null===V||void 0===V?void 0:V.jwtSecretUpdateStatus)===ie,pe=(null===V||void 0===V?void 0:V.jwtSecretUpdateStatus)===ce,xe=g[null===V||void 0===V?void 0:V.jwtSecretUpdateError],fe=y[null===V||void 0===V?void 0:V.jwtSecretUpdateProgress],he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onSuccess,r=(0,Y.Z)(e,H),n=(0,d.NL)();return(0,B.D)((function(e){return re(e)}),te({onSuccess:function(e,r,s){return(0,w.Z)(P().mark((function a(){var i;return P().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.projectRef,a.next=3,n.invalidateQueries(m.U.jwtSecretUpdatingStatus(i));case 3:return a.next=5,null===t||void 0===t?void 0:t(e,r,s);case 5:case"end":return a.stop()}}),a)})))()}},r))}(),me=he.mutateAsync;function je(e,t){return ve.apply(this,arguments)}function ve(){return(ve=(0,w.Z)(P().mark((function e(n,s){var a;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return W(!0),e.prev=3,a=(0,q.k$)(),e.next=7,me({projectRef:r,jwtSecret:n,changeTrackingId:a});case 7:s(!1),t.setNotification({category:"info",message:"Successfully submitted JWT secret update request. Please wait while your project is updated."}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),t.setNotification({category:"error",message:e.t0.message});case 14:return e.prev=14,W(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,11,14,17]])})))).apply(this,arguments)}return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(j.Z,{title:(0,z.jsx)("h5",{className:"mb-0",children:"JWT Settings"}),children:(0,z.jsx)(j.Z.Content,{className:"space-y-6 border-t border-panel-border-interior-light dark:border-panel-border-interior-dark",children:se?(0,z.jsxs)("div",{className:"flex items-center justify-center py-8 space-x-2",children:[(0,z.jsx)(p.Z,{size:16,strokeWidth:1.5}),(0,z.jsx)("p",{className:"text-sm text-scale-1100",children:"Failed to retrieve JWT settings"})]}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(x.Z,{label:"JWT Secret",readOnly:!0,copy:F&&le,reveal:F&&le,disabled:!0,value:F?oe?"JWT secret update failed":pe?"Updating JWT secret...":(null===ne||void 0===ne?void 0:ne.jwt_secret)||"":"You need additional permissions to view the JWT secret",className:"input-mono",descriptionText:"Used to decode your JWTs. You can also use this to mint your own JWTs.",layout:"horizontal"}),(0,z.jsxs)("div",{className:"space-y-3",children:[(0,z.jsx)("div",{className:"p-3 px-6 border rounded-md shadow-sm bg-scale-200 dark:border-dark dark:bg-scale-200",children:pe?(0,z.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,z.jsx)(k.Z,{className:"animate-spin",size:14}),(0,z.jsxs)("p",{className:"text-sm",children:["Updating JWT secret: ",fe]})]}):(0,z.jsx)("div",{className:"w-full space-y-2",children:(0,z.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,z.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,z.jsx)("p",{className:"text-sm",children:"Generate a new JWT secret"}),(0,z.jsx)("p",{className:"text-sm opacity-50",children:"A random secret will be created, or you can create your own."})]}),(0,z.jsx)("div",{className:"flex flex-col items-end",children:pe?(0,z.jsx)(Z.z,{loading:!0,type:"secondary",children:"Updating JWT secret..."}):K?(0,z.jsx)(T.ZP,{align:"end",side:"bottom",overlay:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(T.ZP.Item,{onClick:function(){return R(!0)},icon:(0,z.jsx)(A.Z,{size:16}),children:"Generate a random secret"}),(0,z.jsx)(T.ZP.Separator,{}),(0,z.jsx)(T.ZP.Item,{onClick:function(){return E(!0)},icon:(0,z.jsx)(J,{size:16}),children:"Create my own secret"})]}),children:(0,z.jsx)(Z.z,{as:"span",type:"default",iconRight:(0,z.jsx)(_.Z,{}),children:"Generate a new secret"})}):(0,z.jsxs)(S.fC,{delayDuration:0,children:[(0,z.jsx)(S.xz,{children:(0,z.jsx)(Z.z,{disabled:!0,as:"span",type:"default",iconRight:(0,z.jsx)(_.Z,{}),children:"Generate a new secret"})}),(0,z.jsx)(S.h_,{children:(0,z.jsxs)(S.VY,{side:"bottom",children:[(0,z.jsx)(S.Eh,{className:"radix-tooltip-arrow"}),(0,z.jsx)("div",{className:["rounded bg-scale-100 py-1 px-2 leading-none shadow","border border-scale-200"].join(" "),children:(0,z.jsx)("span",{className:"text-xs text-scale-1200",children:"You need additional permissions to generate a new JWT secret"})})]})})]})})]})})}),oe?(0,z.jsxs)(L.Z,{withIcon:!0,variant:"warning",title:"Failed to update JWT secret",children:["Please try again. If the failures persist, please contact Supabase support with the following details: ",(0,z.jsx)("br",{}),"Change tracking ID: ",null===V||void 0===V?void 0:V.changeTrackingId," ",(0,z.jsx)("br",{}),"Error message: ",xe]}):K?(0,z.jsxs)(L.Z,{withIcon:!0,variant:"warning",title:"This will invalidate all existing API keys!",children:["Generating a new JWT secret will invalidate ",(0,z.jsx)("u",{children:"all"})," of your API keys, including your ",(0,z.jsx)("code",{children:"service_role"})," and ",(0,z.jsx)("code",{children:"anon"})," keys. Your project will also be restarted during this process, which will terminate any existing connections."]}):(0,z.jsx)(z.Fragment,{})]})]})})}),(0,z.jsx)(ue.Z,{danger:!0,visible:I,title:"Are you absolutely sure?",description:"This action cannot be undone and the old JWT secret will be lost. All existing API keys will be invalidated, and any open connections will be terminated.",buttonLabel:"Generate new secret",buttonLoadingLabel:"Generating",onSelectCancel:function(){return R(!1)},onSelectConfirm:function(){return je("ROLL",R)}}),(0,z.jsx)(G.C,{closable:!0,header:"Create a custom JWT secret",visible:O,size:"medium",variant:"danger",loading:D,customFooter:(0,z.jsxs)("div",{className:"space-x-2",children:[(0,z.jsx)(Z.z,{type:"default",onClick:function(){return E(!1)},children:"Cancel"}),(0,z.jsx)(Z.z,{type:"primary",disabled:s.length<32||s.includes("@")||s.includes("$"),loading:D,onClick:function(){return je(s,E)},children:"Apply new JWT secret"})]}),children:(0,z.jsx)(G.C.Content,{children:(0,z.jsxs)("div",{className:"py-4 space-y-2",children:[(0,z.jsx)("p",{className:"text-sm text-scale-1100",children:"Create a custom JWT secret. Make sure it is a strong combination of characters that cannot be guessed easily."}),(0,z.jsx)(L.Z,{withIcon:!0,variant:"warning",title:"All existing API keys will be invalidated, and any open connections will be terminated."}),(0,z.jsx)(x.Z,{onChange:function(e){return i(e.target.value)},value:s,icon:(0,z.jsx)($.Z,{}),type:h?"text":"password",className:"w-full text-left",label:"Custom JWT secret",descriptionText:"Minimally 32 characters long, '@' and '$' are not allowed.",actions:(0,z.jsx)("div",{className:"flex items-center justify-center mr-1",children:(0,z.jsx)(Z.z,{type:"default",icon:h?(0,z.jsx)(M.Z,{}):(0,z.jsx)(Q.Z,{}),onClick:function(){return v(!h)}})})})]})})})]})},xe=r(98784),fe=r(77758),he=r(90546),me=["onSuccess"];function je(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?je(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):je(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function be(e){return ge.apply(this,arguments)}function ge(){return(ge=(0,w.Z)(P().mark((function e(t){var r,n,s,a,i;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectRef,n=t.dbSchema,s=t.maxRows,a=t.dbExtraSearchPath,e.next=3,(0,K.r$)("".concat(V.T5,"/projects/").concat(r,"/config/postgrest"),{db_schema:n,max_rows:s,db_extra_search_path:a});case 3:if(!(i=e.sent).error){e.next=6;break}throw i.error;case 6:return e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ye=r(27434),we=r(33003);function Ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Oe=(0,i.Pi)((function(e){var t;(0,N.Z)(e);var r=(0,a.useContext)(ke),n=(0,c.oR)().ui,s=r.meta,i=(0,o.UO)().ref,l="project-postgres-config",u=de({projectRef:i}),f=u.data,h=u.isError,j=(0,c.FH)(X.KA.UPDATE,"custom_config_postgrest"),v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onSuccess,r=(0,Y.Z)(e,me),n=(0,d.NL)();return(0,B.D)((function(e){return be(e)}),ve({onSuccess:function(e,r,s){return(0,w.Z)(P().mark((function a(){var i;return P().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.projectRef,n.invalidateQueries(m.U.postgrest(i)),a.next=4,null===t||void 0===t?void 0:t(e,r,s);case 4:case"end":return a.stop()}}),a)})))()}},r))}(),g=v.mutateAsync,y=function(){var e=(0,w.Z)(P().mark((function e(t){return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,g({projectRef:i,dbSchema:t.db_schema,maxRows:t.max_rows,dbExtraSearchPath:t.db_extra_search_path});case 5:n.setNotification({category:"success",message:"Successfully saved settings"}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n.setNotification({error:e.t0,category:"error",message:"Failed to update config: ".concat(e.t0.message)});case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),O=["public","storage"],S=["auth","pgbouncer","hooks","extensions"],k=null!==(t=s.schemas.list((function(e){if((0,xe.indexOf)(S,e.name)<0)return e}),{allSchemas:!0}).map((function(e){return{id:e.id,value:e.name,name:e.name,disabled:(0,xe.indexOf)(O,e.name)>=0}})))&&void 0!==t?t:[];return(0,z.jsx)(fe.Z,{id:l,initialValues:{db_schema:"",max_rows:"",db_extra_search_path:""},validate:function(){},onSubmit:y,children:function(e){var t,r=e.isSubmitting,n=e.handleReset,s=e.resetForm,i=e.values,c=e.initialValues,o=JSON.stringify(i)!==JSON.stringify(c);return(0,a.useEffect)((function(){if(f){var e,t={db_schema:f.db_schema,max_rows:f.max_rows,db_extra_search_path:null!==(e=f.db_extra_search_path)&&void 0!==e?e:""};s({values:t,initialValues:t})}}),[f]),(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(we.by,{disabled:!0,header:(0,z.jsx)("p",{children:"API settings"}),footer:(0,z.jsx)("div",{className:"flex px-8 py-4",children:(0,z.jsx)(we.iN,{form:l,isSubmitting:r,hasChanges:o,handleReset:n,disabled:!j,helper:j?void 0:"You need additional permissions to update your project's API settings"})}),children:h?(0,z.jsxs)("div",{className:"flex items-center justify-center py-8 space-x-2",children:[(0,z.jsx)(p.Z,{size:16,strokeWidth:1.5}),(0,z.jsx)("p",{className:"text-sm text-scale-1100",children:"Failed to retrieve API settings"})]}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(we.hj,{header:(0,z.jsx)(we.S0,{children:"Exposed schemas"}),children:(0,z.jsx)(we.B4,{loading:!1,children:k.length>=1&&(0,z.jsx)(ye.Z,{disabled:!j,options:k,descriptionText:(0,z.jsxs)(z.Fragment,{children:["The schemas to expose in your API. Tables, views and stored procedures in these schemas will get API endpoints.",(0,z.jsx)("code",{className:"text-xs",children:"public"})," and"," ",(0,z.jsx)("code",{className:"text-xs",children:"storage"})," are protected by default."]}),emptyMessage:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(p.Z,{strokeWidth:2}),(0,z.jsxs)("div",{className:"flex flex-col mt-2 text-center",children:[(0,z.jsx)("p",{className:"text-sm align-center",children:"No schema available to choose"}),(0,z.jsx)("p",{className:"text-xs opacity-50",children:"New schemas you create will appear here"})]})]}),value:(null!==(t=null===i||void 0===i?void 0:i.db_schema)&&void 0!==t?t:"").replace(/ /g,"").split(","),onChange:function(e){var t=i;t.db_schema=e.join(", "),s({values:t,initialValues:t}),y(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t))}})})}),(0,z.jsx)(we.hj,{header:(0,z.jsx)(we.S0,{children:"Extra search path"}),children:(0,z.jsx)(we.B4,{loading:!1,children:(0,z.jsx)(x.Z,{id:"db_extra_search_path",size:"small",disabled:!j,descriptionText:"Extra schemas to add to the search path of every request. Multiple schemas must be comma-separated."})})}),(0,z.jsx)(we.hj,{header:(0,z.jsx)(we.S0,{children:"Max rows"}),children:(0,z.jsx)(we.B4,{loading:!1,children:(0,z.jsx)(he.Z,{id:"max_rows",size:"small",disabled:!j,descriptionText:"The maximum number of rows returned from a view, table, or stored procedure. Limits payload size for accidental or malicious requests."})})})]})})})}})})),Pe=function(){var e,t,r=(0,c.oR)().ui,n=(0,d.NL)(),s=(0,o.UO)().ref,i=(0,h.qP)({projectRef:s}),l=i.data,b=i.isError,y=(0,f.tb)({projectRef:s}).data,w=null===y||void 0===y?void 0:y.jwtSecretUpdateStatus,N=null===y||void 0===y?void 0:y.jwtSecretUpdateError,O=(0,a.useRef)(),P=u.iL.Failed,S=u.iL.Updated,k=u.iL.Updating,Z=g[N];(0,a.useEffect)((function(){if(O.current===k)switch(w){case S:n.invalidateQueries(m.U.api(s)),n.invalidateQueries(m.U.settings(s)),n.invalidateQueries(m.U.postgrest(s)),r.setNotification({category:"success",message:"Successfully updated JWT secret"});break;case P:r.setNotification({category:"error",message:"JWT secret update failed: ".concat(Z)})}O.current=w}),[w]);var _=null===l||void 0===l?void 0:l.autoApiService,T="".concat(null!==(e=null===_||void 0===_?void 0:_.protocol)&&void 0!==e?e:"https","://").concat(null!==(t=null===_||void 0===_?void 0:_.endpoint)&&void 0!==t?t:"-");return(0,z.jsxs)("div",{children:[(0,z.jsx)("h3",{className:"mb-6 text-xl text-scale-1200",children:"API Settings"}),(0,z.jsx)("section",{children:(0,z.jsx)(j.Z,{title:(0,z.jsx)("h5",{className:"mb-0",children:"Project URL"}),children:(0,z.jsx)(j.Z.Content,{children:b?(0,z.jsxs)("div",{className:"flex items-center justify-center py-4 space-x-2",children:[(0,z.jsx)(p.Z,{size:16,strokeWidth:1.5}),(0,z.jsx)("p",{className:"text-sm text-scale-1100",children:"Failed to retrieve project URL"})]}):(0,z.jsx)(x.Z,{copy:!0,label:"URL",readOnly:!0,disabled:!0,className:"input-mono",value:T,descriptionText:"A RESTful endpoint for querying and managing your database.",layout:"horizontal"})})})}),(0,z.jsx)("section",{children:(0,z.jsx)(v.D,{},"DisplayAPISettings")}),(0,z.jsx)("section",{children:(0,z.jsx)(pe,{})}),(0,z.jsx)("section",{children:(0,z.jsx)(Oe,{})})]})},Se=r(47510),ke=(0,a.createContext)(null),Ze=function(){var e=(0,o.UO)().ref,t=(0,c.oR)(),r=t.meta,n=t.ui.selectedProject,s=(0,Se.gY)(),l=(0,i.fv)((function(){return{project:null,projectRef:e,meta:null}}));return ke.meta=r,ke.project=n,r&&(l.meta=r),(0,a.useEffect)((function(){null!==n&&void 0!==n&&n.ref&&r.schemas.load()}),[null===n||void 0===n?void 0:n.ref]),(0,z.jsx)(ke.Provider,{value:l,children:(0,z.jsx)("div",{className:"flex flex-col gap-8 px-5 py-6 mx-auto 1xl:px-28 lg:px-16 xl:px-24 2xl:px-32",children:s?(0,z.jsx)(Pe,{}):(0,z.jsxs)("div",{children:[(0,z.jsx)("h3",{className:"mb-6 text-xl text-scale-1200",children:"API Settings"}),(0,z.jsxs)("div",{className:"flex items-center justify-center rounded border border-scale-400 bg-scale-300 p-8",children:[(0,z.jsx)(p.Z,{strokeWidth:1.5}),(0,z.jsx)("p",{className:"text-sm text-scale-1100 ml-2",children:"API settings are unavailable as the project is not active"})]})]})})})};Ze.getLayout=function(e){return(0,z.jsx)(l.dU,{title:"API Settings",children:e})};var _e=(0,i.Pi)(Ze)},62562:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/settings/api",function(){return r(40529)}])}},function(e){e.O(0,[7930,1188,6792,2056,5286,9774,2888,179],(function(){return t=62562,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=api-6cc57bedc0cfbc4a.js.map